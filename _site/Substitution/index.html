<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Substitution in the untyped lambda calculus | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Substitution in the untyped lambda calculus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/Substitution/" />
<meta property="og:url" content="https://plfa.github.io/Substitution/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"description":"Programming Language Foundations in Agda","@type":"WebPage","url":"https://plfa.github.io/Substitution/","headline":"Substitution in the untyped lambda calculus","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/">Table of Contents</a>
                <a class="page-link" href="/GettingStarted/">Getting Started</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Substitution in the untyped lambda calculus</h1>
  </header>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


  <div class="post-content">
    <pre class="Agda"><a id="178" class="Keyword">module</a> <a id="185" href="/Substitution/" class="Module">plfa.Substitution</a> <a id="203" class="Keyword">where</a></pre>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="/Untyped/" class="Module">plfa.Untyped</a>
  <a id="273" class="Keyword">using</a> <a id="279" class="Symbol">(</a><a id="280" href="/Untyped/#2675" class="Datatype">Type</a><a id="284" class="Symbol">;</a> <a id="286" href="/Untyped/#2980" class="Datatype">Context</a><a id="293" class="Symbol">;</a> <a id="295" href="/Untyped/#4150" class="Datatype Operator">_⊢_</a><a id="298" class="Symbol">;</a> <a id="300" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="301" class="Symbol">;</a> <a id="303" href="/Untyped/#3365" class="Datatype Operator">_∋_</a><a id="306" class="Symbol">;</a> <a id="308" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="309" class="Symbol">;</a> <a id="311" href="/Untyped/#3018" class="InductiveConstructor Operator">_,_</a><a id="314" class="Symbol">;</a> <a id="316" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="317" class="Symbol">;</a> <a id="319" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="321" class="Symbol">;</a> <a id="323" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a><a id="325" class="Symbol">;</a> <a id="327" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a><a id="329" class="Symbol">;</a> <a id="331" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a><a id="334" class="Symbol">;</a>
         <a id="345" href="/Untyped/#6171" class="Function">rename</a><a id="351" class="Symbol">;</a> <a id="353" href="/Untyped/#6931" class="Function">subst</a><a id="358" class="Symbol">;</a> <a id="360" href="/Untyped/#5845" class="Function">ext</a><a id="363" class="Symbol">;</a> <a id="365" href="/Untyped/#6623" class="Function">exts</a><a id="369" class="Symbol">;</a> <a id="371" href="/Untyped/#7475" class="Function Operator">_[_]</a><a id="375" class="Symbol">;</a> <a id="377" href="/Untyped/#7359" class="Function">subst-zero</a><a id="387" class="Symbol">)</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="/Denotational/" class="Module">plfa.Denotational</a> <a id="419" class="Keyword">using</a> <a id="425" class="Symbol">(</a><a id="426" href="/Denotational/#23286" class="Function">Rename</a><a id="432" class="Symbol">;</a> <a id="434" href="/Denotational/#3262" class="Postulate">extensionality</a><a id="448" class="Symbol">)</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="/Soundness/" class="Module">plfa.Soundness</a> <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="/Soundness/#2673" class="Function">Subst</a><a id="489" class="Symbol">)</a>

<a id="492" class="Keyword">import</a> <a id="499" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="537" class="Symbol">as</a> <a id="540" class="Module">Eq</a>
<a id="543" class="Keyword">open</a> <a id="548" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="551" class="Keyword">using</a> <a id="557" class="Symbol">(</a><a id="558" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="561" class="Symbol">;</a> <a id="563" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="567" class="Symbol">;</a> <a id="569" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="572" class="Symbol">;</a> <a id="574" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="578" class="Symbol">;</a> <a id="580" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="585" class="Symbol">;</a> <a id="587" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="595" class="Symbol">)</a>
<a id="597" class="Keyword">open</a> <a id="602" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#3975" class="Module">Eq.≡-Reasoning</a> <a id="617" class="Keyword">using</a> <a id="623" class="Symbol">(</a><a id="624" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin_</a><a id="630" class="Symbol">;</a> <a id="632" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">_≡⟨⟩_</a><a id="637" class="Symbol">;</a> <a id="639" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">_≡⟨_⟩_</a><a id="645" class="Symbol">;</a> <a id="647" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">_∎</a><a id="649" class="Symbol">)</a>
<a id="651" class="Keyword">open</a> <a id="656" class="Keyword">import</a> <a id="663" href="https://agda.github.io/agda-stdlib/Function.html" class="Module">Function</a> <a id="672" class="Keyword">using</a> <a id="678" class="Symbol">(</a><a id="679" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">_∘_</a><a id="682" class="Symbol">)</a></pre>

<h2 id="overview">Overview</h2>

<p>The primary purpose of this chapter is to prove that substitution
commutes with itself. Barendgredt (1984) refers to this
as the substitution lemma:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [x:=N] [y:=L] = M [y:=L] [x:= N[y:=L] ]
</code></pre></div></div>

<p>In our setting, with de Bruijn indices for variables, the statement of
the lemma becomes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [ N ] [ L ] ≡  M〔 L 〕[ N [ L ] ]                     (substitution)
</code></pre></div></div>

<p>where the notation M 〔 L 〕 is for subsituting L for index 1 inside
M.  In addition, because we define substitution in terms of parallel
substitution, we have the following generalization, replacing the
substitution of L with an arbitrary parallel substitution σ.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst σ (M [ N ]) ≡ (subst (exts σ) M) [ subst σ N ]    (subst-commute)
</code></pre></div></div>

<p>The special case for renamings is also useful.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (M [ N ]) ≡ (rename (ext ρ) M) [ rename ρ N ]
                                                 (rename-subst-commute)
</code></pre></div></div>

<p>The secondary purpose of this chapter is to define the σ algebra of
parallel substitution due to Abadi, Cardelli, Curien, and Levy
(1991). The equations of this algebra not only help us prove the
substitution lemma, but they are generally useful. Futhermore, when
the equations are applied from left to right, they form a rewrite
system that <em>decides</em> whether any two substitutions are equal.</p>

<p>We use the following more succinct notation the <code class="highlighter-rouge">subst</code> function.</p>

<pre class="Agda"><a id="⧼_⧽"></a><a id="2074" href="/Substitution/#2074" class="Function Operator">⧼_⧽</a> <a id="2078" class="Symbol">:</a> <a id="2080" class="Symbol">∀{</a><a id="2082" href="/Substitution/#2082" class="Bound">Γ</a> <a id="2084" href="/Substitution/#2084" class="Bound">Δ</a> <a id="2086" href="/Substitution/#2086" class="Bound">A</a><a id="2087" class="Symbol">}</a> <a id="2089" class="Symbol">→</a> <a id="2091" href="/Soundness/#2673" class="Function">Subst</a> <a id="2097" href="/Substitution/#2082" class="Bound">Γ</a> <a id="2099" href="/Substitution/#2084" class="Bound">Δ</a> <a id="2101" class="Symbol">→</a> <a id="2103" href="/Substitution/#2082" class="Bound">Γ</a> <a id="2105" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2107" href="/Substitution/#2086" class="Bound">A</a> <a id="2109" class="Symbol">→</a> <a id="2111" href="/Substitution/#2084" class="Bound">Δ</a> <a id="2113" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2115" href="/Substitution/#2086" class="Bound">A</a>
<a id="2117" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="2119" href="/Substitution/#2119" class="Bound">σ</a> <a id="2121" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="2123" class="Symbol">=</a> <a id="2125" class="Symbol">λ</a> <a id="2127" href="/Substitution/#2127" class="Bound">M</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="/Untyped/#6931" class="Function">subst</a> <a id="2137" href="/Substitution/#2119" class="Bound">σ</a> <a id="2139" href="/Substitution/#2127" class="Bound">M</a></pre>

<h2 id="the-σ-algebra-of-substitution">The σ algebra of substitution</h2>

<p>Substitutions map de Bruijn indices (natural numbers) to terms, so we
can view a substitution simply as a sequence of terms, or more
precisely, as an infinite sequence of terms. The σ algebra consists of
four operations for building such sequences: identity <code class="highlighter-rouge">ids</code>, shift
<code class="highlighter-rouge">↑</code>, cons <code class="highlighter-rouge">M • σ</code>, and sequencing <code class="highlighter-rouge">σ ⨟ τ</code>.  The sequence <code class="highlighter-rouge">0, 1, 2, ...</code>
is constructed by the identity subsitution.</p>

<pre class="Agda"><a id="ids"></a><a id="2589" href="/Substitution/#2589" class="Function">ids</a> <a id="2593" class="Symbol">:</a> <a id="2595" class="Symbol">∀{</a><a id="2597" href="/Substitution/#2597" class="Bound">Γ</a><a id="2598" class="Symbol">}</a> <a id="2600" class="Symbol">→</a> <a id="2602" href="/Soundness/#2673" class="Function">Subst</a> <a id="2608" href="/Substitution/#2597" class="Bound">Γ</a> <a id="2610" href="/Substitution/#2597" class="Bound">Γ</a>
<a id="2612" href="/Substitution/#2589" class="Function">ids</a> <a id="2616" href="/Substitution/#2616" class="Bound">x</a> <a id="2618" class="Symbol">=</a> <a id="2620" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="2622" href="/Substitution/#2616" class="Bound">x</a></pre>

<p>The shift operation <code class="highlighter-rouge">↑</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, ...
</code></pre></div></div>

<p>and is defined as follows.</p>

<pre class="Agda"><a id="↑"></a><a id="2744" href="/Substitution/#2744" class="Function">↑</a> <a id="2746" class="Symbol">:</a> <a id="2748" class="Symbol">∀{</a><a id="2750" href="/Substitution/#2750" class="Bound">Γ</a> <a id="2752" href="/Substitution/#2752" class="Bound">A</a><a id="2753" class="Symbol">}</a> <a id="2755" class="Symbol">→</a> <a id="2757" href="/Soundness/#2673" class="Function">Subst</a> <a id="2763" href="/Substitution/#2750" class="Bound">Γ</a> <a id="2765" class="Symbol">(</a><a id="2766" href="/Substitution/#2750" class="Bound">Γ</a> <a id="2768" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="2770" href="/Substitution/#2752" class="Bound">A</a><a id="2771" class="Symbol">)</a>
<a id="2773" href="/Substitution/#2744" class="Function">↑</a> <a id="2775" href="/Substitution/#2775" class="Bound">x</a> <a id="2777" class="Symbol">=</a> <a id="2779" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="2781" class="Symbol">(</a><a id="2782" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="2784" href="/Substitution/#2775" class="Bound">x</a><a id="2785" class="Symbol">)</a></pre>

<p>Given a term <code class="highlighter-rouge">M</code> and substitution <code class="highlighter-rouge">σ</code>, the operation
<code class="highlighter-rouge">M • σ</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M , σ 0, σ 1, σ 2, ...
</code></pre></div></div>

<p>This operation is analogous to the <code class="highlighter-rouge">cons</code> operation of Lisp.</p>

<pre class="Agda"><a id="2988" class="Keyword">infixr</a> <a id="2995" class="Number">6</a> <a id="2997" href="/Substitution/#3002" class="Function Operator">_•_</a>

<a id="_•_"></a><a id="3002" href="/Substitution/#3002" class="Function Operator">_•_</a> <a id="3006" class="Symbol">:</a> <a id="3008" class="Symbol">∀{</a><a id="3010" href="/Substitution/#3010" class="Bound">Γ</a> <a id="3012" href="/Substitution/#3012" class="Bound">Δ</a> <a id="3014" href="/Substitution/#3014" class="Bound">A</a><a id="3015" class="Symbol">}</a> <a id="3017" class="Symbol">→</a> <a id="3019" class="Symbol">(</a><a id="3020" href="/Substitution/#3012" class="Bound">Δ</a> <a id="3022" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3024" href="/Substitution/#3014" class="Bound">A</a><a id="3025" class="Symbol">)</a> <a id="3027" class="Symbol">→</a> <a id="3029" href="/Soundness/#2673" class="Function">Subst</a> <a id="3035" href="/Substitution/#3010" class="Bound">Γ</a> <a id="3037" href="/Substitution/#3012" class="Bound">Δ</a> <a id="3039" class="Symbol">→</a> <a id="3041" href="/Soundness/#2673" class="Function">Subst</a> <a id="3047" class="Symbol">(</a><a id="3048" href="/Substitution/#3010" class="Bound">Γ</a> <a id="3050" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3052" href="/Substitution/#3014" class="Bound">A</a><a id="3053" class="Symbol">)</a> <a id="3055" href="/Substitution/#3012" class="Bound">Δ</a>
<a id="3057" class="Symbol">(</a><a id="3058" href="/Substitution/#3058" class="Bound">M</a> <a id="3060" href="/Substitution/#3002" class="Function Operator">•</a> <a id="3062" href="/Substitution/#3062" class="Bound">σ</a><a id="3063" class="Symbol">)</a> <a id="3065" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="3067" class="Symbol">=</a> <a id="3069" href="/Substitution/#3058" class="Bound">M</a>
<a id="3071" class="Symbol">(</a><a id="3072" href="/Substitution/#3072" class="Bound">M</a> <a id="3074" href="/Substitution/#3002" class="Function Operator">•</a> <a id="3076" href="/Substitution/#3076" class="Bound">σ</a><a id="3077" class="Symbol">)</a> <a id="3079" class="Symbol">(</a><a id="3080" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3082" href="/Substitution/#3082" class="Bound">x</a><a id="3083" class="Symbol">)</a> <a id="3085" class="Symbol">=</a> <a id="3087" href="/Substitution/#3076" class="Bound">σ</a> <a id="3089" href="/Substitution/#3082" class="Bound">x</a></pre>

<p>Given two substitutions <code class="highlighter-rouge">σ</code> and <code class="highlighter-rouge">τ</code>, the sequencing operation <code class="highlighter-rouge">σ ⨟ τ</code>
produces the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⧼τ⧽(σ 0), ⧼τ⧽(σ 1), ⧼τ⧽(σ 2), ...
</code></pre></div></div>

<p>That is, it composes the two substitutions by first applying
<code class="highlighter-rouge">σ</code> and then applying <code class="highlighter-rouge">τ</code>.</p>

<pre class="Agda"><a id="3341" class="Keyword">infixr</a> <a id="3348" class="Number">5</a> <a id="3350" href="/Substitution/#3355" class="Function Operator">_⨟_</a>

<a id="_⨟_"></a><a id="3355" href="/Substitution/#3355" class="Function Operator">_⨟_</a> <a id="3359" class="Symbol">:</a> <a id="3361" class="Symbol">∀{</a><a id="3363" href="/Substitution/#3363" class="Bound">Γ</a> <a id="3365" href="/Substitution/#3365" class="Bound">Δ</a> <a id="3367" href="/Substitution/#3367" class="Bound">Σ</a><a id="3368" class="Symbol">}</a> <a id="3370" class="Symbol">→</a> <a id="3372" href="/Soundness/#2673" class="Function">Subst</a> <a id="3378" href="/Substitution/#3363" class="Bound">Γ</a> <a id="3380" href="/Substitution/#3365" class="Bound">Δ</a> <a id="3382" class="Symbol">→</a> <a id="3384" href="/Soundness/#2673" class="Function">Subst</a> <a id="3390" href="/Substitution/#3365" class="Bound">Δ</a> <a id="3392" href="/Substitution/#3367" class="Bound">Σ</a> <a id="3394" class="Symbol">→</a> <a id="3396" href="/Soundness/#2673" class="Function">Subst</a> <a id="3402" href="/Substitution/#3363" class="Bound">Γ</a> <a id="3404" href="/Substitution/#3367" class="Bound">Σ</a>
<a id="3406" href="/Substitution/#3406" class="Bound">σ</a> <a id="3408" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="3410" href="/Substitution/#3410" class="Bound">τ</a> <a id="3412" class="Symbol">=</a> <a id="3414" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="3416" href="/Substitution/#3410" class="Bound">τ</a> <a id="3418" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="3420" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="3422" href="/Substitution/#3406" class="Bound">σ</a></pre>

<p>For the sequencing operation, Abadi et al. use the notation of
function composition, writting <code class="highlighter-rouge">σ ∘ τ</code>, but still with <code class="highlighter-rouge">σ</code> applied
before <code class="highlighter-rouge">τ</code>, which is the opposite of standard mathematical
practice. We instead write <code class="highlighter-rouge">σ ⨟ τ</code>, because semicolon is
the standard notation for forward function composition.</p>

<h2 id="the-σ-algebra-equations">The σ algebra equations</h2>

<p>The σ algebra includes the following equations.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sub-head)  ⧼ M • σ ⧽ (` Z) ≡ M
(sub-tail)  ↑ ⨟ (M • σ)    ≡ σ
(sub-η)     (⧼ σ ⧽ (` Z)) • (↑ ⨟ σ) ≡ σ
(Z-shift)   (` Z) • ↑      ≡ ids

(sub-id)    ⧼ ids ⧽ M      ≡ M
(sub-app)   ⧼ σ ⧽ (L · M)  ≡ (⧼ σ ⧽ L) · (⧼ σ ⧽ M)
(sub-abs)   ⧼ σ ⧽ (ƛ N)    ≡ ƛ ⧼ σ ⧽ N
(sub-sub)   ⧼ τ ⧽ ⧼ σ ⧽ M  ≡ ⧼ σ ⨟ τ ⧽ M

(sub-idL)   ids ⨟ σ        ≡ σ
(sub-idR)   σ ⨟ ids        ≡ σ
(sub-assoc) (σ ⨟ τ) ⨟ θ    ≡ σ ⨟ (τ ⨟ θ)
(sub-dist)  (M • σ) ⨟ τ    ≡ (⧼ τ ⧽ M) • (σ ⨟ τ)
</code></pre></div></div>

<p>The first group of equations describe how the <code class="highlighter-rouge">•</code> operator acts like cons.
The equation <code class="highlighter-rouge">sub-head</code> says that the variable zero <code class="highlighter-rouge">Z</code> returns the
head of the sequence (it acts like the <code class="highlighter-rouge">car</code> of Lisp).  Similarly,
<code class="highlighter-rouge">sub-tail</code> says that sequencing with shift <code class="highlighter-rouge">↑</code> returns the tail of the
sequence (it acts like <code class="highlighter-rouge">cdr</code> of Lisp).  The <code class="highlighter-rouge">sub-η</code> equation is the
η-expansion rule for sequences, saying that taking the head and tail
of a sequence, and then cons’ing them together yields the original
sequence. The <code class="highlighter-rouge">Z-shift</code> equation says that cons’ing zero onto the
shifted sequence produces the identity sequence.</p>

<p>The next four equations involve applying substitutions to terms.  The
equation <code class="highlighter-rouge">sub-id</code> says that the identity substitution returns the term
unchanged. The equations <code class="highlighter-rouge">sub-app</code> and <code class="highlighter-rouge">sub-abs</code> says that
substitution is a congruence for the lambda calculus. The <code class="highlighter-rouge">sub-sub</code>
equation says that the sequence operator <code class="highlighter-rouge">⨟</code> behaves as intended.</p>

<p>The last four equations concern the sequencing of substitutions.
The first two equations, <code class="highlighter-rouge">sub-idL</code> and <code class="highlighter-rouge">sub-idR</code>, say that
<code class="highlighter-rouge">ids</code> is the left and right unit of the sequencing operator.
The <code class="highlighter-rouge">sub-assoc</code> equation says that sequencing is associative.
Finally, <code class="highlighter-rouge">sub-dist</code> says that post-sequencing distributes through cons.</p>

<h2 id="relating-the-σ-algebra-and-subsitution-functions">Relating the σ algebra and subsitution functions</h2>

<p>The definitions of substitution <code class="highlighter-rouge">N [ M ]</code> and parallel subsitution
<code class="highlighter-rouge">subst σ N</code> depend on several auxiliary functions: <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>,
<code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>. We shall relate those functions to terms in
the σ algebra.</p>

<p>To begin with, renaming can be expressed in terms of substitution.
We have</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⧼ ren ρ ⧽ M               (rename-subst-ren)
</code></pre></div></div>

<p>where <code class="highlighter-rouge">ren</code> turns a renaming <code class="highlighter-rouge">ρ</code> into a substitution by post-composing
<code class="highlighter-rouge">ρ</code> with the identity substitution.</p>

<pre class="Agda"><a id="ren"></a><a id="6112" href="/Substitution/#6112" class="Function">ren</a> <a id="6116" class="Symbol">:</a> <a id="6118" class="Symbol">∀{</a><a id="6120" href="/Substitution/#6120" class="Bound">Γ</a> <a id="6122" href="/Substitution/#6122" class="Bound">Δ</a><a id="6123" class="Symbol">}</a> <a id="6125" class="Symbol">→</a> <a id="6127" href="/Denotational/#23286" class="Function">Rename</a> <a id="6134" href="/Substitution/#6120" class="Bound">Γ</a> <a id="6136" href="/Substitution/#6122" class="Bound">Δ</a> <a id="6138" class="Symbol">→</a> <a id="6140" href="/Soundness/#2673" class="Function">Subst</a> <a id="6146" href="/Substitution/#6120" class="Bound">Γ</a> <a id="6148" href="/Substitution/#6122" class="Bound">Δ</a>
<a id="6150" href="/Substitution/#6112" class="Function">ren</a> <a id="6154" href="/Substitution/#6154" class="Bound">ρ</a> <a id="6156" class="Symbol">=</a> <a id="6158" href="/Substitution/#2589" class="Function">ids</a> <a id="6162" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="6164" href="/Substitution/#6154" class="Bound">ρ</a></pre>

<p>When the renaming is the increment function, then it is equivalent to
shift.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren S_ ≡ ↑                           (ren-shift)

rename S_ M ≡ ⧼ ↑ ⧽ M                 (rename-shift)
</code></pre></div></div>

<p>Next we relate the <code class="highlighter-rouge">exts</code> function to the σ algebra.  Recall that the
<code class="highlighter-rouge">exts</code> function extends a substitution as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ = ` Z, rename S_ (σ 0), rename S_ (σ 1), rename S_ (σ 2), ...
</code></pre></div></div>

<p>So <code class="highlighter-rouge">exts</code> is equivalent to cons’ing Z onto the sequence formed
by applying <code class="highlighter-rouge">σ</code> and then shifting.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ≡ ` Z • (σ ⨟ ↑)                (exts-cons-shift)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ext</code> function does the same job as <code class="highlighter-rouge">exts</code> but for renamings
instead of substitutions. So composing <code class="highlighter-rouge">ext</code> with <code class="highlighter-rouge">ren</code> is the same as
composing <code class="highlighter-rouge">ren</code> with <code class="highlighter-rouge">exts</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ exts (ren ρ)            (ren-ext)
</code></pre></div></div>

<p>Thus, we can recast the <code class="highlighter-rouge">exts-cons-shift</code> equation in terms of
renamings.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ ` Z • (ren ρ ⨟ ↑)       (ext-cons-Z-shift)
</code></pre></div></div>

<p>It is also useful to specialize the <code class="highlighter-rouge">sub-sub</code> equation of the σ
algebra to the situation where the first substitution is a renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⧼ σ ⧽ (rename ρ M) ≡ ⧼ σ ∘ ρ ⧽ M       (rename-subst)
</code></pre></div></div>

<p>Finally, the <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing
<code class="highlighter-rouge">M</code> onto the identity substitution.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst-zero M ≡ M • ids                (subst-Z-cons-ids)
</code></pre></div></div>

<h2 id="proofs-of-sub-head-sub-tail-sub-η-z-shift-sub-idl-sub-dist-and-sub-app">Proofs of sub-head, sub-tail, sub-η, Z-shift, sub-idL, sub-dist, and sub-app</h2>

<p>We start with the proofs that are immediate from the definitions of
the operators.</p>

<pre class="Agda"><a id="sub-head"></a><a id="7622" href="/Substitution/#7622" class="Function">sub-head</a> <a id="7631" class="Symbol">:</a> <a id="7633" class="Symbol">∀</a> <a id="7635" class="Symbol">{</a><a id="7636" href="/Substitution/#7636" class="Bound">Γ</a> <a id="7638" href="/Substitution/#7638" class="Bound">Δ</a><a id="7639" class="Symbol">}</a> <a id="7641" class="Symbol">{</a><a id="7642" href="/Substitution/#7642" class="Bound">A</a><a id="7643" class="Symbol">}</a> <a id="7645" class="Symbol">{</a><a id="7646" href="/Substitution/#7646" class="Bound">M</a> <a id="7648" class="Symbol">:</a> <a id="7650" href="/Substitution/#7638" class="Bound">Δ</a> <a id="7652" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="7654" href="/Substitution/#7642" class="Bound">A</a><a id="7655" class="Symbol">}{</a><a id="7657" href="/Substitution/#7657" class="Bound">σ</a> <a id="7659" class="Symbol">:</a> <a id="7661" href="/Soundness/#2673" class="Function">Subst</a> <a id="7667" href="/Substitution/#7636" class="Bound">Γ</a> <a id="7669" href="/Substitution/#7638" class="Bound">Δ</a><a id="7670" class="Symbol">}</a>
         <a id="7681" class="Symbol">→</a> <a id="7683" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="7685" href="/Substitution/#7646" class="Bound">M</a> <a id="7687" href="/Substitution/#3002" class="Function Operator">•</a> <a id="7689" href="/Substitution/#7657" class="Bound">σ</a> <a id="7691" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="7693" class="Symbol">(</a><a id="7694" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="7696" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="7697" class="Symbol">)</a> <a id="7699" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="7701" href="/Substitution/#7646" class="Bound">M</a>
<a id="7703" href="/Substitution/#7622" class="Function">sub-head</a> <a id="7712" class="Symbol">=</a> <a id="7714" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-tail"></a><a id="7744" href="/Substitution/#7744" class="Function">sub-tail</a> <a id="7753" class="Symbol">:</a> <a id="7755" class="Symbol">∀{</a><a id="7757" href="/Substitution/#7757" class="Bound">Γ</a> <a id="7759" href="/Substitution/#7759" class="Bound">Δ</a><a id="7760" class="Symbol">}</a> <a id="7762" class="Symbol">{</a><a id="7763" href="/Substitution/#7763" class="Bound">A</a> <a id="7765" href="/Substitution/#7765" class="Bound">B</a><a id="7766" class="Symbol">}</a> <a id="7768" class="Symbol">{</a><a id="7769" href="/Substitution/#7769" class="Bound">M</a> <a id="7771" class="Symbol">:</a> <a id="7773" href="/Substitution/#7759" class="Bound">Δ</a> <a id="7775" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="7777" href="/Substitution/#7763" class="Bound">A</a><a id="7778" class="Symbol">}</a> <a id="7780" class="Symbol">{</a><a id="7781" href="/Substitution/#7781" class="Bound">σ</a> <a id="7783" class="Symbol">:</a> <a id="7785" href="/Soundness/#2673" class="Function">Subst</a> <a id="7791" href="/Substitution/#7757" class="Bound">Γ</a> <a id="7793" href="/Substitution/#7759" class="Bound">Δ</a><a id="7794" class="Symbol">}</a>
         <a id="7805" class="Symbol">→</a> <a id="7807" class="Symbol">(</a><a id="7808" href="/Substitution/#2744" class="Function">↑</a> <a id="7810" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="7812" href="/Substitution/#7769" class="Bound">M</a> <a id="7814" href="/Substitution/#3002" class="Function Operator">•</a> <a id="7816" href="/Substitution/#7781" class="Bound">σ</a><a id="7817" class="Symbol">)</a> <a id="7819" class="Symbol">{</a><a id="7820" class="Argument">A</a> <a id="7822" class="Symbol">=</a> <a id="7824" href="/Substitution/#7765" class="Bound">B</a><a id="7825" class="Symbol">}</a> <a id="7827" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="7829" href="/Substitution/#7781" class="Bound">σ</a>
<a id="7831" href="/Substitution/#7744" class="Function">sub-tail</a> <a id="7840" class="Symbol">=</a> <a id="7842" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="7857" class="Symbol">λ</a> <a id="7859" href="/Substitution/#7859" class="Bound">x</a> <a id="7861" class="Symbol">→</a> <a id="7863" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-η"></a><a id="7893" href="/Substitution/#7893" class="Function">sub-η</a> <a id="7899" class="Symbol">:</a> <a id="7901" class="Symbol">∀{</a><a id="7903" href="/Substitution/#7903" class="Bound">Γ</a> <a id="7905" href="/Substitution/#7905" class="Bound">Δ</a><a id="7906" class="Symbol">}</a> <a id="7908" class="Symbol">{</a><a id="7909" href="/Substitution/#7909" class="Bound">A</a> <a id="7911" href="/Substitution/#7911" class="Bound">B</a><a id="7912" class="Symbol">}</a> <a id="7914" class="Symbol">{</a><a id="7915" href="/Substitution/#7915" class="Bound">σ</a> <a id="7917" class="Symbol">:</a> <a id="7919" href="/Soundness/#2673" class="Function">Subst</a> <a id="7925" class="Symbol">(</a><a id="7926" href="/Substitution/#7903" class="Bound">Γ</a> <a id="7928" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="7930" href="/Substitution/#7909" class="Bound">A</a><a id="7931" class="Symbol">)</a> <a id="7933" href="/Substitution/#7905" class="Bound">Δ</a><a id="7934" class="Symbol">}</a> 
      <a id="7943" class="Symbol">→</a> <a id="7945" class="Symbol">(</a><a id="7946" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="7948" href="/Substitution/#7915" class="Bound">σ</a> <a id="7950" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="7952" class="Symbol">(</a><a id="7953" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="7955" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="7956" class="Symbol">)</a> <a id="7958" href="/Substitution/#3002" class="Function Operator">•</a> <a id="7960" class="Symbol">(</a><a id="7961" href="/Substitution/#2744" class="Function">↑</a> <a id="7963" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="7965" href="/Substitution/#7915" class="Bound">σ</a><a id="7966" class="Symbol">))</a> <a id="7969" class="Symbol">{</a><a id="7970" class="Argument">A</a> <a id="7972" class="Symbol">=</a> <a id="7974" href="/Substitution/#7911" class="Bound">B</a><a id="7975" class="Symbol">}</a> <a id="7977" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="7979" href="/Substitution/#7915" class="Bound">σ</a>
<a id="7981" href="/Substitution/#7893" class="Function">sub-η</a> <a id="7987" class="Symbol">{</a><a id="7988" href="/Substitution/#7988" class="Bound">Γ</a><a id="7989" class="Symbol">}{</a><a id="7991" href="/Substitution/#7991" class="Bound">Δ</a><a id="7992" class="Symbol">}{</a><a id="7994" href="/Substitution/#7994" class="Bound">A</a><a id="7995" class="Symbol">}{</a><a id="7997" href="/Substitution/#7997" class="Bound">B</a><a id="7998" class="Symbol">}{</a><a id="8000" href="/Substitution/#8000" class="Bound">σ</a><a id="8001" class="Symbol">}</a> <a id="8003" class="Symbol">=</a> <a id="8005" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="8020" class="Symbol">λ</a> <a id="8022" href="/Substitution/#8022" class="Bound">x</a> <a id="8024" class="Symbol">→</a> <a id="8026" href="/Substitution/#8045" class="Function">lemma</a>
   <a id="8035" class="Keyword">where</a> 
   <a id="8045" href="/Substitution/#8045" class="Function">lemma</a> <a id="8051" class="Symbol">:</a> <a id="8053" class="Symbol">∀</a> <a id="8055" class="Symbol">{</a><a id="8056" href="/Substitution/#8056" class="Bound">x</a><a id="8057" class="Symbol">}</a> <a id="8059" class="Symbol">→</a> <a id="8061" class="Symbol">((</a><a id="8063" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="8065" href="/Substitution/#8000" class="Bound">σ</a> <a id="8067" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="8069" class="Symbol">(</a><a id="8070" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8072" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8073" class="Symbol">))</a> <a id="8076" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8078" class="Symbol">(</a><a id="8079" href="/Substitution/#2744" class="Function">↑</a> <a id="8081" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8083" href="/Substitution/#8000" class="Bound">σ</a><a id="8084" class="Symbol">))</a> <a id="8087" href="/Substitution/#8056" class="Bound">x</a> <a id="8089" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8091" href="/Substitution/#8000" class="Bound">σ</a> <a id="8093" href="/Substitution/#8056" class="Bound">x</a>
   <a id="8098" href="/Substitution/#8045" class="Function">lemma</a> <a id="8104" class="Symbol">{</a><a id="8105" class="Argument">x</a> <a id="8107" class="Symbol">=</a> <a id="8109" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8110" class="Symbol">}</a> <a id="8112" class="Symbol">=</a> <a id="8114" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8122" href="/Substitution/#8045" class="Function">lemma</a> <a id="8128" class="Symbol">{</a><a id="8129" class="Argument">x</a> <a id="8131" class="Symbol">=</a> <a id="8133" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8135" href="/Substitution/#8135" class="Bound">x</a><a id="8136" class="Symbol">}</a> <a id="8138" class="Symbol">=</a> <a id="8140" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="Z-shift"></a><a id="8170" href="/Substitution/#8170" class="Function">Z-shift</a> <a id="8178" class="Symbol">:</a> <a id="8180" class="Symbol">∀{</a><a id="8182" href="/Substitution/#8182" class="Bound">Γ</a><a id="8183" class="Symbol">}{</a><a id="8185" href="/Substitution/#8185" class="Bound">A</a> <a id="8187" href="/Substitution/#8187" class="Bound">B</a><a id="8188" class="Symbol">}</a>
        <a id="8198" class="Symbol">→</a> <a id="8200" class="Symbol">((</a><a id="8202" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8204" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8205" class="Symbol">)</a> <a id="8207" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8209" href="/Substitution/#2744" class="Function">↑</a><a id="8210" class="Symbol">)</a> <a id="8212" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8214" href="/Substitution/#2589" class="Function">ids</a> <a id="8218" class="Symbol">{</a><a id="8219" href="/Substitution/#8182" class="Bound">Γ</a> <a id="8221" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8223" href="/Substitution/#8185" class="Bound">A</a><a id="8224" class="Symbol">}</a> <a id="8226" class="Symbol">{</a><a id="8227" href="/Substitution/#8187" class="Bound">B</a><a id="8228" class="Symbol">}</a>
<a id="8230" href="/Substitution/#8170" class="Function">Z-shift</a> <a id="8238" class="Symbol">{</a><a id="8239" href="/Substitution/#8239" class="Bound">Γ</a><a id="8240" class="Symbol">}{</a><a id="8242" href="/Substitution/#8242" class="Bound">A</a><a id="8243" class="Symbol">}{</a><a id="8245" href="/Substitution/#8245" class="Bound">B</a><a id="8246" class="Symbol">}</a> <a id="8248" class="Symbol">=</a> <a id="8250" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="8265" href="/Substitution/#8284" class="Function">lemma</a> 
   <a id="8275" class="Keyword">where</a>
   <a id="8284" href="/Substitution/#8284" class="Function">lemma</a> <a id="8290" class="Symbol">:</a> <a id="8292" class="Symbol">(</a><a id="8293" href="/Substitution/#8293" class="Bound">x</a> <a id="8295" class="Symbol">:</a> <a id="8297" href="/Substitution/#8239" class="Bound">Γ</a> <a id="8299" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8301" href="/Substitution/#8242" class="Bound">A</a> <a id="8303" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="8305" href="/Substitution/#8245" class="Bound">B</a><a id="8306" class="Symbol">)</a> <a id="8308" class="Symbol">→</a> <a id="8310" class="Symbol">((</a><a id="8312" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8314" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8315" class="Symbol">)</a> <a id="8317" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8319" href="/Substitution/#2744" class="Function">↑</a><a id="8320" class="Symbol">)</a> <a id="8322" href="/Substitution/#8293" class="Bound">x</a> <a id="8324" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8326" href="/Substitution/#2589" class="Function">ids</a> <a id="8330" href="/Substitution/#8293" class="Bound">x</a>
   <a id="8335" href="/Substitution/#8284" class="Function">lemma</a> <a id="8341" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="8343" class="Symbol">=</a> <a id="8345" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8353" href="/Substitution/#8284" class="Function">lemma</a> <a id="8359" class="Symbol">(</a><a id="8360" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8362" href="/Substitution/#8362" class="Bound">y</a><a id="8363" class="Symbol">)</a> <a id="8365" class="Symbol">=</a> <a id="8367" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-idL"></a><a id="8397" href="/Substitution/#8397" class="Function">sub-idL</a> <a id="8405" class="Symbol">:</a> <a id="8407" class="Symbol">∀{</a><a id="8409" href="/Substitution/#8409" class="Bound">Γ</a> <a id="8411" href="/Substitution/#8411" class="Bound">Δ</a><a id="8412" class="Symbol">}</a> <a id="8414" class="Symbol">{</a><a id="8415" href="/Substitution/#8415" class="Bound">σ</a> <a id="8417" class="Symbol">:</a> <a id="8419" href="/Soundness/#2673" class="Function">Subst</a> <a id="8425" href="/Substitution/#8409" class="Bound">Γ</a> <a id="8427" href="/Substitution/#8411" class="Bound">Δ</a><a id="8428" class="Symbol">}</a> <a id="8430" class="Symbol">{</a><a id="8431" href="/Substitution/#8431" class="Bound">A</a><a id="8432" class="Symbol">}</a>
       <a id="8441" class="Symbol">→</a> <a id="8443" href="/Substitution/#2589" class="Function">ids</a> <a id="8447" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8449" href="/Substitution/#8415" class="Bound">σ</a> <a id="8451" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8453" href="/Substitution/#8415" class="Bound">σ</a> <a id="8455" class="Symbol">{</a><a id="8456" href="/Substitution/#8431" class="Bound">A</a><a id="8457" class="Symbol">}</a>
<a id="8459" href="/Substitution/#8397" class="Function">sub-idL</a> <a id="8467" class="Symbol">=</a> <a id="8469" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="8484" class="Symbol">λ</a> <a id="8486" href="/Substitution/#8486" class="Bound">x</a> <a id="8488" class="Symbol">→</a> <a id="8490" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-dist"></a><a id="8520" href="/Substitution/#8520" class="Function">sub-dist</a> <a id="8529" class="Symbol">:</a>  <a id="8532" class="Symbol">∀{</a><a id="8534" href="/Substitution/#8534" class="Bound">Γ</a> <a id="8536" href="/Substitution/#8536" class="Bound">Δ</a> <a id="8538" href="/Substitution/#8538" class="Bound">Σ</a> <a id="8540" class="Symbol">:</a> <a id="8542" href="/Untyped/#2980" class="Datatype">Context</a><a id="8549" class="Symbol">}</a> <a id="8551" class="Symbol">{</a><a id="8552" href="/Substitution/#8552" class="Bound">A</a> <a id="8554" href="/Substitution/#8554" class="Bound">B</a><a id="8555" class="Symbol">}</a> <a id="8557" class="Symbol">{</a><a id="8558" href="/Substitution/#8558" class="Bound">σ</a> <a id="8560" class="Symbol">:</a> <a id="8562" href="/Soundness/#2673" class="Function">Subst</a> <a id="8568" href="/Substitution/#8534" class="Bound">Γ</a> <a id="8570" href="/Substitution/#8536" class="Bound">Δ</a><a id="8571" class="Symbol">}</a> <a id="8573" class="Symbol">{</a><a id="8574" href="/Substitution/#8574" class="Bound">τ</a> <a id="8576" class="Symbol">:</a> <a id="8578" href="/Soundness/#2673" class="Function">Subst</a> <a id="8584" href="/Substitution/#8536" class="Bound">Δ</a> <a id="8586" href="/Substitution/#8538" class="Bound">Σ</a><a id="8587" class="Symbol">}</a>
              <a id="8603" class="Symbol">{</a><a id="8604" href="/Substitution/#8604" class="Bound">M</a> <a id="8606" class="Symbol">:</a> <a id="8608" href="/Substitution/#8536" class="Bound">Δ</a> <a id="8610" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8612" href="/Substitution/#8552" class="Bound">A</a><a id="8613" class="Symbol">}</a>
         <a id="8624" class="Symbol">→</a> <a id="8626" class="Symbol">((</a><a id="8628" href="/Substitution/#8604" class="Bound">M</a> <a id="8630" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8632" href="/Substitution/#8558" class="Bound">σ</a><a id="8633" class="Symbol">)</a> <a id="8635" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8637" href="/Substitution/#8574" class="Bound">τ</a><a id="8638" class="Symbol">)</a> <a id="8640" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8642" class="Symbol">((</a><a id="8644" href="/Untyped/#6931" class="Function">subst</a> <a id="8650" href="/Substitution/#8574" class="Bound">τ</a> <a id="8652" href="/Substitution/#8604" class="Bound">M</a><a id="8653" class="Symbol">)</a> <a id="8655" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8657" class="Symbol">(</a><a id="8658" href="/Substitution/#8558" class="Bound">σ</a> <a id="8660" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8662" href="/Substitution/#8574" class="Bound">τ</a><a id="8663" class="Symbol">))</a> <a id="8666" class="Symbol">{</a><a id="8667" href="/Substitution/#8554" class="Bound">B</a><a id="8668" class="Symbol">}</a>
<a id="8670" href="/Substitution/#8520" class="Function">sub-dist</a> <a id="8679" class="Symbol">{</a><a id="8680" href="/Substitution/#8680" class="Bound">Γ</a><a id="8681" class="Symbol">}{</a><a id="8683" href="/Substitution/#8683" class="Bound">Δ</a><a id="8684" class="Symbol">}{</a><a id="8686" href="/Substitution/#8686" class="Bound">Σ</a><a id="8687" class="Symbol">}{</a><a id="8689" href="/Substitution/#8689" class="Bound">A</a><a id="8690" class="Symbol">}{</a><a id="8692" href="/Substitution/#8692" class="Bound">B</a><a id="8693" class="Symbol">}{</a><a id="8695" href="/Substitution/#8695" class="Bound">σ</a><a id="8696" class="Symbol">}{</a><a id="8698" href="/Substitution/#8698" class="Bound">τ</a><a id="8699" class="Symbol">}{</a><a id="8701" href="/Substitution/#8701" class="Bound">M</a><a id="8702" class="Symbol">}</a> <a id="8704" class="Symbol">=</a> <a id="8706" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="8721" class="Symbol">λ</a> <a id="8723" href="/Substitution/#8723" class="Bound">x</a> <a id="8725" class="Symbol">→</a> <a id="8727" href="/Substitution/#8751" class="Function">lemma</a> <a id="8733" class="Symbol">{</a><a id="8734" class="Argument">x</a> <a id="8736" class="Symbol">=</a> <a id="8738" href="/Substitution/#8723" class="Bound">x</a><a id="8739" class="Symbol">}</a>
  <a id="8743" class="Keyword">where</a>
  <a id="8751" href="/Substitution/#8751" class="Function">lemma</a> <a id="8757" class="Symbol">:</a> <a id="8759" class="Symbol">∀</a> <a id="8761" class="Symbol">{</a><a id="8762" href="/Substitution/#8762" class="Bound">x</a> <a id="8764" class="Symbol">:</a> <a id="8766" href="/Substitution/#8680" class="Bound">Γ</a> <a id="8768" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8770" href="/Substitution/#8689" class="Bound">A</a> <a id="8772" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="8774" href="/Substitution/#8692" class="Bound">B</a><a id="8775" class="Symbol">}</a> <a id="8777" class="Symbol">→</a> <a id="8779" class="Symbol">((</a><a id="8781" href="/Substitution/#8701" class="Bound">M</a> <a id="8783" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8785" href="/Substitution/#8695" class="Bound">σ</a><a id="8786" class="Symbol">)</a> <a id="8788" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8790" href="/Substitution/#8698" class="Bound">τ</a><a id="8791" class="Symbol">)</a> <a id="8793" href="/Substitution/#8762" class="Bound">x</a> <a id="8795" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8797" class="Symbol">((</a><a id="8799" href="/Untyped/#6931" class="Function">subst</a> <a id="8805" href="/Substitution/#8698" class="Bound">τ</a> <a id="8807" href="/Substitution/#8701" class="Bound">M</a><a id="8808" class="Symbol">)</a> <a id="8810" href="/Substitution/#3002" class="Function Operator">•</a> <a id="8812" class="Symbol">(</a><a id="8813" href="/Substitution/#8695" class="Bound">σ</a> <a id="8815" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="8817" href="/Substitution/#8698" class="Bound">τ</a><a id="8818" class="Symbol">))</a> <a id="8821" href="/Substitution/#8762" class="Bound">x</a>
  <a id="8825" href="/Substitution/#8751" class="Function">lemma</a> <a id="8831" class="Symbol">{</a><a id="8832" class="Argument">x</a> <a id="8834" class="Symbol">=</a> <a id="8836" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8837" class="Symbol">}</a> <a id="8839" class="Symbol">=</a> <a id="8841" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="8848" href="/Substitution/#8751" class="Function">lemma</a> <a id="8854" class="Symbol">{</a><a id="8855" class="Argument">x</a> <a id="8857" class="Symbol">=</a> <a id="8859" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8861" href="/Substitution/#8861" class="Bound">x</a><a id="8862" class="Symbol">}</a> <a id="8864" class="Symbol">=</a> <a id="8866" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-app"></a><a id="8896" href="/Substitution/#8896" class="Function">sub-app</a> <a id="8904" class="Symbol">:</a> <a id="8906" class="Symbol">∀{</a><a id="8908" href="/Substitution/#8908" class="Bound">Γ</a> <a id="8910" href="/Substitution/#8910" class="Bound">Δ</a><a id="8911" class="Symbol">}</a> <a id="8913" class="Symbol">{</a><a id="8914" href="/Substitution/#8914" class="Bound">σ</a> <a id="8916" class="Symbol">:</a> <a id="8918" href="/Soundness/#2673" class="Function">Subst</a> <a id="8924" href="/Substitution/#8908" class="Bound">Γ</a> <a id="8926" href="/Substitution/#8910" class="Bound">Δ</a><a id="8927" class="Symbol">}</a> <a id="8929" class="Symbol">{</a><a id="8930" href="/Substitution/#8930" class="Bound">L</a> <a id="8932" class="Symbol">:</a> <a id="8934" href="/Substitution/#8908" class="Bound">Γ</a> <a id="8936" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8938" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="8939" class="Symbol">}{</a><a id="8941" href="/Substitution/#8941" class="Bound">M</a> <a id="8943" class="Symbol">:</a> <a id="8945" href="/Substitution/#8908" class="Bound">Γ</a> <a id="8947" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8949" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="8950" class="Symbol">}</a>
        <a id="8960" class="Symbol">→</a> <a id="8962" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="8964" href="/Substitution/#8914" class="Bound">σ</a> <a id="8966" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="8968" class="Symbol">(</a><a id="8969" href="/Substitution/#8930" class="Bound">L</a> <a id="8971" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="8973" href="/Substitution/#8941" class="Bound">M</a><a id="8974" class="Symbol">)</a>  <a id="8977" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8979" class="Symbol">(</a><a id="8980" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="8982" href="/Substitution/#8914" class="Bound">σ</a> <a id="8984" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="8986" href="/Substitution/#8930" class="Bound">L</a><a id="8987" class="Symbol">)</a> <a id="8989" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="8991" class="Symbol">(</a><a id="8992" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="8994" href="/Substitution/#8914" class="Bound">σ</a> <a id="8996" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="8998" href="/Substitution/#8941" class="Bound">M</a><a id="8999" class="Symbol">)</a>
<a id="9001" href="/Substitution/#8896" class="Function">sub-app</a> <a id="9009" class="Symbol">=</a> <a id="9011" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="interlude-congruences">Interlude: congruences</h2>

<p>In this section we establish congruence rules for the σ algebra
operators <code class="highlighter-rouge">•</code> and <code class="highlighter-rouge">⨟</code> and for <code class="highlighter-rouge">subst</code> and its helper functions <code class="highlighter-rouge">ext</code>,
<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, and <code class="highlighter-rouge">subst-zero</code>. These congruence rules help with
the equational reasoning in the later sections of this chapter.</p>

<p>[JGS: I would have liked to prove all of these via cong and cong₂,
 but I have not yet found a way to make that work. It seems that
 various implicit parameters get in the way.]</p>

<pre class="Agda"><a id="cong-ext"></a><a id="9524" href="/Substitution/#9524" class="Function">cong-ext</a> <a id="9533" class="Symbol">:</a> <a id="9535" class="Symbol">∀{</a><a id="9537" href="/Substitution/#9537" class="Bound">Γ</a> <a id="9539" href="/Substitution/#9539" class="Bound">Δ</a><a id="9540" class="Symbol">}{</a><a id="9542" href="/Substitution/#9542" class="Bound">ρ</a> <a id="9544" href="/Substitution/#9544" class="Bound">ρ&#39;</a> <a id="9547" class="Symbol">:</a> <a id="9549" href="/Denotational/#23286" class="Function">Rename</a> <a id="9556" href="/Substitution/#9537" class="Bound">Γ</a> <a id="9558" href="/Substitution/#9539" class="Bound">Δ</a><a id="9559" class="Symbol">}{</a><a id="9561" href="/Substitution/#9561" class="Bound">B</a><a id="9562" class="Symbol">}</a>
   <a id="9567" class="Symbol">→</a> <a id="9569" class="Symbol">(∀{</a><a id="9572" href="/Substitution/#9572" class="Bound">A</a><a id="9573" class="Symbol">}</a> <a id="9575" class="Symbol">→</a> <a id="9577" href="/Substitution/#9542" class="Bound">ρ</a> <a id="9579" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9581" href="/Substitution/#9544" class="Bound">ρ&#39;</a> <a id="9584" class="Symbol">{</a><a id="9585" href="/Substitution/#9572" class="Bound">A</a><a id="9586" class="Symbol">})</a>
     <a id="9594" class="Comment">---------------------------------</a>
   <a id="9631" class="Symbol">→</a> <a id="9633" class="Symbol">∀{</a><a id="9635" href="/Substitution/#9635" class="Bound">A</a><a id="9636" class="Symbol">}</a> <a id="9638" class="Symbol">→</a> <a id="9640" href="/Untyped/#5845" class="Function">ext</a> <a id="9644" href="/Substitution/#9542" class="Bound">ρ</a> <a id="9646" class="Symbol">{</a><a id="9647" class="Argument">B</a> <a id="9649" class="Symbol">=</a> <a id="9651" href="/Substitution/#9561" class="Bound">B</a><a id="9652" class="Symbol">}</a> <a id="9654" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9656" href="/Untyped/#5845" class="Function">ext</a> <a id="9660" href="/Substitution/#9544" class="Bound">ρ&#39;</a> <a id="9663" class="Symbol">{</a><a id="9664" href="/Substitution/#9635" class="Bound">A</a><a id="9665" class="Symbol">}</a>
<a id="9667" href="/Substitution/#9524" class="Function">cong-ext</a><a id="9675" class="Symbol">{</a><a id="9676" href="/Substitution/#9676" class="Bound">Γ</a><a id="9677" class="Symbol">}{</a><a id="9679" href="/Substitution/#9679" class="Bound">Δ</a><a id="9680" class="Symbol">}{</a><a id="9682" href="/Substitution/#9682" class="Bound">ρ</a><a id="9683" class="Symbol">}{</a><a id="9685" href="/Substitution/#9685" class="Bound">ρ&#39;</a><a id="9687" class="Symbol">}{</a><a id="9689" href="/Substitution/#9689" class="Bound">B</a><a id="9690" class="Symbol">}</a> <a id="9692" href="/Substitution/#9692" class="Bound">rr</a> <a id="9695" class="Symbol">{</a><a id="9696" href="/Substitution/#9696" class="Bound">A</a><a id="9697" class="Symbol">}</a> <a id="9699" class="Symbol">=</a> <a id="9701" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="9716" class="Symbol">λ</a> <a id="9718" href="/Substitution/#9718" class="Bound">x</a> <a id="9720" class="Symbol">→</a> <a id="9722" href="/Substitution/#9742" class="Function">lemma</a> <a id="9728" class="Symbol">{</a><a id="9729" href="/Substitution/#9718" class="Bound">x</a><a id="9730" class="Symbol">}</a>
  <a id="9734" class="Keyword">where</a>
  <a id="9742" href="/Substitution/#9742" class="Function">lemma</a> <a id="9748" class="Symbol">:</a> <a id="9750" class="Symbol">∀{</a><a id="9752" href="/Substitution/#9752" class="Bound">x</a> <a id="9754" class="Symbol">:</a> <a id="9756" href="/Substitution/#9676" class="Bound">Γ</a> <a id="9758" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9760" href="/Substitution/#9689" class="Bound">B</a> <a id="9762" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9764" href="/Substitution/#9696" class="Bound">A</a><a id="9765" class="Symbol">}</a> <a id="9767" class="Symbol">→</a> <a id="9769" href="/Untyped/#5845" class="Function">ext</a> <a id="9773" href="/Substitution/#9682" class="Bound">ρ</a> <a id="9775" href="/Substitution/#9752" class="Bound">x</a> <a id="9777" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9779" href="/Untyped/#5845" class="Function">ext</a> <a id="9783" href="/Substitution/#9685" class="Bound">ρ&#39;</a> <a id="9786" href="/Substitution/#9752" class="Bound">x</a>
  <a id="9790" href="/Substitution/#9742" class="Function">lemma</a> <a id="9796" class="Symbol">{</a><a id="9797" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9798" class="Symbol">}</a> <a id="9800" class="Symbol">=</a> <a id="9802" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="9809" href="/Substitution/#9742" class="Function">lemma</a> <a id="9815" class="Symbol">{</a><a id="9816" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9818" href="/Substitution/#9818" class="Bound">y</a><a id="9819" class="Symbol">}</a> <a id="9821" class="Symbol">=</a> <a id="9823" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="9828" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="9831" class="Symbol">(</a><a id="9832" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="9841" href="/Substitution/#9692" class="Bound">rr</a> <a id="9844" href="/Substitution/#9818" class="Bound">y</a><a id="9845" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-rename"></a><a id="9872" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="9884" class="Symbol">:</a> <a id="9886" class="Symbol">∀{</a><a id="9888" href="/Substitution/#9888" class="Bound">Γ</a> <a id="9890" href="/Substitution/#9890" class="Bound">Δ</a><a id="9891" class="Symbol">}{</a><a id="9893" href="/Substitution/#9893" class="Bound">ρ</a> <a id="9895" href="/Substitution/#9895" class="Bound">ρ&#39;</a> <a id="9898" class="Symbol">:</a> <a id="9900" href="/Denotational/#23286" class="Function">Rename</a> <a id="9907" href="/Substitution/#9888" class="Bound">Γ</a> <a id="9909" href="/Substitution/#9890" class="Bound">Δ</a><a id="9910" class="Symbol">}{</a><a id="9912" href="/Substitution/#9912" class="Bound">B</a><a id="9913" class="Symbol">}{</a><a id="9915" href="/Substitution/#9915" class="Bound">M</a> <a id="9917" href="/Substitution/#9917" class="Bound">M&#39;</a> <a id="9920" class="Symbol">:</a> <a id="9922" href="/Substitution/#9888" class="Bound">Γ</a> <a id="9924" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9926" href="/Substitution/#9912" class="Bound">B</a><a id="9927" class="Symbol">}</a>
        <a id="9937" class="Symbol">→</a> <a id="9939" class="Symbol">(∀{</a><a id="9942" href="/Substitution/#9942" class="Bound">A</a><a id="9943" class="Symbol">}</a> <a id="9945" class="Symbol">→</a> <a id="9947" href="/Substitution/#9893" class="Bound">ρ</a> <a id="9949" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9951" href="/Substitution/#9895" class="Bound">ρ&#39;</a> <a id="9954" class="Symbol">{</a><a id="9955" href="/Substitution/#9942" class="Bound">A</a><a id="9956" class="Symbol">})</a>  <a id="9960" class="Symbol">→</a>  <a id="9963" href="/Substitution/#9915" class="Bound">M</a> <a id="9965" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9967" href="/Substitution/#9917" class="Bound">M&#39;</a>
          <a id="9980" class="Comment">------------------------------</a>
        <a id="10019" class="Symbol">→</a> <a id="10021" href="/Untyped/#6171" class="Function">rename</a> <a id="10028" href="/Substitution/#9893" class="Bound">ρ</a> <a id="10030" href="/Substitution/#9915" class="Bound">M</a> <a id="10032" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10034" href="/Untyped/#6171" class="Function">rename</a> <a id="10041" href="/Substitution/#9895" class="Bound">ρ&#39;</a> <a id="10044" href="/Substitution/#9915" class="Bound">M</a>
<a id="10046" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10058" class="Symbol">{</a><a id="10059" class="Argument">M</a> <a id="10061" class="Symbol">=</a> <a id="10063" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="10065" href="/Substitution/#10065" class="Bound">x</a><a id="10066" class="Symbol">}</a> <a id="10068" href="/Substitution/#10068" class="Bound">rr</a> <a id="10071" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10076" class="Symbol">=</a> <a id="10078" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10083" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a> <a id="10086" class="Symbol">(</a><a id="10087" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10096" href="/Substitution/#10068" class="Bound">rr</a> <a id="10099" href="/Substitution/#10065" class="Bound">x</a><a id="10100" class="Symbol">)</a>
<a id="10102" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10114" class="Symbol">{</a><a id="10115" class="Argument">ρ</a> <a id="10117" class="Symbol">=</a> <a id="10119" href="/Substitution/#10119" class="Bound">ρ</a><a id="10120" class="Symbol">}</a> <a id="10122" class="Symbol">{</a><a id="10123" class="Argument">ρ&#39;</a> <a id="10126" class="Symbol">=</a> <a id="10128" href="/Substitution/#10128" class="Bound">ρ&#39;</a><a id="10130" class="Symbol">}</a> <a id="10132" class="Symbol">{</a><a id="10133" class="Argument">M</a> <a id="10135" class="Symbol">=</a> <a id="10137" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="10139" href="/Substitution/#10139" class="Bound">N</a><a id="10140" class="Symbol">}</a> <a id="10142" href="/Substitution/#10142" class="Bound">rr</a> <a id="10145" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10150" class="Symbol">=</a>
   <a id="10155" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10160" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="10163" class="Symbol">(</a><a id="10164" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10176" class="Symbol">{</a><a id="10177" class="Argument">ρ</a> <a id="10179" class="Symbol">=</a> <a id="10181" href="/Untyped/#5845" class="Function">ext</a> <a id="10185" href="/Substitution/#10119" class="Bound">ρ</a><a id="10186" class="Symbol">}{</a><a id="10188" class="Argument">ρ&#39;</a> <a id="10191" class="Symbol">=</a> <a id="10193" href="/Untyped/#5845" class="Function">ext</a> <a id="10197" href="/Substitution/#10128" class="Bound">ρ&#39;</a><a id="10199" class="Symbol">}{</a><a id="10201" class="Argument">M</a> <a id="10203" class="Symbol">=</a> <a id="10205" href="/Substitution/#10139" class="Bound">N</a><a id="10206" class="Symbol">}</a> <a id="10208" class="Symbol">(</a><a id="10209" href="/Substitution/#9524" class="Function">cong-ext</a> <a id="10218" href="/Substitution/#10142" class="Bound">rr</a><a id="10220" class="Symbol">)</a> <a id="10222" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10226" class="Symbol">)</a>
<a id="10228" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10240" class="Symbol">{</a><a id="10241" class="Argument">M</a> <a id="10243" class="Symbol">=</a> <a id="10245" href="/Substitution/#10245" class="Bound">L</a> <a id="10247" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="10249" href="/Substitution/#10249" class="Bound">M</a><a id="10250" class="Symbol">}</a> <a id="10252" href="/Substitution/#10252" class="Bound">rr</a> <a id="10255" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10260" class="Symbol">=</a>
   <a id="10265" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="10271" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="10275" class="Symbol">(</a><a id="10276" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10288" href="/Substitution/#10252" class="Bound">rr</a> <a id="10291" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10295" class="Symbol">)</a> <a id="10297" class="Symbol">(</a><a id="10298" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="10310" href="/Substitution/#10252" class="Bound">rr</a> <a id="10313" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="10317" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-exts"></a><a id="10344" href="/Substitution/#10344" class="Function">cong-exts</a> <a id="10354" class="Symbol">:</a> <a id="10356" class="Symbol">∀{</a><a id="10358" href="/Substitution/#10358" class="Bound">Γ</a> <a id="10360" href="/Substitution/#10360" class="Bound">Δ</a><a id="10361" class="Symbol">}{</a><a id="10363" href="/Substitution/#10363" class="Bound">σ</a> <a id="10365" href="/Substitution/#10365" class="Bound">σ&#39;</a> <a id="10368" class="Symbol">:</a> <a id="10370" href="/Soundness/#2673" class="Function">Subst</a> <a id="10376" href="/Substitution/#10358" class="Bound">Γ</a> <a id="10378" href="/Substitution/#10360" class="Bound">Δ</a><a id="10379" class="Symbol">}{</a><a id="10381" href="/Substitution/#10381" class="Bound">B</a><a id="10382" class="Symbol">}</a>
   <a id="10387" class="Symbol">→</a> <a id="10389" class="Symbol">(∀{</a><a id="10392" href="/Substitution/#10392" class="Bound">A</a><a id="10393" class="Symbol">}</a> <a id="10395" class="Symbol">→</a> <a id="10397" href="/Substitution/#10363" class="Bound">σ</a> <a id="10399" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10401" href="/Substitution/#10365" class="Bound">σ&#39;</a> <a id="10404" class="Symbol">{</a><a id="10405" href="/Substitution/#10392" class="Bound">A</a><a id="10406" class="Symbol">})</a>
     <a id="10414" class="Comment">-----------------------------------</a>
   <a id="10453" class="Symbol">→</a> <a id="10455" class="Symbol">∀{</a><a id="10457" href="/Substitution/#10457" class="Bound">A</a><a id="10458" class="Symbol">}</a> <a id="10460" class="Symbol">→</a> <a id="10462" href="/Untyped/#6623" class="Function">exts</a> <a id="10467" href="/Substitution/#10363" class="Bound">σ</a> <a id="10469" class="Symbol">{</a><a id="10470" class="Argument">B</a> <a id="10472" class="Symbol">=</a> <a id="10474" href="/Substitution/#10381" class="Bound">B</a><a id="10475" class="Symbol">}</a> <a id="10477" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10479" href="/Untyped/#6623" class="Function">exts</a> <a id="10484" href="/Substitution/#10365" class="Bound">σ&#39;</a> <a id="10487" class="Symbol">{</a><a id="10488" href="/Substitution/#10457" class="Bound">A</a><a id="10489" class="Symbol">}</a>
<a id="10491" href="/Substitution/#10344" class="Function">cong-exts</a><a id="10500" class="Symbol">{</a><a id="10501" href="/Substitution/#10501" class="Bound">Γ</a><a id="10502" class="Symbol">}{</a><a id="10504" href="/Substitution/#10504" class="Bound">Δ</a><a id="10505" class="Symbol">}{</a><a id="10507" href="/Substitution/#10507" class="Bound">σ</a><a id="10508" class="Symbol">}{</a><a id="10510" href="/Substitution/#10510" class="Bound">σ&#39;</a><a id="10512" class="Symbol">}{</a><a id="10514" href="/Substitution/#10514" class="Bound">B</a><a id="10515" class="Symbol">}</a> <a id="10517" href="/Substitution/#10517" class="Bound">ss</a> <a id="10520" class="Symbol">{</a><a id="10521" href="/Substitution/#10521" class="Bound">A</a><a id="10522" class="Symbol">}</a> <a id="10524" class="Symbol">=</a> <a id="10526" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="10541" class="Symbol">λ</a> <a id="10543" href="/Substitution/#10543" class="Bound">x</a> <a id="10545" class="Symbol">→</a> <a id="10547" href="/Substitution/#10569" class="Function">lemma</a> <a id="10553" class="Symbol">{</a><a id="10554" href="/Substitution/#10543" class="Bound">x</a><a id="10555" class="Symbol">}</a>
   <a id="10560" class="Keyword">where</a>
   <a id="10569" href="/Substitution/#10569" class="Function">lemma</a> <a id="10575" class="Symbol">:</a> <a id="10577" class="Symbol">∀{</a><a id="10579" href="/Substitution/#10579" class="Bound">x</a><a id="10580" class="Symbol">}</a> <a id="10582" class="Symbol">→</a> <a id="10584" href="/Untyped/#6623" class="Function">exts</a> <a id="10589" href="/Substitution/#10507" class="Bound">σ</a> <a id="10591" href="/Substitution/#10579" class="Bound">x</a> <a id="10593" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10595" href="/Untyped/#6623" class="Function">exts</a> <a id="10600" href="/Substitution/#10510" class="Bound">σ&#39;</a> <a id="10603" href="/Substitution/#10579" class="Bound">x</a>
   <a id="10608" href="/Substitution/#10569" class="Function">lemma</a> <a id="10614" class="Symbol">{</a><a id="10615" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="10616" class="Symbol">}</a> <a id="10618" class="Symbol">=</a> <a id="10620" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="10628" href="/Substitution/#10569" class="Function">lemma</a> <a id="10634" class="Symbol">{</a><a id="10635" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="10637" href="/Substitution/#10637" class="Bound">x</a><a id="10638" class="Symbol">}</a> <a id="10640" class="Symbol">=</a> <a id="10642" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10647" class="Symbol">(</a><a id="10648" href="/Untyped/#6171" class="Function">rename</a> <a id="10655" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="10657" class="Symbol">)</a> <a id="10659" class="Symbol">(</a><a id="10660" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10669" class="Symbol">(</a><a id="10670" href="/Substitution/#10517" class="Bound">ss</a> <a id="10673" class="Symbol">{</a><a id="10674" href="/Substitution/#10521" class="Bound">A</a><a id="10675" class="Symbol">})</a> <a id="10678" href="/Substitution/#10637" class="Bound">x</a><a id="10679" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub"></a><a id="10706" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="10715" class="Symbol">:</a> <a id="10717" class="Symbol">∀{</a><a id="10719" href="/Substitution/#10719" class="Bound">Γ</a> <a id="10721" href="/Substitution/#10721" class="Bound">Δ</a><a id="10722" class="Symbol">}{</a><a id="10724" href="/Substitution/#10724" class="Bound">σ</a> <a id="10726" href="/Substitution/#10726" class="Bound">σ&#39;</a> <a id="10729" class="Symbol">:</a> <a id="10731" href="/Soundness/#2673" class="Function">Subst</a> <a id="10737" href="/Substitution/#10719" class="Bound">Γ</a> <a id="10739" href="/Substitution/#10721" class="Bound">Δ</a><a id="10740" class="Symbol">}{</a><a id="10742" href="/Substitution/#10742" class="Bound">A</a><a id="10743" class="Symbol">}{</a><a id="10745" href="/Substitution/#10745" class="Bound">M</a> <a id="10747" href="/Substitution/#10747" class="Bound">M&#39;</a> <a id="10750" class="Symbol">:</a> <a id="10752" href="/Substitution/#10719" class="Bound">Γ</a> <a id="10754" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="10756" href="/Substitution/#10742" class="Bound">A</a><a id="10757" class="Symbol">}</a>
            <a id="10771" class="Symbol">→</a> <a id="10773" class="Symbol">(∀{</a><a id="10776" href="/Substitution/#10776" class="Bound">A</a><a id="10777" class="Symbol">}</a> <a id="10779" class="Symbol">→</a> <a id="10781" href="/Substitution/#10724" class="Bound">σ</a> <a id="10783" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10785" href="/Substitution/#10726" class="Bound">σ&#39;</a> <a id="10788" class="Symbol">{</a><a id="10789" href="/Substitution/#10776" class="Bound">A</a><a id="10790" class="Symbol">})</a>  <a id="10794" class="Symbol">→</a>  <a id="10797" href="/Substitution/#10745" class="Bound">M</a> <a id="10799" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10801" href="/Substitution/#10747" class="Bound">M&#39;</a>
              <a id="10818" class="Comment">------------------------------</a>
            <a id="10861" class="Symbol">→</a> <a id="10863" href="/Untyped/#6931" class="Function">subst</a> <a id="10869" href="/Substitution/#10724" class="Bound">σ</a> <a id="10871" href="/Substitution/#10745" class="Bound">M</a> <a id="10873" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10875" href="/Untyped/#6931" class="Function">subst</a> <a id="10881" href="/Substitution/#10726" class="Bound">σ&#39;</a> <a id="10884" href="/Substitution/#10747" class="Bound">M&#39;</a>
<a id="10887" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="10896" class="Symbol">{</a><a id="10897" href="/Substitution/#10897" class="Bound">Γ</a><a id="10898" class="Symbol">}</a> <a id="10900" class="Symbol">{</a><a id="10901" href="/Substitution/#10901" class="Bound">Δ</a><a id="10902" class="Symbol">}</a> <a id="10904" class="Symbol">{</a><a id="10905" href="/Substitution/#10905" class="Bound">σ</a><a id="10906" class="Symbol">}</a> <a id="10908" class="Symbol">{</a><a id="10909" href="/Substitution/#10909" class="Bound">σ&#39;</a><a id="10911" class="Symbol">}</a> <a id="10913" class="Symbol">{</a><a id="10914" href="/Substitution/#10914" class="Bound">A</a><a id="10915" class="Symbol">}</a> <a id="10917" class="Symbol">{</a><a id="10918" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="10920" href="/Substitution/#10920" class="Bound">x</a><a id="10921" class="Symbol">}</a> <a id="10923" href="/Substitution/#10923" class="Bound">ss</a> <a id="10926" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10931" class="Symbol">=</a> <a id="10933" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10942" href="/Substitution/#10923" class="Bound">ss</a> <a id="10945" href="/Substitution/#10920" class="Bound">x</a>
<a id="10947" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="10956" class="Symbol">{</a><a id="10957" href="/Substitution/#10957" class="Bound">Γ</a><a id="10958" class="Symbol">}</a> <a id="10960" class="Symbol">{</a><a id="10961" href="/Substitution/#10961" class="Bound">Δ</a><a id="10962" class="Symbol">}</a> <a id="10964" class="Symbol">{</a><a id="10965" href="/Substitution/#10965" class="Bound">σ</a><a id="10966" class="Symbol">}</a> <a id="10968" class="Symbol">{</a><a id="10969" href="/Substitution/#10969" class="Bound">σ&#39;</a><a id="10971" class="Symbol">}</a> <a id="10973" class="Symbol">{</a><a id="10974" href="/Substitution/#10974" class="Bound">A</a><a id="10975" class="Symbol">}</a> <a id="10977" class="Symbol">{</a><a id="10978" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="10980" href="/Substitution/#10980" class="Bound">M</a><a id="10981" class="Symbol">}</a> <a id="10983" href="/Substitution/#10983" class="Bound">ss</a> <a id="10986" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10991" class="Symbol">=</a>
   <a id="10996" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11001" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11004" class="Symbol">(</a><a id="11005" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="11014" class="Symbol">{</a><a id="11015" class="Argument">σ</a> <a id="11017" class="Symbol">=</a> <a id="11019" href="/Untyped/#6623" class="Function">exts</a> <a id="11024" href="/Substitution/#10965" class="Bound">σ</a><a id="11025" class="Symbol">}{</a><a id="11027" class="Argument">σ&#39;</a> <a id="11030" class="Symbol">=</a> <a id="11032" href="/Untyped/#6623" class="Function">exts</a> <a id="11037" href="/Substitution/#10969" class="Bound">σ&#39;</a><a id="11039" class="Symbol">}</a> <a id="11041" class="Symbol">{</a><a id="11042" class="Argument">M</a> <a id="11044" class="Symbol">=</a> <a id="11046" href="/Substitution/#10980" class="Bound">M</a><a id="11047" class="Symbol">}</a> <a id="11049" class="Symbol">(</a><a id="11050" href="/Substitution/#10344" class="Function">cong-exts</a> <a id="11060" href="/Substitution/#10983" class="Bound">ss</a><a id="11062" class="Symbol">)</a> <a id="11064" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11068" class="Symbol">)</a>
<a id="11070" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="11079" class="Symbol">{</a><a id="11080" href="/Substitution/#11080" class="Bound">Γ</a><a id="11081" class="Symbol">}</a> <a id="11083" class="Symbol">{</a><a id="11084" href="/Substitution/#11084" class="Bound">Δ</a><a id="11085" class="Symbol">}</a> <a id="11087" class="Symbol">{</a><a id="11088" href="/Substitution/#11088" class="Bound">σ</a><a id="11089" class="Symbol">}</a> <a id="11091" class="Symbol">{</a><a id="11092" href="/Substitution/#11092" class="Bound">σ&#39;</a><a id="11094" class="Symbol">}</a> <a id="11096" class="Symbol">{</a><a id="11097" href="/Substitution/#11097" class="Bound">A</a><a id="11098" class="Symbol">}</a> <a id="11100" class="Symbol">{</a><a id="11101" href="/Substitution/#11101" class="Bound">L</a> <a id="11103" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11105" href="/Substitution/#11105" class="Bound">M</a><a id="11106" class="Symbol">}</a> <a id="11108" href="/Substitution/#11108" class="Bound">ss</a> <a id="11111" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11116" class="Symbol">=</a> 
   <a id="11122" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11128" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11132" class="Symbol">(</a><a id="11133" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="11142" class="Symbol">{</a><a id="11143" class="Argument">M</a> <a id="11145" class="Symbol">=</a> <a id="11147" href="/Substitution/#11101" class="Bound">L</a><a id="11148" class="Symbol">}</a> <a id="11150" href="/Substitution/#11108" class="Bound">ss</a> <a id="11153" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11157" class="Symbol">)</a> <a id="11159" class="Symbol">(</a><a id="11160" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="11169" class="Symbol">{</a><a id="11170" class="Argument">M</a> <a id="11172" class="Symbol">=</a> <a id="11174" href="/Substitution/#11105" class="Bound">M</a><a id="11175" class="Symbol">}</a> <a id="11177" href="/Substitution/#11108" class="Bound">ss</a> <a id="11180" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11184" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub-zero"></a><a id="11211" href="/Substitution/#11211" class="Function">cong-sub-zero</a> <a id="11225" class="Symbol">:</a> <a id="11227" class="Symbol">∀{</a><a id="11229" href="/Substitution/#11229" class="Bound">Γ</a><a id="11230" class="Symbol">}{</a><a id="11232" href="/Substitution/#11232" class="Bound">B</a> <a id="11234" class="Symbol">:</a> <a id="11236" href="/Untyped/#2675" class="Datatype">Type</a><a id="11240" class="Symbol">}{</a><a id="11242" href="/Substitution/#11242" class="Bound">M</a> <a id="11244" href="/Substitution/#11244" class="Bound">M&#39;</a> <a id="11247" class="Symbol">:</a> <a id="11249" href="/Substitution/#11229" class="Bound">Γ</a> <a id="11251" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11253" href="/Substitution/#11232" class="Bound">B</a><a id="11254" class="Symbol">}</a>
  <a id="11258" class="Symbol">→</a> <a id="11260" href="/Substitution/#11242" class="Bound">M</a> <a id="11262" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11264" href="/Substitution/#11244" class="Bound">M&#39;</a>
    <a id="11271" class="Comment">-----------------------------------------</a>
  <a id="11315" class="Symbol">→</a> <a id="11317" class="Symbol">∀{</a><a id="11319" href="/Substitution/#11319" class="Bound">A</a><a id="11320" class="Symbol">}</a> <a id="11322" class="Symbol">→</a> <a id="11324" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11335" href="/Substitution/#11242" class="Bound">M</a> <a id="11337" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11339" class="Symbol">(</a><a id="11340" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11351" href="/Substitution/#11244" class="Bound">M&#39;</a><a id="11353" class="Symbol">)</a> <a id="11355" class="Symbol">{</a><a id="11356" href="/Substitution/#11319" class="Bound">A</a><a id="11357" class="Symbol">}</a>
<a id="11359" href="/Substitution/#11211" class="Function">cong-sub-zero</a> <a id="11373" class="Symbol">{</a><a id="11374" href="/Substitution/#11374" class="Bound">Γ</a><a id="11375" class="Symbol">}{</a><a id="11377" href="/Substitution/#11377" class="Bound">B</a><a id="11378" class="Symbol">}{</a><a id="11380" href="/Substitution/#11380" class="Bound">M</a><a id="11381" class="Symbol">}{</a><a id="11383" href="/Substitution/#11383" class="Bound">M&#39;</a><a id="11385" class="Symbol">}</a> <a id="11387" href="/Substitution/#11387" class="Bound">mm&#39;</a> <a id="11391" class="Symbol">{</a><a id="11392" href="/Substitution/#11392" class="Bound">A</a><a id="11393" class="Symbol">}</a> <a id="11395" class="Symbol">=</a>
   <a id="11400" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="11415" class="Symbol">λ</a> <a id="11417" href="/Substitution/#11417" class="Bound">x</a> <a id="11419" class="Symbol">→</a> <a id="11421" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11426" class="Symbol">(λ</a> <a id="11429" href="/Substitution/#11429" class="Bound">z</a> <a id="11431" class="Symbol">→</a> <a id="11433" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="11444" href="/Substitution/#11429" class="Bound">z</a> <a id="11446" href="/Substitution/#11417" class="Bound">x</a><a id="11447" class="Symbol">)</a> <a id="11449" href="/Substitution/#11387" class="Bound">mm&#39;</a></pre>

<pre class="Agda"><a id="cong-cons"></a><a id="11478" href="/Substitution/#11478" class="Function">cong-cons</a> <a id="11488" class="Symbol">:</a> <a id="11490" class="Symbol">∀{</a><a id="11492" href="/Substitution/#11492" class="Bound">Γ</a> <a id="11494" href="/Substitution/#11494" class="Bound">Δ</a><a id="11495" class="Symbol">}{</a><a id="11497" href="/Substitution/#11497" class="Bound">A</a><a id="11498" class="Symbol">}{</a><a id="11500" href="/Substitution/#11500" class="Bound">M</a> <a id="11502" href="/Substitution/#11502" class="Bound">N</a> <a id="11504" class="Symbol">:</a> <a id="11506" href="/Substitution/#11494" class="Bound">Δ</a> <a id="11508" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11510" href="/Substitution/#11497" class="Bound">A</a><a id="11511" class="Symbol">}{</a><a id="11513" href="/Substitution/#11513" class="Bound">σ</a> <a id="11515" href="/Substitution/#11515" class="Bound">τ</a> <a id="11517" class="Symbol">:</a> <a id="11519" href="/Soundness/#2673" class="Function">Subst</a> <a id="11525" href="/Substitution/#11492" class="Bound">Γ</a> <a id="11527" href="/Substitution/#11494" class="Bound">Δ</a><a id="11528" class="Symbol">}</a>
  <a id="11532" class="Symbol">→</a> <a id="11534" href="/Substitution/#11500" class="Bound">M</a> <a id="11536" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11538" href="/Substitution/#11502" class="Bound">N</a>  <a id="11541" class="Symbol">→</a>  <a id="11544" class="Symbol">(∀{</a><a id="11547" href="/Substitution/#11547" class="Bound">A</a><a id="11548" class="Symbol">}</a> <a id="11550" class="Symbol">→</a> <a id="11552" href="/Substitution/#11513" class="Bound">σ</a> <a id="11554" class="Symbol">{</a><a id="11555" href="/Substitution/#11547" class="Bound">A</a><a id="11556" class="Symbol">}</a> <a id="11558" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11560" href="/Substitution/#11515" class="Bound">τ</a> <a id="11562" class="Symbol">{</a><a id="11563" href="/Substitution/#11547" class="Bound">A</a><a id="11564" class="Symbol">})</a>
    <a id="11571" class="Comment">--------------------------------</a>
  <a id="11606" class="Symbol">→</a> <a id="11608" class="Symbol">∀{</a><a id="11610" href="/Substitution/#11610" class="Bound">A</a><a id="11611" class="Symbol">}</a> <a id="11613" class="Symbol">→</a> <a id="11615" class="Symbol">(</a><a id="11616" href="/Substitution/#11500" class="Bound">M</a> <a id="11618" href="/Substitution/#3002" class="Function Operator">•</a> <a id="11620" href="/Substitution/#11513" class="Bound">σ</a><a id="11621" class="Symbol">)</a> <a id="11623" class="Symbol">{</a><a id="11624" href="/Substitution/#11610" class="Bound">A</a><a id="11625" class="Symbol">}</a> <a id="11627" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11629" class="Symbol">(</a><a id="11630" href="/Substitution/#11502" class="Bound">N</a> <a id="11632" href="/Substitution/#3002" class="Function Operator">•</a> <a id="11634" href="/Substitution/#11515" class="Bound">τ</a><a id="11635" class="Symbol">)</a> <a id="11637" class="Symbol">{</a><a id="11638" href="/Substitution/#11610" class="Bound">A</a><a id="11639" class="Symbol">}</a>
<a id="11641" href="/Substitution/#11478" class="Function">cong-cons</a><a id="11650" class="Symbol">{</a><a id="11651" href="/Substitution/#11651" class="Bound">Γ</a><a id="11652" class="Symbol">}{</a><a id="11654" href="/Substitution/#11654" class="Bound">Δ</a><a id="11655" class="Symbol">}{</a><a id="11657" href="/Substitution/#11657" class="Bound">A</a><a id="11658" class="Symbol">}{</a><a id="11660" href="/Substitution/#11660" class="Bound">M</a><a id="11661" class="Symbol">}{</a><a id="11663" href="/Substitution/#11663" class="Bound">N</a><a id="11664" class="Symbol">}{</a><a id="11666" href="/Substitution/#11666" class="Bound">σ</a><a id="11667" class="Symbol">}{</a><a id="11669" href="/Substitution/#11669" class="Bound">τ</a><a id="11670" class="Symbol">}</a> <a id="11672" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11677" href="/Substitution/#11677" class="Bound">st</a> <a id="11680" class="Symbol">{</a><a id="11681" href="/Substitution/#11681" class="Bound">A&#39;</a><a id="11683" class="Symbol">}</a> <a id="11685" class="Symbol">=</a> <a id="11687" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="11702" href="/Substitution/#11718" class="Function">lemma</a>
  <a id="11710" class="Keyword">where</a>
  <a id="11718" href="/Substitution/#11718" class="Function">lemma</a> <a id="11724" class="Symbol">:</a> <a id="11726" class="Symbol">(</a><a id="11727" href="/Substitution/#11727" class="Bound">x</a> <a id="11729" class="Symbol">:</a> <a id="11731" href="/Substitution/#11651" class="Bound">Γ</a> <a id="11733" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="11735" href="/Substitution/#11657" class="Bound">A</a> <a id="11737" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="11739" href="/Substitution/#11681" class="Bound">A&#39;</a><a id="11741" class="Symbol">)</a> <a id="11743" class="Symbol">→</a> <a id="11745" class="Symbol">(</a><a id="11746" href="/Substitution/#11660" class="Bound">M</a> <a id="11748" href="/Substitution/#3002" class="Function Operator">•</a> <a id="11750" href="/Substitution/#11666" class="Bound">σ</a><a id="11751" class="Symbol">)</a> <a id="11753" href="/Substitution/#11727" class="Bound">x</a> <a id="11755" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11757" class="Symbol">(</a><a id="11758" href="/Substitution/#11660" class="Bound">M</a> <a id="11760" href="/Substitution/#3002" class="Function Operator">•</a> <a id="11762" href="/Substitution/#11669" class="Bound">τ</a><a id="11763" class="Symbol">)</a> <a id="11765" href="/Substitution/#11727" class="Bound">x</a>
  <a id="11769" href="/Substitution/#11718" class="Function">lemma</a> <a id="11775" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="11777" class="Symbol">=</a> <a id="11779" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="11786" href="/Substitution/#11718" class="Function">lemma</a> <a id="11792" class="Symbol">(</a><a id="11793" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="11795" href="/Substitution/#11795" class="Bound">x</a><a id="11796" class="Symbol">)</a> <a id="11798" class="Symbol">=</a> <a id="11800" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11809" href="/Substitution/#11677" class="Bound">st</a> <a id="11812" href="/Substitution/#11795" class="Bound">x</a></pre>

<pre class="Agda"><a id="cong-seq"></a><a id="11839" href="/Substitution/#11839" class="Function">cong-seq</a> <a id="11848" class="Symbol">:</a> <a id="11850" class="Symbol">∀{</a><a id="11852" href="/Substitution/#11852" class="Bound">Γ</a> <a id="11854" href="/Substitution/#11854" class="Bound">Δ</a> <a id="11856" href="/Substitution/#11856" class="Bound">Σ</a><a id="11857" class="Symbol">}{</a><a id="11859" href="/Substitution/#11859" class="Bound">σ</a> <a id="11861" href="/Substitution/#11861" class="Bound">σ&#39;</a> <a id="11864" class="Symbol">:</a> <a id="11866" href="/Soundness/#2673" class="Function">Subst</a> <a id="11872" href="/Substitution/#11852" class="Bound">Γ</a> <a id="11874" href="/Substitution/#11854" class="Bound">Δ</a><a id="11875" class="Symbol">}{</a><a id="11877" href="/Substitution/#11877" class="Bound">τ</a> <a id="11879" href="/Substitution/#11879" class="Bound">τ&#39;</a> <a id="11882" class="Symbol">:</a> <a id="11884" href="/Soundness/#2673" class="Function">Subst</a> <a id="11890" href="/Substitution/#11854" class="Bound">Δ</a> <a id="11892" href="/Substitution/#11856" class="Bound">Σ</a><a id="11893" class="Symbol">}</a>
  <a id="11897" class="Symbol">→</a> <a id="11899" class="Symbol">(∀{</a><a id="11902" href="/Substitution/#11902" class="Bound">A</a><a id="11903" class="Symbol">}</a> <a id="11905" class="Symbol">→</a> <a id="11907" href="/Substitution/#11859" class="Bound">σ</a> <a id="11909" class="Symbol">{</a><a id="11910" href="/Substitution/#11902" class="Bound">A</a><a id="11911" class="Symbol">}</a> <a id="11913" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11915" href="/Substitution/#11861" class="Bound">σ&#39;</a> <a id="11918" class="Symbol">{</a><a id="11919" href="/Substitution/#11902" class="Bound">A</a><a id="11920" class="Symbol">})</a> <a id="11923" class="Symbol">→</a> <a id="11925" class="Symbol">(∀{</a><a id="11928" href="/Substitution/#11928" class="Bound">A</a><a id="11929" class="Symbol">}</a> <a id="11931" class="Symbol">→</a> <a id="11933" href="/Substitution/#11877" class="Bound">τ</a> <a id="11935" class="Symbol">{</a><a id="11936" href="/Substitution/#11928" class="Bound">A</a><a id="11937" class="Symbol">}</a> <a id="11939" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11941" href="/Substitution/#11879" class="Bound">τ&#39;</a> <a id="11944" class="Symbol">{</a><a id="11945" href="/Substitution/#11928" class="Bound">A</a><a id="11946" class="Symbol">})</a>
  <a id="11951" class="Symbol">→</a> <a id="11953" class="Symbol">∀{</a><a id="11955" href="/Substitution/#11955" class="Bound">A</a><a id="11956" class="Symbol">}</a> <a id="11958" class="Symbol">→</a> <a id="11960" class="Symbol">(</a><a id="11961" href="/Substitution/#11859" class="Bound">σ</a> <a id="11963" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="11965" href="/Substitution/#11877" class="Bound">τ</a><a id="11966" class="Symbol">)</a> <a id="11968" class="Symbol">{</a><a id="11969" href="/Substitution/#11955" class="Bound">A</a><a id="11970" class="Symbol">}</a> <a id="11972" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11974" class="Symbol">(</a><a id="11975" href="/Substitution/#11861" class="Bound">σ&#39;</a> <a id="11978" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="11980" href="/Substitution/#11879" class="Bound">τ&#39;</a><a id="11982" class="Symbol">)</a> <a id="11984" class="Symbol">{</a><a id="11985" href="/Substitution/#11955" class="Bound">A</a><a id="11986" class="Symbol">}</a>
<a id="11988" href="/Substitution/#11839" class="Function">cong-seq</a> <a id="11997" class="Symbol">{</a><a id="11998" href="/Substitution/#11998" class="Bound">Γ</a><a id="11999" class="Symbol">}{</a><a id="12001" href="/Substitution/#12001" class="Bound">Δ</a><a id="12002" class="Symbol">}{</a><a id="12004" href="/Substitution/#12004" class="Bound">Σ</a><a id="12005" class="Symbol">}{</a><a id="12007" href="/Substitution/#12007" class="Bound">σ</a><a id="12008" class="Symbol">}{</a><a id="12010" href="/Substitution/#12010" class="Bound">σ&#39;</a><a id="12012" class="Symbol">}{</a><a id="12014" href="/Substitution/#12014" class="Bound">τ</a><a id="12015" class="Symbol">}{</a><a id="12017" href="/Substitution/#12017" class="Bound">τ&#39;</a><a id="12019" class="Symbol">}</a> <a id="12021" href="/Substitution/#12021" class="Bound">ss&#39;</a> <a id="12025" href="/Substitution/#12025" class="Bound">tt&#39;</a> <a id="12029" class="Symbol">{</a><a id="12030" href="/Substitution/#12030" class="Bound">A</a><a id="12031" class="Symbol">}</a> <a id="12033" class="Symbol">=</a> <a id="12035" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="12050" href="/Substitution/#12066" class="Function">lemma</a>
  <a id="12058" class="Keyword">where</a>
  <a id="12066" href="/Substitution/#12066" class="Function">lemma</a> <a id="12072" class="Symbol">:</a> <a id="12074" class="Symbol">(</a><a id="12075" href="/Substitution/#12075" class="Bound">x</a> <a id="12077" class="Symbol">:</a> <a id="12079" href="/Substitution/#11998" class="Bound">Γ</a> <a id="12081" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12083" href="/Substitution/#12030" class="Bound">A</a><a id="12084" class="Symbol">)</a> <a id="12086" class="Symbol">→</a> <a id="12088" class="Symbol">(</a><a id="12089" href="/Substitution/#12007" class="Bound">σ</a> <a id="12091" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="12093" href="/Substitution/#12014" class="Bound">τ</a><a id="12094" class="Symbol">)</a> <a id="12096" href="/Substitution/#12075" class="Bound">x</a> <a id="12098" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12100" class="Symbol">(</a><a id="12101" href="/Substitution/#12010" class="Bound">σ&#39;</a> <a id="12104" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="12106" href="/Substitution/#12017" class="Bound">τ&#39;</a><a id="12108" class="Symbol">)</a> <a id="12110" href="/Substitution/#12075" class="Bound">x</a>
  <a id="12114" href="/Substitution/#12066" class="Function">lemma</a> <a id="12120" href="/Substitution/#12120" class="Bound">x</a> <a id="12122" class="Symbol">=</a>
     <a id="12129" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="12142" class="Symbol">(</a><a id="12143" href="/Substitution/#12007" class="Bound">σ</a> <a id="12145" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="12147" href="/Substitution/#12014" class="Bound">τ</a><a id="12148" class="Symbol">)</a> <a id="12150" href="/Substitution/#12120" class="Bound">x</a> 
     <a id="12158" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="12169" href="/Untyped/#6931" class="Function">subst</a> <a id="12175" href="/Substitution/#12014" class="Bound">τ</a> <a id="12177" class="Symbol">(</a><a id="12178" href="/Substitution/#12007" class="Bound">σ</a> <a id="12180" href="/Substitution/#12120" class="Bound">x</a><a id="12181" class="Symbol">)</a>
     <a id="12188" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="12191" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="12196" class="Symbol">(</a><a id="12197" href="/Untyped/#6931" class="Function">subst</a> <a id="12203" href="/Substitution/#12014" class="Bound">τ</a><a id="12204" class="Symbol">)</a> <a id="12206" class="Symbol">(</a><a id="12207" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="12216" href="/Substitution/#12021" class="Bound">ss&#39;</a> <a id="12220" href="/Substitution/#12120" class="Bound">x</a><a id="12221" class="Symbol">)</a> <a id="12223" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="12232" href="/Untyped/#6931" class="Function">subst</a> <a id="12238" href="/Substitution/#12014" class="Bound">τ</a> <a id="12240" class="Symbol">(</a><a id="12241" href="/Substitution/#12010" class="Bound">σ&#39;</a> <a id="12244" href="/Substitution/#12120" class="Bound">x</a><a id="12245" class="Symbol">)</a>
     <a id="12252" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="12255" href="/Substitution/#10706" class="Function">cong-sub</a><a id="12263" class="Symbol">{</a><a id="12264" class="Argument">M</a> <a id="12266" class="Symbol">=</a> <a id="12268" href="/Substitution/#12010" class="Bound">σ&#39;</a> <a id="12271" href="/Substitution/#12120" class="Bound">x</a><a id="12272" class="Symbol">}</a> <a id="12274" href="/Substitution/#12025" class="Bound">tt&#39;</a> <a id="12278" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12283" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="12292" href="/Untyped/#6931" class="Function">subst</a> <a id="12298" href="/Substitution/#12017" class="Bound">τ&#39;</a> <a id="12301" class="Symbol">(</a><a id="12302" href="/Substitution/#12010" class="Bound">σ&#39;</a> <a id="12305" href="/Substitution/#12120" class="Bound">x</a><a id="12306" class="Symbol">)</a>
     <a id="12313" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="12324" class="Symbol">(</a><a id="12325" href="/Substitution/#12010" class="Bound">σ&#39;</a> <a id="12328" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="12330" href="/Substitution/#12017" class="Bound">τ&#39;</a><a id="12332" class="Symbol">)</a> <a id="12334" href="/Substitution/#12120" class="Bound">x</a>  
     <a id="12343" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="relating-rename-exts-ext-and-subst-zero-to-the-σ-algebra">Relating <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code> to the σ algebra</h2>

<p>In this section we establish equations that relate <code class="highlighter-rouge">subst</code> and its
helper functions (<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>) to terms
in the σ algebra.</p>

<p>The first equation we prove is</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⧼ ren ρ ⧽ M              (rename-subst-ren)
</code></pre></div></div>

<p>Because <code class="highlighter-rouge">subst</code> uses the <code class="highlighter-rouge">exts</code> function, we need the following lemma
which says that <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">ext</code> do the same thing except that <code class="highlighter-rouge">ext</code>
works on renamings and <code class="highlighter-rouge">exts</code> works on substitutions.</p>

<pre class="Agda"><a id="ren-ext"></a><a id="12902" href="/Substitution/#12902" class="Function">ren-ext</a> <a id="12910" class="Symbol">:</a> <a id="12912" class="Symbol">∀</a> <a id="12914" class="Symbol">{</a><a id="12915" href="/Substitution/#12915" class="Bound">Γ</a> <a id="12917" href="/Substitution/#12917" class="Bound">Δ</a><a id="12918" class="Symbol">}{</a><a id="12920" href="/Substitution/#12920" class="Bound">B</a> <a id="12922" href="/Substitution/#12922" class="Bound">C</a> <a id="12924" class="Symbol">:</a> <a id="12926" href="/Untyped/#2675" class="Datatype">Type</a><a id="12930" class="Symbol">}</a> <a id="12932" class="Symbol">{</a><a id="12933" href="/Substitution/#12933" class="Bound">ρ</a> <a id="12935" class="Symbol">:</a> <a id="12937" href="/Denotational/#23286" class="Function">Rename</a> <a id="12944" href="/Substitution/#12915" class="Bound">Γ</a> <a id="12946" href="/Substitution/#12917" class="Bound">Δ</a><a id="12947" class="Symbol">}</a>
        <a id="12957" class="Symbol">→</a> <a id="12959" href="/Substitution/#6112" class="Function">ren</a> <a id="12963" class="Symbol">(</a><a id="12964" href="/Untyped/#5845" class="Function">ext</a> <a id="12968" href="/Substitution/#12933" class="Bound">ρ</a> <a id="12970" class="Symbol">{</a><a id="12971" class="Argument">B</a> <a id="12973" class="Symbol">=</a> <a id="12975" href="/Substitution/#12920" class="Bound">B</a><a id="12976" class="Symbol">})</a> <a id="12979" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12981" href="/Untyped/#6623" class="Function">exts</a> <a id="12986" class="Symbol">(</a><a id="12987" href="/Substitution/#6112" class="Function">ren</a> <a id="12991" href="/Substitution/#12933" class="Bound">ρ</a><a id="12992" class="Symbol">)</a> <a id="12994" class="Symbol">{</a><a id="12995" href="/Substitution/#12922" class="Bound">C</a><a id="12996" class="Symbol">}</a>
<a id="12998" href="/Substitution/#12902" class="Function">ren-ext</a> <a id="13006" class="Symbol">{</a><a id="13007" href="/Substitution/#13007" class="Bound">Γ</a><a id="13008" class="Symbol">}{</a><a id="13010" href="/Substitution/#13010" class="Bound">Δ</a><a id="13011" class="Symbol">}{</a><a id="13013" href="/Substitution/#13013" class="Bound">B</a><a id="13014" class="Symbol">}{</a><a id="13016" href="/Substitution/#13016" class="Bound">C</a><a id="13017" class="Symbol">}{</a><a id="13019" href="/Substitution/#13019" class="Bound">ρ</a><a id="13020" class="Symbol">}</a> <a id="13022" class="Symbol">=</a> <a id="13024" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="13039" class="Symbol">λ</a> <a id="13041" href="/Substitution/#13041" class="Bound">x</a> <a id="13043" class="Symbol">→</a> <a id="13045" href="/Substitution/#13069" class="Function">lemma</a> <a id="13051" class="Symbol">{</a><a id="13052" class="Argument">x</a> <a id="13054" class="Symbol">=</a> <a id="13056" href="/Substitution/#13041" class="Bound">x</a><a id="13057" class="Symbol">}</a>
  <a id="13061" class="Keyword">where</a>
  <a id="13069" href="/Substitution/#13069" class="Function">lemma</a> <a id="13075" class="Symbol">:</a> <a id="13077" class="Symbol">∀</a> <a id="13079" class="Symbol">{</a><a id="13080" href="/Substitution/#13080" class="Bound">x</a> <a id="13082" class="Symbol">:</a> <a id="13084" href="/Substitution/#13007" class="Bound">Γ</a> <a id="13086" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="13088" href="/Substitution/#13013" class="Bound">B</a> <a id="13090" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="13092" href="/Substitution/#13016" class="Bound">C</a><a id="13093" class="Symbol">}</a> <a id="13095" class="Symbol">→</a> <a id="13097" class="Symbol">(</a><a id="13098" href="/Substitution/#6112" class="Function">ren</a> <a id="13102" class="Symbol">(</a><a id="13103" href="/Untyped/#5845" class="Function">ext</a> <a id="13107" href="/Substitution/#13019" class="Bound">ρ</a><a id="13108" class="Symbol">))</a> <a id="13111" href="/Substitution/#13080" class="Bound">x</a> <a id="13113" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13115" href="/Untyped/#6623" class="Function">exts</a> <a id="13120" class="Symbol">(</a><a id="13121" href="/Substitution/#6112" class="Function">ren</a> <a id="13125" href="/Substitution/#13019" class="Bound">ρ</a><a id="13126" class="Symbol">)</a> <a id="13128" href="/Substitution/#13080" class="Bound">x</a>
  <a id="13132" href="/Substitution/#13069" class="Function">lemma</a> <a id="13138" class="Symbol">{</a><a id="13139" class="Argument">x</a> <a id="13141" class="Symbol">=</a> <a id="13143" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="13144" class="Symbol">}</a> <a id="13146" class="Symbol">=</a> <a id="13148" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="13155" href="/Substitution/#13069" class="Function">lemma</a> <a id="13161" class="Symbol">{</a><a id="13162" class="Argument">x</a> <a id="13164" class="Symbol">=</a> <a id="13166" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="13168" href="/Substitution/#13168" class="Bound">x</a><a id="13169" class="Symbol">}</a> <a id="13171" class="Symbol">=</a> <a id="13173" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>With this lemma in hand, the proof is a straightforward induction on
the term <code class="highlighter-rouge">M</code>.</p>

<pre class="Agda"><a id="rename-subst-ren"></a><a id="13287" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13304" class="Symbol">:</a> <a id="13306" class="Symbol">∀</a> <a id="13308" class="Symbol">{</a><a id="13309" href="/Substitution/#13309" class="Bound">Γ</a> <a id="13311" href="/Substitution/#13311" class="Bound">Δ</a><a id="13312" class="Symbol">}{</a><a id="13314" href="/Substitution/#13314" class="Bound">A</a><a id="13315" class="Symbol">}</a> <a id="13317" class="Symbol">{</a><a id="13318" href="/Substitution/#13318" class="Bound">ρ</a> <a id="13320" class="Symbol">:</a> <a id="13322" href="/Denotational/#23286" class="Function">Rename</a> <a id="13329" href="/Substitution/#13309" class="Bound">Γ</a> <a id="13331" href="/Substitution/#13311" class="Bound">Δ</a><a id="13332" class="Symbol">}{</a><a id="13334" href="/Substitution/#13334" class="Bound">M</a> <a id="13336" class="Symbol">:</a> <a id="13338" href="/Substitution/#13309" class="Bound">Γ</a> <a id="13340" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="13342" href="/Substitution/#13314" class="Bound">A</a><a id="13343" class="Symbol">}</a>
                 <a id="13362" class="Symbol">→</a> <a id="13364" href="/Untyped/#6171" class="Function">rename</a> <a id="13371" href="/Substitution/#13318" class="Bound">ρ</a> <a id="13373" href="/Substitution/#13334" class="Bound">M</a> <a id="13375" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13377" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="13379" href="/Substitution/#6112" class="Function">ren</a> <a id="13383" href="/Substitution/#13318" class="Bound">ρ</a> <a id="13385" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="13387" href="/Substitution/#13334" class="Bound">M</a>
<a id="13389" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13406" class="Symbol">{</a><a id="13407" class="Argument">M</a> <a id="13409" class="Symbol">=</a> <a id="13411" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="13413" href="/Substitution/#13413" class="Bound">x</a><a id="13414" class="Symbol">}</a> <a id="13416" class="Symbol">=</a> <a id="13418" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="13423" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13440" class="Symbol">{</a><a id="13441" class="Argument">ρ</a> <a id="13443" class="Symbol">=</a> <a id="13445" href="/Substitution/#13445" class="Bound">ρ</a><a id="13446" class="Symbol">}{</a><a id="13448" class="Argument">M</a> <a id="13450" class="Symbol">=</a> <a id="13452" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13454" href="/Substitution/#13454" class="Bound">N</a><a id="13455" class="Symbol">}</a> <a id="13457" class="Symbol">=</a>
  <a id="13461" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="13473" href="/Untyped/#6171" class="Function">rename</a> <a id="13480" href="/Substitution/#13445" class="Bound">ρ</a> <a id="13482" class="Symbol">(</a><a id="13483" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13485" href="/Substitution/#13454" class="Bound">N</a><a id="13486" class="Symbol">)</a>
    <a id="13492" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="13502" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13504" href="/Untyped/#6171" class="Function">rename</a> <a id="13511" class="Symbol">(</a><a id="13512" href="/Untyped/#5845" class="Function">ext</a> <a id="13516" href="/Substitution/#13445" class="Bound">ρ</a><a id="13517" class="Symbol">)</a> <a id="13519" href="/Substitution/#13454" class="Bound">N</a>
    <a id="13525" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13528" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13533" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="13536" class="Symbol">(</a><a id="13537" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13554" class="Symbol">{</a><a id="13555" class="Argument">ρ</a> <a id="13557" class="Symbol">=</a> <a id="13559" href="/Untyped/#5845" class="Function">ext</a> <a id="13563" href="/Substitution/#13445" class="Bound">ρ</a><a id="13564" class="Symbol">}{</a><a id="13566" class="Argument">M</a> <a id="13568" class="Symbol">=</a> <a id="13570" href="/Substitution/#13454" class="Bound">N</a><a id="13571" class="Symbol">})</a> <a id="13574" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="13582" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13584" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="13586" href="/Substitution/#6112" class="Function">ren</a> <a id="13590" class="Symbol">(</a><a id="13591" href="/Untyped/#5845" class="Function">ext</a> <a id="13595" href="/Substitution/#13445" class="Bound">ρ</a><a id="13596" class="Symbol">)</a> <a id="13598" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="13600" href="/Substitution/#13454" class="Bound">N</a>
    <a id="13606" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13609" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13614" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="13617" class="Symbol">(</a><a id="13618" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="13627" class="Symbol">{</a><a id="13628" class="Argument">M</a> <a id="13630" class="Symbol">=</a> <a id="13632" href="/Substitution/#13454" class="Bound">N</a><a id="13633" class="Symbol">}</a> <a id="13635" href="/Substitution/#12902" class="Function">ren-ext</a> <a id="13643" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="13647" class="Symbol">)</a> <a id="13649" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="13657" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13659" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="13661" href="/Untyped/#6623" class="Function">exts</a> <a id="13666" class="Symbol">(</a><a id="13667" href="/Substitution/#6112" class="Function">ren</a> <a id="13671" href="/Substitution/#13445" class="Bound">ρ</a><a id="13672" class="Symbol">)</a> <a id="13674" href="/Substitution/#2074" class="Function Operator">⧽</a>  <a id="13677" href="/Substitution/#13454" class="Bound">N</a>
    <a id="13683" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="13693" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="13695" href="/Substitution/#6112" class="Function">ren</a> <a id="13699" href="/Substitution/#13445" class="Bound">ρ</a> <a id="13701" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="13703" class="Symbol">(</a><a id="13704" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="13706" href="/Substitution/#13454" class="Bound">N</a><a id="13707" class="Symbol">)</a>
  <a id="13711" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="13713" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13730" class="Symbol">{</a><a id="13731" class="Argument">M</a> <a id="13733" class="Symbol">=</a> <a id="13735" href="/Substitution/#13735" class="Bound">L</a> <a id="13737" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="13739" href="/Substitution/#13739" class="Bound">M</a><a id="13740" class="Symbol">}</a> <a id="13742" class="Symbol">=</a> <a id="13744" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="13750" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="13754" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="13771" href="/Substitution/#13287" class="Function">rename-subst-ren</a></pre>

<p>The substitution <code class="highlighter-rouge">ren S_</code> is equivalent to <code class="highlighter-rouge">↑</code>.</p>

<pre class="Agda"><a id="ren-shift"></a><a id="13862" href="/Substitution/#13862" class="Function">ren-shift</a> <a id="13872" class="Symbol">:</a> <a id="13874" class="Symbol">∀{</a><a id="13876" href="/Substitution/#13876" class="Bound">Γ</a><a id="13877" class="Symbol">}{</a><a id="13879" href="/Substitution/#13879" class="Bound">A</a><a id="13880" class="Symbol">}{</a><a id="13882" href="/Substitution/#13882" class="Bound">B</a><a id="13883" class="Symbol">}</a>
          <a id="13895" class="Symbol">→</a> <a id="13897" href="/Substitution/#6112" class="Function">ren</a> <a id="13901" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="13904" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13906" href="/Substitution/#2744" class="Function">↑</a> <a id="13908" class="Symbol">{</a><a id="13909" class="Argument">A</a> <a id="13911" class="Symbol">=</a> <a id="13913" href="/Substitution/#13882" class="Bound">B</a><a id="13914" class="Symbol">}</a> <a id="13916" class="Symbol">{</a><a id="13917" href="/Substitution/#13879" class="Bound">A</a><a id="13918" class="Symbol">}</a>
<a id="13920" href="/Substitution/#13862" class="Function">ren-shift</a> <a id="13930" class="Symbol">{</a><a id="13931" href="/Substitution/#13931" class="Bound">Γ</a><a id="13932" class="Symbol">}{</a><a id="13934" href="/Substitution/#13934" class="Bound">A</a><a id="13935" class="Symbol">}{</a><a id="13937" href="/Substitution/#13937" class="Bound">B</a><a id="13938" class="Symbol">}</a> <a id="13940" class="Symbol">=</a> <a id="13942" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="13957" class="Symbol">λ</a> <a id="13959" href="/Substitution/#13959" class="Bound">x</a> <a id="13961" class="Symbol">→</a> <a id="13963" href="/Substitution/#13987" class="Function">lemma</a> <a id="13969" class="Symbol">{</a><a id="13970" class="Argument">x</a> <a id="13972" class="Symbol">=</a> <a id="13974" href="/Substitution/#13959" class="Bound">x</a><a id="13975" class="Symbol">}</a>
  <a id="13979" class="Keyword">where</a>
  <a id="13987" href="/Substitution/#13987" class="Function">lemma</a> <a id="13993" class="Symbol">:</a> <a id="13995" class="Symbol">∀</a> <a id="13997" class="Symbol">{</a><a id="13998" href="/Substitution/#13998" class="Bound">x</a> <a id="14000" class="Symbol">:</a> <a id="14002" href="/Substitution/#13931" class="Bound">Γ</a> <a id="14004" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="14006" href="/Substitution/#13934" class="Bound">A</a><a id="14007" class="Symbol">}</a> <a id="14009" class="Symbol">→</a> <a id="14011" href="/Substitution/#6112" class="Function">ren</a> <a id="14015" class="Symbol">(</a><a id="14016" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14018" class="Symbol">{</a><a id="14019" class="Argument">B</a> <a id="14021" class="Symbol">=</a> <a id="14023" href="/Substitution/#13937" class="Bound">B</a><a id="14024" class="Symbol">})</a> <a id="14027" href="/Substitution/#13998" class="Bound">x</a> <a id="14029" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14031" href="/Substitution/#2744" class="Function">↑</a> <a id="14033" class="Symbol">{</a><a id="14034" class="Argument">A</a> <a id="14036" class="Symbol">=</a> <a id="14038" href="/Substitution/#13937" class="Bound">B</a><a id="14039" class="Symbol">}</a> <a id="14041" href="/Substitution/#13998" class="Bound">x</a>
  <a id="14045" href="/Substitution/#13987" class="Function">lemma</a> <a id="14051" class="Symbol">{</a><a id="14052" class="Argument">x</a> <a id="14054" class="Symbol">=</a> <a id="14056" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14057" class="Symbol">}</a> <a id="14059" class="Symbol">=</a> <a id="14061" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14068" href="/Substitution/#13987" class="Function">lemma</a> <a id="14074" class="Symbol">{</a><a id="14075" class="Argument">x</a> <a id="14077" class="Symbol">=</a> <a id="14079" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14081" href="/Substitution/#14081" class="Bound">x</a><a id="14082" class="Symbol">}</a> <a id="14084" class="Symbol">=</a> <a id="14086" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The substitution <code class="highlighter-rouge">rename S_ M</code> is equivalent to shifting: <code class="highlighter-rouge">⧼ ↑ ⧽ M</code>.</p>

<pre class="Agda"><a id="rename-shift"></a><a id="14186" href="/Substitution/#14186" class="Function">rename-shift</a> <a id="14199" class="Symbol">:</a> <a id="14201" class="Symbol">∀{</a><a id="14203" href="/Substitution/#14203" class="Bound">Γ</a><a id="14204" class="Symbol">}</a> <a id="14206" class="Symbol">{</a><a id="14207" href="/Substitution/#14207" class="Bound">A</a><a id="14208" class="Symbol">}</a> <a id="14210" class="Symbol">{</a><a id="14211" href="/Substitution/#14211" class="Bound">B</a><a id="14212" class="Symbol">}</a> <a id="14214" class="Symbol">{</a><a id="14215" href="/Substitution/#14215" class="Bound">M</a> <a id="14217" class="Symbol">:</a> <a id="14219" href="/Substitution/#14203" class="Bound">Γ</a> <a id="14221" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="14223" href="/Substitution/#14207" class="Bound">A</a><a id="14224" class="Symbol">}</a>
             <a id="14239" class="Symbol">→</a> <a id="14241" href="/Untyped/#6171" class="Function">rename</a> <a id="14248" class="Symbol">(</a><a id="14249" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14251" class="Symbol">{</a><a id="14252" class="Argument">B</a> <a id="14254" class="Symbol">=</a> <a id="14256" href="/Substitution/#14211" class="Bound">B</a><a id="14257" class="Symbol">})</a> <a id="14260" href="/Substitution/#14215" class="Bound">M</a> <a id="14262" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14264" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="14266" href="/Substitution/#2744" class="Function">↑</a> <a id="14268" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="14270" href="/Substitution/#14215" class="Bound">M</a>
<a id="14272" href="/Substitution/#14186" class="Function">rename-shift</a><a id="14284" class="Symbol">{</a><a id="14285" href="/Substitution/#14285" class="Bound">Γ</a><a id="14286" class="Symbol">}{</a><a id="14288" href="/Substitution/#14288" class="Bound">A</a><a id="14289" class="Symbol">}{</a><a id="14291" href="/Substitution/#14291" class="Bound">B</a><a id="14292" class="Symbol">}{</a><a id="14294" href="/Substitution/#14294" class="Bound">M</a><a id="14295" class="Symbol">}</a> <a id="14297" class="Symbol">=</a>
  <a id="14301" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="14311" href="/Untyped/#6171" class="Function">rename</a> <a id="14318" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14321" href="/Substitution/#14294" class="Bound">M</a>
  <a id="14325" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14328" href="/Substitution/#13287" class="Function">rename-subst-ren</a> <a id="14345" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="14351" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="14353" href="/Substitution/#6112" class="Function">ren</a> <a id="14357" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14360" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="14362" href="/Substitution/#14294" class="Bound">M</a>
  <a id="14366" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14369" href="/Substitution/#10706" class="Function">cong-sub</a><a id="14377" class="Symbol">{</a><a id="14378" class="Argument">M</a> <a id="14380" class="Symbol">=</a> <a id="14382" href="/Substitution/#14294" class="Bound">M</a><a id="14383" class="Symbol">}</a> <a id="14385" href="/Substitution/#13862" class="Function">ren-shift</a> <a id="14395" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="14400" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="14406" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="14408" href="/Substitution/#2744" class="Function">↑</a> <a id="14410" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="14412" href="/Substitution/#14294" class="Bound">M</a>
  <a id="14416" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Next we prove the equation <code class="highlighter-rouge">exts-cons-shift</code>, which states that <code class="highlighter-rouge">exts</code>
is equivalent to cons’ing Z onto the sequence formed by applying <code class="highlighter-rouge">σ</code>
and then shifting. The proof is by case analysis on the variable <code class="highlighter-rouge">x</code>,
using <code class="highlighter-rouge">rename-subst-ren</code> for when <code class="highlighter-rouge">x = S y</code>.</p>

<pre class="Agda"><a id="exts-cons-shift"></a><a id="14699" href="/Substitution/#14699" class="Function">exts-cons-shift</a> <a id="14715" class="Symbol">:</a> <a id="14717" class="Symbol">∀{</a><a id="14719" href="/Substitution/#14719" class="Bound">Γ</a> <a id="14721" href="/Substitution/#14721" class="Bound">Δ</a><a id="14722" class="Symbol">}</a> <a id="14724" class="Symbol">{</a><a id="14725" href="/Substitution/#14725" class="Bound">A</a> <a id="14727" href="/Substitution/#14727" class="Bound">B</a><a id="14728" class="Symbol">}</a> <a id="14730" class="Symbol">{</a><a id="14731" href="/Substitution/#14731" class="Bound">σ</a> <a id="14733" class="Symbol">:</a> <a id="14735" href="/Soundness/#2673" class="Function">Subst</a> <a id="14741" href="/Substitution/#14719" class="Bound">Γ</a> <a id="14743" href="/Substitution/#14721" class="Bound">Δ</a><a id="14744" class="Symbol">}</a>
                <a id="14762" class="Symbol">→</a> <a id="14764" href="/Untyped/#6623" class="Function">exts</a> <a id="14769" href="/Substitution/#14731" class="Bound">σ</a> <a id="14771" class="Symbol">{</a><a id="14772" href="/Substitution/#14725" class="Bound">A</a><a id="14773" class="Symbol">}</a> <a id="14775" class="Symbol">{</a><a id="14776" href="/Substitution/#14727" class="Bound">B</a><a id="14777" class="Symbol">}</a> <a id="14779" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14781" class="Symbol">(</a><a id="14782" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="14784" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="14786" href="/Substitution/#3002" class="Function Operator">•</a> <a id="14788" class="Symbol">(</a><a id="14789" href="/Substitution/#14731" class="Bound">σ</a> <a id="14791" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="14793" href="/Substitution/#2744" class="Function">↑</a><a id="14794" class="Symbol">))</a>
<a id="14797" href="/Substitution/#14699" class="Function">exts-cons-shift</a> <a id="14813" class="Symbol">=</a> <a id="14815" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="14830" class="Symbol">λ</a> <a id="14832" href="/Substitution/#14832" class="Bound">x</a> <a id="14834" class="Symbol">→</a> <a id="14836" href="/Substitution/#14859" class="Function">lemma</a><a id="14841" class="Symbol">{</a><a id="14842" class="Argument">x</a> <a id="14844" class="Symbol">=</a> <a id="14846" href="/Substitution/#14832" class="Bound">x</a><a id="14847" class="Symbol">}</a>
  <a id="14851" class="Keyword">where</a>
  <a id="14859" href="/Substitution/#14859" class="Function">lemma</a> <a id="14865" class="Symbol">:</a> <a id="14867" class="Symbol">∀{</a><a id="14869" href="/Substitution/#14869" class="Bound">Γ</a> <a id="14871" href="/Substitution/#14871" class="Bound">Δ</a><a id="14872" class="Symbol">}</a> <a id="14874" class="Symbol">{</a><a id="14875" href="/Substitution/#14875" class="Bound">A</a> <a id="14877" href="/Substitution/#14877" class="Bound">B</a><a id="14878" class="Symbol">}</a> <a id="14880" class="Symbol">{</a><a id="14881" href="/Substitution/#14881" class="Bound">σ</a> <a id="14883" class="Symbol">:</a> <a id="14885" href="/Soundness/#2673" class="Function">Subst</a> <a id="14891" href="/Substitution/#14869" class="Bound">Γ</a> <a id="14893" href="/Substitution/#14871" class="Bound">Δ</a><a id="14894" class="Symbol">}</a> <a id="14896" class="Symbol">{</a><a id="14897" href="/Substitution/#14897" class="Bound">x</a> <a id="14899" class="Symbol">:</a> <a id="14901" href="/Substitution/#14869" class="Bound">Γ</a> <a id="14903" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="14905" href="/Substitution/#14877" class="Bound">B</a> <a id="14907" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="14909" href="/Substitution/#14875" class="Bound">A</a><a id="14910" class="Symbol">}</a>
                  <a id="14930" class="Symbol">→</a> <a id="14932" href="/Untyped/#6623" class="Function">exts</a> <a id="14937" href="/Substitution/#14881" class="Bound">σ</a> <a id="14939" href="/Substitution/#14897" class="Bound">x</a> <a id="14941" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14943" class="Symbol">(</a><a id="14944" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="14946" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="14948" href="/Substitution/#3002" class="Function Operator">•</a> <a id="14950" class="Symbol">(</a><a id="14951" href="/Substitution/#14881" class="Bound">σ</a> <a id="14953" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="14955" href="/Substitution/#2744" class="Function">↑</a><a id="14956" class="Symbol">))</a> <a id="14959" href="/Substitution/#14897" class="Bound">x</a>
  <a id="14963" href="/Substitution/#14859" class="Function">lemma</a> <a id="14969" class="Symbol">{</a><a id="14970" class="Argument">x</a> <a id="14972" class="Symbol">=</a> <a id="14974" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14975" class="Symbol">}</a> <a id="14977" class="Symbol">=</a> <a id="14979" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14986" href="/Substitution/#14859" class="Function">lemma</a> <a id="14992" class="Symbol">{</a><a id="14993" class="Argument">x</a> <a id="14995" class="Symbol">=</a> <a id="14997" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14999" href="/Substitution/#14999" class="Bound">y</a><a id="15000" class="Symbol">}</a> <a id="15002" class="Symbol">=</a> <a id="15004" href="/Substitution/#13287" class="Function">rename-subst-ren</a></pre>

<p>As a corollary, we have a similar correspondence for <code class="highlighter-rouge">ren (ext ρ)</code>.</p>

<pre class="Agda"><a id="ext-cons-Z-shift"></a><a id="15115" href="/Substitution/#15115" class="Function">ext-cons-Z-shift</a> <a id="15132" class="Symbol">:</a> <a id="15134" class="Symbol">∀{</a><a id="15136" href="/Substitution/#15136" class="Bound">Γ</a> <a id="15138" href="/Substitution/#15138" class="Bound">Δ</a><a id="15139" class="Symbol">}</a> <a id="15141" class="Symbol">{</a><a id="15142" href="/Substitution/#15142" class="Bound">ρ</a> <a id="15144" class="Symbol">:</a> <a id="15146" href="/Denotational/#23286" class="Function">Rename</a> <a id="15153" href="/Substitution/#15136" class="Bound">Γ</a> <a id="15155" href="/Substitution/#15138" class="Bound">Δ</a><a id="15156" class="Symbol">}{</a><a id="15158" href="/Substitution/#15158" class="Bound">A</a><a id="15159" class="Symbol">}{</a><a id="15161" href="/Substitution/#15161" class="Bound">B</a><a id="15162" class="Symbol">}</a> 
                 <a id="15182" class="Symbol">→</a> <a id="15184" href="/Substitution/#6112" class="Function">ren</a> <a id="15188" class="Symbol">(</a><a id="15189" href="/Untyped/#5845" class="Function">ext</a> <a id="15193" href="/Substitution/#15142" class="Bound">ρ</a> <a id="15195" class="Symbol">{</a><a id="15196" class="Argument">B</a> <a id="15198" class="Symbol">=</a> <a id="15200" href="/Substitution/#15161" class="Bound">B</a><a id="15201" class="Symbol">})</a> <a id="15204" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15206" class="Symbol">(</a><a id="15207" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15209" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15211" href="/Substitution/#3002" class="Function Operator">•</a> <a id="15213" class="Symbol">(</a><a id="15214" href="/Substitution/#6112" class="Function">ren</a> <a id="15218" href="/Substitution/#15142" class="Bound">ρ</a> <a id="15220" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="15222" href="/Substitution/#2744" class="Function">↑</a><a id="15223" class="Symbol">))</a> <a id="15226" class="Symbol">{</a><a id="15227" href="/Substitution/#15158" class="Bound">A</a><a id="15228" class="Symbol">}</a>
<a id="15230" href="/Substitution/#15115" class="Function">ext-cons-Z-shift</a> <a id="15247" class="Symbol">{</a><a id="15248" href="/Substitution/#15248" class="Bound">Γ</a><a id="15249" class="Symbol">}{</a><a id="15251" href="/Substitution/#15251" class="Bound">Δ</a><a id="15252" class="Symbol">}{</a><a id="15254" href="/Substitution/#15254" class="Bound">ρ</a><a id="15255" class="Symbol">}{</a><a id="15257" href="/Substitution/#15257" class="Bound">A</a><a id="15258" class="Symbol">}{</a><a id="15260" href="/Substitution/#15260" class="Bound">B</a><a id="15261" class="Symbol">}</a> <a id="15263" class="Symbol">=</a>
  <a id="15267" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="15277" href="/Substitution/#6112" class="Function">ren</a> <a id="15281" class="Symbol">(</a><a id="15282" href="/Untyped/#5845" class="Function">ext</a> <a id="15286" href="/Substitution/#15254" class="Bound">ρ</a><a id="15287" class="Symbol">)</a>
  <a id="15291" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15294" href="/Substitution/#12902" class="Function">ren-ext</a> <a id="15302" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15308" href="/Untyped/#6623" class="Function">exts</a> <a id="15313" class="Symbol">(</a><a id="15314" href="/Substitution/#6112" class="Function">ren</a> <a id="15318" href="/Substitution/#15254" class="Bound">ρ</a><a id="15319" class="Symbol">)</a>
  <a id="15323" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15326" href="/Substitution/#14699" class="Function">exts-cons-shift</a><a id="15341" class="Symbol">{</a><a id="15342" class="Argument">σ</a> <a id="15344" class="Symbol">=</a> <a id="15346" href="/Substitution/#6112" class="Function">ren</a> <a id="15350" href="/Substitution/#15254" class="Bound">ρ</a><a id="15351" class="Symbol">}</a> <a id="15353" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
   <a id="15358" class="Symbol">((</a><a id="15360" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15362" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15363" class="Symbol">)</a> <a id="15365" href="/Substitution/#3002" class="Function Operator">•</a> <a id="15367" class="Symbol">(</a><a id="15368" href="/Substitution/#6112" class="Function">ren</a> <a id="15372" href="/Substitution/#15254" class="Bound">ρ</a> <a id="15374" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="15376" href="/Substitution/#2744" class="Function">↑</a><a id="15377" class="Symbol">))</a>
  <a id="15382" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Finally, the <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing <code class="highlighter-rouge">M</code>
onto the identity substitution.</p>

<pre class="Agda"><a id="subst-Z-cons-ids"></a><a id="15513" href="/Substitution/#15513" class="Function">subst-Z-cons-ids</a> <a id="15530" class="Symbol">:</a> <a id="15532" class="Symbol">∀{</a><a id="15534" href="/Substitution/#15534" class="Bound">Γ</a><a id="15535" class="Symbol">}{</a><a id="15537" href="/Substitution/#15537" class="Bound">A</a> <a id="15539" href="/Substitution/#15539" class="Bound">B</a> <a id="15541" class="Symbol">:</a> <a id="15543" href="/Untyped/#2675" class="Datatype">Type</a><a id="15547" class="Symbol">}{</a><a id="15549" href="/Substitution/#15549" class="Bound">M</a> <a id="15551" class="Symbol">:</a> <a id="15553" href="/Substitution/#15534" class="Bound">Γ</a> <a id="15555" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15557" href="/Substitution/#15539" class="Bound">B</a><a id="15558" class="Symbol">}</a>
                 <a id="15577" class="Symbol">→</a> <a id="15579" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="15590" href="/Substitution/#15549" class="Bound">M</a> <a id="15592" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15594" class="Symbol">(</a><a id="15595" href="/Substitution/#15549" class="Bound">M</a> <a id="15597" href="/Substitution/#3002" class="Function Operator">•</a> <a id="15599" href="/Substitution/#2589" class="Function">ids</a><a id="15602" class="Symbol">)</a> <a id="15604" class="Symbol">{</a><a id="15605" href="/Substitution/#15537" class="Bound">A</a><a id="15606" class="Symbol">}</a>
<a id="15608" href="/Substitution/#15513" class="Function">subst-Z-cons-ids</a> <a id="15625" class="Symbol">=</a> <a id="15627" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="15642" class="Symbol">λ</a> <a id="15644" href="/Substitution/#15644" class="Bound">x</a> <a id="15646" class="Symbol">→</a> <a id="15648" href="/Substitution/#15672" class="Function">lemma</a> <a id="15654" class="Symbol">{</a><a id="15655" class="Argument">x</a> <a id="15657" class="Symbol">=</a> <a id="15659" href="/Substitution/#15644" class="Bound">x</a><a id="15660" class="Symbol">}</a>
  <a id="15664" class="Keyword">where</a>
  <a id="15672" href="/Substitution/#15672" class="Function">lemma</a> <a id="15678" class="Symbol">:</a> <a id="15680" class="Symbol">∀{</a><a id="15682" href="/Substitution/#15682" class="Bound">Γ</a><a id="15683" class="Symbol">}{</a><a id="15685" href="/Substitution/#15685" class="Bound">A</a> <a id="15687" href="/Substitution/#15687" class="Bound">B</a> <a id="15689" class="Symbol">:</a> <a id="15691" href="/Untyped/#2675" class="Datatype">Type</a><a id="15695" class="Symbol">}{</a><a id="15697" href="/Substitution/#15697" class="Bound">M</a> <a id="15699" class="Symbol">:</a> <a id="15701" href="/Substitution/#15682" class="Bound">Γ</a> <a id="15703" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15705" href="/Substitution/#15687" class="Bound">B</a><a id="15706" class="Symbol">}{</a><a id="15708" href="/Substitution/#15708" class="Bound">x</a> <a id="15710" class="Symbol">:</a> <a id="15712" href="/Substitution/#15682" class="Bound">Γ</a> <a id="15714" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="15716" href="/Substitution/#15687" class="Bound">B</a> <a id="15718" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="15720" href="/Substitution/#15685" class="Bound">A</a><a id="15721" class="Symbol">}</a>
                      <a id="15745" class="Symbol">→</a> <a id="15747" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="15758" href="/Substitution/#15697" class="Bound">M</a> <a id="15760" href="/Substitution/#15708" class="Bound">x</a> <a id="15762" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15764" class="Symbol">(</a><a id="15765" href="/Substitution/#15697" class="Bound">M</a> <a id="15767" href="/Substitution/#3002" class="Function Operator">•</a> <a id="15769" href="/Substitution/#2589" class="Function">ids</a><a id="15772" class="Symbol">)</a> <a id="15774" href="/Substitution/#15708" class="Bound">x</a>
  <a id="15778" href="/Substitution/#15672" class="Function">lemma</a> <a id="15784" class="Symbol">{</a><a id="15785" class="Argument">x</a> <a id="15787" class="Symbol">=</a> <a id="15789" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15790" class="Symbol">}</a> <a id="15792" class="Symbol">=</a> <a id="15794" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="15801" href="/Substitution/#15672" class="Function">lemma</a> <a id="15807" class="Symbol">{</a><a id="15808" class="Argument">x</a> <a id="15810" class="Symbol">=</a> <a id="15812" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="15814" href="/Substitution/#15814" class="Bound">x</a><a id="15815" class="Symbol">}</a> <a id="15817" class="Symbol">=</a> <a id="15819" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="proofs-of-sub-abs-and-sub-id">Proofs of sub-abs and sub-id</h2>

<p>The equation <code class="highlighter-rouge">sub-abs</code> follows immediately from the equation
<code class="highlighter-rouge">exts-cons-shift</code>.</p>

<pre class="Agda"><a id="sub-abs"></a><a id="15964" href="/Substitution/#15964" class="Function">sub-abs</a> <a id="15972" class="Symbol">:</a> <a id="15974" class="Symbol">∀{</a><a id="15976" href="/Substitution/#15976" class="Bound">Γ</a> <a id="15978" href="/Substitution/#15978" class="Bound">Δ</a><a id="15979" class="Symbol">}</a> <a id="15981" class="Symbol">{</a><a id="15982" href="/Substitution/#15982" class="Bound">σ</a> <a id="15984" class="Symbol">:</a> <a id="15986" href="/Soundness/#2673" class="Function">Subst</a> <a id="15992" href="/Substitution/#15976" class="Bound">Γ</a> <a id="15994" href="/Substitution/#15978" class="Bound">Δ</a><a id="15995" class="Symbol">}</a> <a id="15997" class="Symbol">{</a><a id="15998" href="/Substitution/#15998" class="Bound">N</a> <a id="16000" class="Symbol">:</a> <a id="16002" href="/Substitution/#15976" class="Bound">Γ</a> <a id="16004" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16006" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="16008" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16010" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="16011" class="Symbol">}</a>
        <a id="16021" class="Symbol">→</a> <a id="16023" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16025" href="/Substitution/#15982" class="Bound">σ</a> <a id="16027" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16029" class="Symbol">(</a><a id="16030" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16032" href="/Substitution/#15998" class="Bound">N</a><a id="16033" class="Symbol">)</a> <a id="16035" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16037" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16039" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16041" class="Symbol">(</a><a id="16042" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16044" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16045" class="Symbol">)</a> <a id="16047" href="/Substitution/#3002" class="Function Operator">•</a> <a id="16049" class="Symbol">(</a><a id="16050" href="/Substitution/#15982" class="Bound">σ</a> <a id="16052" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="16054" href="/Substitution/#2744" class="Function">↑</a><a id="16055" class="Symbol">)</a> <a id="16057" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16059" href="/Substitution/#15998" class="Bound">N</a>
<a id="16061" href="/Substitution/#15964" class="Function">sub-abs</a> <a id="16069" class="Symbol">{</a><a id="16070" class="Argument">σ</a> <a id="16072" class="Symbol">=</a> <a id="16074" href="/Substitution/#16074" class="Bound">σ</a><a id="16075" class="Symbol">}{</a><a id="16077" class="Argument">N</a> <a id="16079" class="Symbol">=</a> <a id="16081" href="/Substitution/#16081" class="Bound">N</a><a id="16082" class="Symbol">}</a> <a id="16084" class="Symbol">=</a>
   <a id="16089" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16100" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16102" href="/Substitution/#16074" class="Bound">σ</a> <a id="16104" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16106" class="Symbol">(</a><a id="16107" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16109" href="/Substitution/#16081" class="Bound">N</a><a id="16110" class="Symbol">)</a>
   <a id="16115" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="16124" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16126" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16128" href="/Untyped/#6623" class="Function">exts</a> <a id="16133" href="/Substitution/#16074" class="Bound">σ</a> <a id="16135" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16137" href="/Substitution/#16081" class="Bound">N</a>
   <a id="16142" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16145" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="16150" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="16153" class="Symbol">(</a><a id="16154" href="/Substitution/#10706" class="Function">cong-sub</a><a id="16162" class="Symbol">{</a><a id="16163" class="Argument">M</a> <a id="16165" class="Symbol">=</a> <a id="16167" href="/Substitution/#16081" class="Bound">N</a><a id="16168" class="Symbol">}</a> <a id="16170" href="/Substitution/#14699" class="Function">exts-cons-shift</a> <a id="16186" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="16190" class="Symbol">)</a> <a id="16192" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="16199" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16201" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16203" class="Symbol">(</a><a id="16204" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16206" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16207" class="Symbol">)</a> <a id="16209" href="/Substitution/#3002" class="Function Operator">•</a> <a id="16211" class="Symbol">(</a><a id="16212" href="/Substitution/#16074" class="Bound">σ</a> <a id="16214" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="16216" href="/Substitution/#2744" class="Function">↑</a><a id="16217" class="Symbol">)</a> <a id="16219" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16221" href="/Substitution/#16081" class="Bound">N</a>
   <a id="16226" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof of <code class="highlighter-rouge">sub-id</code> requires the following lemma which says that
extending the identity substitution produces the identity
substitution.</p>

<pre class="Agda"><a id="exts-ids"></a><a id="16393" href="/Substitution/#16393" class="Function">exts-ids</a> <a id="16402" class="Symbol">:</a> <a id="16404" class="Symbol">∀{</a><a id="16406" href="/Substitution/#16406" class="Bound">Γ</a><a id="16407" class="Symbol">}{</a><a id="16409" href="/Substitution/#16409" class="Bound">A</a> <a id="16411" href="/Substitution/#16411" class="Bound">B</a><a id="16412" class="Symbol">}</a>
         <a id="16423" class="Symbol">→</a> <a id="16425" href="/Untyped/#6623" class="Function">exts</a> <a id="16430" href="/Substitution/#2589" class="Function">ids</a> <a id="16434" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16436" href="/Substitution/#2589" class="Function">ids</a> <a id="16440" class="Symbol">{</a><a id="16441" href="/Substitution/#16406" class="Bound">Γ</a> <a id="16443" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16445" href="/Substitution/#16411" class="Bound">B</a><a id="16446" class="Symbol">}</a> <a id="16448" class="Symbol">{</a><a id="16449" href="/Substitution/#16409" class="Bound">A</a><a id="16450" class="Symbol">}</a>
<a id="16452" href="/Substitution/#16393" class="Function">exts-ids</a> <a id="16461" class="Symbol">{</a><a id="16462" href="/Substitution/#16462" class="Bound">Γ</a><a id="16463" class="Symbol">}{</a><a id="16465" href="/Substitution/#16465" class="Bound">A</a><a id="16466" class="Symbol">}{</a><a id="16468" href="/Substitution/#16468" class="Bound">B</a><a id="16469" class="Symbol">}</a> <a id="16471" class="Symbol">=</a> <a id="16473" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="16488" href="/Substitution/#16502" class="Function">lemma</a>
  <a id="16496" class="Keyword">where</a> <a id="16502" href="/Substitution/#16502" class="Function">lemma</a> <a id="16508" class="Symbol">:</a> <a id="16510" class="Symbol">(</a><a id="16511" href="/Substitution/#16511" class="Bound">x</a> <a id="16513" class="Symbol">:</a> <a id="16515" href="/Substitution/#16462" class="Bound">Γ</a> <a id="16517" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16519" href="/Substitution/#16468" class="Bound">B</a> <a id="16521" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="16523" href="/Substitution/#16465" class="Bound">A</a><a id="16524" class="Symbol">)</a> <a id="16526" class="Symbol">→</a> <a id="16528" href="/Untyped/#6623" class="Function">exts</a> <a id="16533" href="/Substitution/#2589" class="Function">ids</a> <a id="16537" href="/Substitution/#16511" class="Bound">x</a> <a id="16539" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16541" href="/Substitution/#2589" class="Function">ids</a> <a id="16545" href="/Substitution/#16511" class="Bound">x</a>
        <a id="16555" href="/Substitution/#16502" class="Function">lemma</a> <a id="16561" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="16563" class="Symbol">=</a> <a id="16565" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
        <a id="16578" href="/Substitution/#16502" class="Function">lemma</a> <a id="16584" class="Symbol">(</a><a id="16585" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="16587" href="/Substitution/#16587" class="Bound">x</a><a id="16588" class="Symbol">)</a> <a id="16590" class="Symbol">=</a> <a id="16592" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The proof of <code class="highlighter-rouge">⧼ ids ⧽ M ≡ M</code> now follows easily by induction on <code class="highlighter-rouge">M</code>,
using <code class="highlighter-rouge">exts-ids</code> in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="sub-id"></a><a id="16736" href="/Substitution/#16736" class="Function">sub-id</a> <a id="16743" class="Symbol">:</a> <a id="16745" class="Symbol">∀{</a><a id="16747" href="/Substitution/#16747" class="Bound">Γ</a><a id="16748" class="Symbol">}</a> <a id="16750" class="Symbol">{</a><a id="16751" href="/Substitution/#16751" class="Bound">A</a><a id="16752" class="Symbol">}</a> <a id="16754" class="Symbol">{</a><a id="16755" href="/Substitution/#16755" class="Bound">M</a> <a id="16757" class="Symbol">:</a> <a id="16759" href="/Substitution/#16747" class="Bound">Γ</a> <a id="16761" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16763" href="/Substitution/#16751" class="Bound">A</a><a id="16764" class="Symbol">}</a>
         <a id="16775" class="Symbol">→</a> <a id="16777" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16779" href="/Substitution/#2589" class="Function">ids</a> <a id="16783" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16785" href="/Substitution/#16755" class="Bound">M</a> <a id="16787" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16789" href="/Substitution/#16755" class="Bound">M</a>
<a id="16791" href="/Substitution/#16736" class="Function">sub-id</a> <a id="16798" class="Symbol">{</a><a id="16799" class="Argument">M</a> <a id="16801" class="Symbol">=</a> <a id="16803" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16805" href="/Substitution/#16805" class="Bound">x</a><a id="16806" class="Symbol">}</a> <a id="16808" class="Symbol">=</a> <a id="16810" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="16815" href="/Substitution/#16736" class="Function">sub-id</a> <a id="16822" class="Symbol">{</a><a id="16823" class="Argument">M</a> <a id="16825" class="Symbol">=</a> <a id="16827" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16829" href="/Substitution/#16829" class="Bound">N</a><a id="16830" class="Symbol">}</a> <a id="16832" class="Symbol">=</a> 
   <a id="16838" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16849" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16851" href="/Substitution/#2589" class="Function">ids</a> <a id="16855" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16857" class="Symbol">(</a><a id="16858" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16860" href="/Substitution/#16829" class="Bound">N</a><a id="16861" class="Symbol">)</a>
   <a id="16866" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="16875" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16877" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16879" href="/Untyped/#6623" class="Function">exts</a> <a id="16884" href="/Substitution/#2589" class="Function">ids</a> <a id="16888" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16890" href="/Substitution/#16829" class="Bound">N</a>
   <a id="16895" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16898" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="16903" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="16906" class="Symbol">(</a><a id="16907" href="/Substitution/#10706" class="Function">cong-sub</a><a id="16915" class="Symbol">{</a><a id="16916" class="Argument">M</a> <a id="16918" class="Symbol">=</a> <a id="16920" href="/Substitution/#16829" class="Bound">N</a><a id="16921" class="Symbol">}</a> <a id="16923" href="/Substitution/#16393" class="Function">exts-ids</a> <a id="16932" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="16936" class="Symbol">)</a>  <a id="16939" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="16946" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16948" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="16950" href="/Substitution/#2589" class="Function">ids</a> <a id="16954" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="16956" href="/Substitution/#16829" class="Bound">N</a>
   <a id="16961" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16964" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="16969" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="16972" href="/Substitution/#16736" class="Function">sub-id</a> <a id="16979" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="16986" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16988" href="/Substitution/#16829" class="Bound">N</a>
   <a id="16993" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="16995" href="/Substitution/#16736" class="Function">sub-id</a> <a id="17002" class="Symbol">{</a><a id="17003" class="Argument">M</a> <a id="17005" class="Symbol">=</a> <a id="17007" href="/Substitution/#17007" class="Bound">L</a> <a id="17009" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="17011" href="/Substitution/#17011" class="Bound">M</a><a id="17012" class="Symbol">}</a> <a id="17014" class="Symbol">=</a> <a id="17016" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="17022" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="17026" href="/Substitution/#16736" class="Function">sub-id</a> <a id="17033" href="/Substitution/#16736" class="Function">sub-id</a></pre>

<h2 id="proof-of-sub-idr">Proof of sub-idR</h2>

<p>The proof of <code class="highlighter-rouge">sub-idR</code> follows directly from <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="sub-idR"></a><a id="17143" href="/Substitution/#17143" class="Function">sub-idR</a> <a id="17151" class="Symbol">:</a> <a id="17153" class="Symbol">∀{</a><a id="17155" href="/Substitution/#17155" class="Bound">Γ</a> <a id="17157" href="/Substitution/#17157" class="Bound">Δ</a><a id="17158" class="Symbol">}</a> <a id="17160" class="Symbol">{</a><a id="17161" href="/Substitution/#17161" class="Bound">σ</a> <a id="17163" class="Symbol">:</a> <a id="17165" href="/Soundness/#2673" class="Function">Subst</a> <a id="17171" href="/Substitution/#17155" class="Bound">Γ</a> <a id="17173" href="/Substitution/#17157" class="Bound">Δ</a><a id="17174" class="Symbol">}</a> <a id="17176" class="Symbol">{</a><a id="17177" href="/Substitution/#17177" class="Bound">A</a><a id="17178" class="Symbol">}</a>
       <a id="17187" class="Symbol">→</a> <a id="17189" class="Symbol">(</a><a id="17190" href="/Substitution/#17161" class="Bound">σ</a> <a id="17192" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="17194" href="/Substitution/#2589" class="Function">ids</a><a id="17197" class="Symbol">)</a> <a id="17199" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17201" href="/Substitution/#17161" class="Bound">σ</a> <a id="17203" class="Symbol">{</a><a id="17204" href="/Substitution/#17177" class="Bound">A</a><a id="17205" class="Symbol">}</a>
<a id="17207" href="/Substitution/#17143" class="Function">sub-idR</a> <a id="17215" class="Symbol">{</a><a id="17216" href="/Substitution/#17216" class="Bound">Γ</a><a id="17217" class="Symbol">}{</a><a id="17219" class="Argument">σ</a> <a id="17221" class="Symbol">=</a> <a id="17223" href="/Substitution/#17223" class="Bound">σ</a><a id="17224" class="Symbol">}{</a><a id="17226" href="/Substitution/#17226" class="Bound">A</a><a id="17227" class="Symbol">}</a> <a id="17229" class="Symbol">=</a>
          <a id="17241" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
            <a id="17259" href="/Substitution/#17223" class="Bound">σ</a> <a id="17261" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="17263" href="/Substitution/#2589" class="Function">ids</a>
          <a id="17277" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
            <a id="17293" class="Symbol">(</a><a id="17294" href="/Untyped/#6931" class="Function">subst</a> <a id="17300" href="/Substitution/#2589" class="Function">ids</a><a id="17303" class="Symbol">)</a> <a id="17305" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="17307" href="/Substitution/#17223" class="Bound">σ</a>
          <a id="17319" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17322" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="17337" class="Symbol">(λ</a> <a id="17340" href="/Substitution/#17340" class="Bound">x</a> <a id="17342" class="Symbol">→</a> <a id="17344" href="/Substitution/#16736" class="Function">sub-id</a><a id="17350" class="Symbol">)</a> <a id="17352" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
            <a id="17366" href="/Substitution/#17223" class="Bound">σ</a>
          <a id="17378" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-sub">Proof of sub-sub</h2>

<p>The <code class="highlighter-rouge">sub-sub</code> equation states that sequenced substitutions <code class="highlighter-rouge">σ ⨟ τ</code>
are equivalent to first applying <code class="highlighter-rouge">σ</code> then applying <code class="highlighter-rouge">τ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⧼ τ ⧽ ⧼ σ ⧽ M  ≡ ⧼ σ ⨟ τ ⧽ M
</code></pre></div></div>

<p>The proof requires several lemmas. First, we need to prove the
specialization for renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (rename ρ' M) ≡ rename (ρ ∘ ρ') M
</code></pre></div></div>

<p>This in turn requires the following lemma about <code class="highlighter-rouge">ext</code>.</p>

<pre class="Agda"><a id="compose-ext"></a><a id="17782" href="/Substitution/#17782" class="Function">compose-ext</a> <a id="17794" class="Symbol">:</a> <a id="17796" class="Symbol">∀{</a><a id="17798" href="/Substitution/#17798" class="Bound">Γ</a> <a id="17800" href="/Substitution/#17800" class="Bound">Δ</a> <a id="17802" href="/Substitution/#17802" class="Bound">Σ</a><a id="17803" class="Symbol">}{</a><a id="17805" href="/Substitution/#17805" class="Bound">ρ</a> <a id="17807" class="Symbol">:</a> <a id="17809" href="/Denotational/#23286" class="Function">Rename</a> <a id="17816" href="/Substitution/#17800" class="Bound">Δ</a> <a id="17818" href="/Substitution/#17802" class="Bound">Σ</a><a id="17819" class="Symbol">}</a> <a id="17821" class="Symbol">{</a><a id="17822" href="/Substitution/#17822" class="Bound">ρ&#39;</a> <a id="17825" class="Symbol">:</a> <a id="17827" href="/Denotational/#23286" class="Function">Rename</a> <a id="17834" href="/Substitution/#17798" class="Bound">Γ</a> <a id="17836" href="/Substitution/#17800" class="Bound">Δ</a><a id="17837" class="Symbol">}</a> <a id="17839" class="Symbol">{</a><a id="17840" href="/Substitution/#17840" class="Bound">A</a> <a id="17842" href="/Substitution/#17842" class="Bound">B</a><a id="17843" class="Symbol">}</a>
            <a id="17857" class="Symbol">→</a> <a id="17859" class="Symbol">((</a><a id="17861" href="/Untyped/#5845" class="Function">ext</a> <a id="17865" href="/Substitution/#17805" class="Bound">ρ</a><a id="17866" class="Symbol">)</a> <a id="17868" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="17870" class="Symbol">(</a><a id="17871" href="/Untyped/#5845" class="Function">ext</a> <a id="17875" href="/Substitution/#17822" class="Bound">ρ&#39;</a><a id="17877" class="Symbol">))</a> <a id="17880" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17882" href="/Untyped/#5845" class="Function">ext</a> <a id="17886" class="Symbol">(</a><a id="17887" href="/Substitution/#17805" class="Bound">ρ</a> <a id="17889" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="17891" href="/Substitution/#17822" class="Bound">ρ&#39;</a><a id="17893" class="Symbol">)</a> <a id="17895" class="Symbol">{</a><a id="17896" href="/Substitution/#17842" class="Bound">B</a><a id="17897" class="Symbol">}</a> <a id="17899" class="Symbol">{</a><a id="17900" href="/Substitution/#17840" class="Bound">A</a><a id="17901" class="Symbol">}</a>
<a id="17903" href="/Substitution/#17782" class="Function">compose-ext</a> <a id="17915" class="Symbol">=</a> <a id="17917" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="17932" class="Symbol">λ</a> <a id="17934" href="/Substitution/#17934" class="Bound">x</a> <a id="17936" class="Symbol">→</a> <a id="17938" href="/Substitution/#17962" class="Function">lemma</a> <a id="17944" class="Symbol">{</a><a id="17945" class="Argument">x</a> <a id="17947" class="Symbol">=</a> <a id="17949" href="/Substitution/#17934" class="Bound">x</a><a id="17950" class="Symbol">}</a>
  <a id="17954" class="Keyword">where</a>
  <a id="17962" href="/Substitution/#17962" class="Function">lemma</a> <a id="17968" class="Symbol">:</a> <a id="17970" class="Symbol">∀{</a><a id="17972" href="/Substitution/#17972" class="Bound">Γ</a> <a id="17974" href="/Substitution/#17974" class="Bound">Δ</a> <a id="17976" href="/Substitution/#17976" class="Bound">Σ</a><a id="17977" class="Symbol">}{</a><a id="17979" href="/Substitution/#17979" class="Bound">ρ</a> <a id="17981" class="Symbol">:</a> <a id="17983" href="/Denotational/#23286" class="Function">Rename</a> <a id="17990" href="/Substitution/#17974" class="Bound">Δ</a> <a id="17992" href="/Substitution/#17976" class="Bound">Σ</a><a id="17993" class="Symbol">}</a> <a id="17995" class="Symbol">{</a><a id="17996" href="/Substitution/#17996" class="Bound">ρ&#39;</a> <a id="17999" class="Symbol">:</a> <a id="18001" href="/Denotational/#23286" class="Function">Rename</a> <a id="18008" href="/Substitution/#17972" class="Bound">Γ</a> <a id="18010" href="/Substitution/#17974" class="Bound">Δ</a><a id="18011" class="Symbol">}</a> <a id="18013" class="Symbol">{</a><a id="18014" href="/Substitution/#18014" class="Bound">A</a> <a id="18016" href="/Substitution/#18016" class="Bound">B</a><a id="18017" class="Symbol">}</a> <a id="18019" class="Symbol">{</a><a id="18020" href="/Substitution/#18020" class="Bound">x</a> <a id="18022" class="Symbol">:</a> <a id="18024" href="/Substitution/#17972" class="Bound">Γ</a> <a id="18026" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="18028" href="/Substitution/#18016" class="Bound">B</a> <a id="18030" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="18032" href="/Substitution/#18014" class="Bound">A</a><a id="18033" class="Symbol">}</a>
              <a id="18049" class="Symbol">→</a> <a id="18051" class="Symbol">((</a><a id="18053" href="/Untyped/#5845" class="Function">ext</a> <a id="18057" href="/Substitution/#17979" class="Bound">ρ</a><a id="18058" class="Symbol">)</a> <a id="18060" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18062" class="Symbol">(</a><a id="18063" href="/Untyped/#5845" class="Function">ext</a> <a id="18067" href="/Substitution/#17996" class="Bound">ρ&#39;</a><a id="18069" class="Symbol">))</a> <a id="18072" href="/Substitution/#18020" class="Bound">x</a> <a id="18074" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18076" href="/Untyped/#5845" class="Function">ext</a> <a id="18080" class="Symbol">(</a><a id="18081" href="/Substitution/#17979" class="Bound">ρ</a> <a id="18083" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18085" href="/Substitution/#17996" class="Bound">ρ&#39;</a><a id="18087" class="Symbol">)</a> <a id="18089" href="/Substitution/#18020" class="Bound">x</a>
  <a id="18093" href="/Substitution/#17962" class="Function">lemma</a> <a id="18099" class="Symbol">{</a><a id="18100" class="Argument">x</a> <a id="18102" class="Symbol">=</a> <a id="18104" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="18105" class="Symbol">}</a> <a id="18107" class="Symbol">=</a> <a id="18109" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="18116" href="/Substitution/#17962" class="Function">lemma</a> <a id="18122" class="Symbol">{</a><a id="18123" class="Argument">x</a> <a id="18125" class="Symbol">=</a> <a id="18127" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="18129" href="/Substitution/#18129" class="Bound">x</a><a id="18130" class="Symbol">}</a> <a id="18132" class="Symbol">=</a> <a id="18134" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>To prove that composing renamings is equivalent to appying one after
the other using <code class="highlighter-rouge">rename</code>, we proceed by induction on the term <code class="highlighter-rouge">M</code>,
using the <code class="highlighter-rouge">compose-ext</code> lemma in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="compose-rename"></a><a id="18358" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="18373" class="Symbol">:</a> <a id="18375" class="Symbol">∀{</a><a id="18377" href="/Substitution/#18377" class="Bound">Γ</a> <a id="18379" href="/Substitution/#18379" class="Bound">Δ</a> <a id="18381" href="/Substitution/#18381" class="Bound">Σ</a><a id="18382" class="Symbol">}{</a><a id="18384" href="/Substitution/#18384" class="Bound">A</a><a id="18385" class="Symbol">}{</a><a id="18387" href="/Substitution/#18387" class="Bound">M</a> <a id="18389" class="Symbol">:</a> <a id="18391" href="/Substitution/#18377" class="Bound">Γ</a> <a id="18393" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="18395" href="/Substitution/#18384" class="Bound">A</a><a id="18396" class="Symbol">}{</a><a id="18398" href="/Substitution/#18398" class="Bound">ρ</a> <a id="18400" class="Symbol">:</a> <a id="18402" href="/Denotational/#23286" class="Function">Rename</a> <a id="18409" href="/Substitution/#18379" class="Bound">Δ</a> <a id="18411" href="/Substitution/#18381" class="Bound">Σ</a><a id="18412" class="Symbol">}{</a><a id="18414" href="/Substitution/#18414" class="Bound">ρ&#39;</a> <a id="18417" class="Symbol">:</a> <a id="18419" href="/Denotational/#23286" class="Function">Rename</a> <a id="18426" href="/Substitution/#18377" class="Bound">Γ</a> <a id="18428" href="/Substitution/#18379" class="Bound">Δ</a><a id="18429" class="Symbol">}</a> 
  <a id="18434" class="Symbol">→</a> <a id="18436" href="/Untyped/#6171" class="Function">rename</a> <a id="18443" href="/Substitution/#18398" class="Bound">ρ</a> <a id="18445" class="Symbol">(</a><a id="18446" href="/Untyped/#6171" class="Function">rename</a> <a id="18453" href="/Substitution/#18414" class="Bound">ρ&#39;</a> <a id="18456" href="/Substitution/#18387" class="Bound">M</a><a id="18457" class="Symbol">)</a> <a id="18459" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18461" href="/Untyped/#6171" class="Function">rename</a> <a id="18468" class="Symbol">(</a><a id="18469" href="/Substitution/#18398" class="Bound">ρ</a> <a id="18471" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18473" href="/Substitution/#18414" class="Bound">ρ&#39;</a><a id="18475" class="Symbol">)</a> <a id="18477" href="/Substitution/#18387" class="Bound">M</a>
<a id="18479" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="18494" class="Symbol">{</a><a id="18495" class="Argument">M</a> <a id="18497" class="Symbol">=</a> <a id="18499" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="18501" href="/Substitution/#18501" class="Bound">x</a><a id="18502" class="Symbol">}</a> <a id="18504" class="Symbol">=</a> <a id="18506" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="18511" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="18526" class="Symbol">{</a><a id="18527" href="/Substitution/#18527" class="Bound">Γ</a><a id="18528" class="Symbol">}{</a><a id="18530" href="/Substitution/#18530" class="Bound">Δ</a><a id="18531" class="Symbol">}{</a><a id="18533" href="/Substitution/#18533" class="Bound">Σ</a><a id="18534" class="Symbol">}{</a><a id="18536" href="/Substitution/#18536" class="Bound">A</a><a id="18537" class="Symbol">}{</a><a id="18539" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="18541" href="/Substitution/#18541" class="Bound">N</a><a id="18542" class="Symbol">}{</a><a id="18544" href="/Substitution/#18544" class="Bound">ρ</a><a id="18545" class="Symbol">}{</a><a id="18547" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18549" class="Symbol">}</a> <a id="18551" class="Symbol">=</a> <a id="18553" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="18558" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="18561" href="/Substitution/#18573" class="Function">G</a>
  <a id="18565" class="Keyword">where</a>
  <a id="18573" href="/Substitution/#18573" class="Function">G</a> <a id="18575" class="Symbol">:</a> <a id="18577" href="/Untyped/#6171" class="Function">rename</a> <a id="18584" class="Symbol">(</a><a id="18585" href="/Untyped/#5845" class="Function">ext</a> <a id="18589" href="/Substitution/#18544" class="Bound">ρ</a><a id="18590" class="Symbol">)</a> <a id="18592" class="Symbol">(</a><a id="18593" href="/Untyped/#6171" class="Function">rename</a> <a id="18600" class="Symbol">(</a><a id="18601" href="/Untyped/#5845" class="Function">ext</a> <a id="18605" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18607" class="Symbol">)</a> <a id="18609" href="/Substitution/#18541" class="Bound">N</a><a id="18610" class="Symbol">)</a> <a id="18612" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18614" href="/Untyped/#6171" class="Function">rename</a> <a id="18621" class="Symbol">(</a><a id="18622" href="/Untyped/#5845" class="Function">ext</a> <a id="18626" class="Symbol">(</a><a id="18627" href="/Substitution/#18544" class="Bound">ρ</a> <a id="18629" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18631" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18633" class="Symbol">))</a> <a id="18636" href="/Substitution/#18541" class="Bound">N</a>
  <a id="18640" href="/Substitution/#18573" class="Function">G</a> <a id="18642" class="Symbol">=</a>
      <a id="18650" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="18664" href="/Untyped/#6171" class="Function">rename</a> <a id="18671" class="Symbol">(</a><a id="18672" href="/Untyped/#5845" class="Function">ext</a> <a id="18676" href="/Substitution/#18544" class="Bound">ρ</a><a id="18677" class="Symbol">)</a> <a id="18679" class="Symbol">(</a><a id="18680" href="/Untyped/#6171" class="Function">rename</a> <a id="18687" class="Symbol">(</a><a id="18688" href="/Untyped/#5845" class="Function">ext</a> <a id="18692" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18694" class="Symbol">)</a> <a id="18696" href="/Substitution/#18541" class="Bound">N</a><a id="18697" class="Symbol">)</a>
      <a id="18705" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18708" href="/Substitution/#18358" class="Function">compose-rename</a><a id="18722" class="Symbol">{</a><a id="18723" class="Argument">ρ</a> <a id="18725" class="Symbol">=</a> <a id="18727" href="/Untyped/#5845" class="Function">ext</a> <a id="18731" href="/Substitution/#18544" class="Bound">ρ</a><a id="18732" class="Symbol">}{</a><a id="18734" class="Argument">ρ&#39;</a> <a id="18737" class="Symbol">=</a> <a id="18739" href="/Untyped/#5845" class="Function">ext</a> <a id="18743" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18745" class="Symbol">}</a> <a id="18747" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="18757" href="/Untyped/#6171" class="Function">rename</a> <a id="18764" class="Symbol">((</a><a id="18766" href="/Untyped/#5845" class="Function">ext</a> <a id="18770" href="/Substitution/#18544" class="Bound">ρ</a><a id="18771" class="Symbol">)</a> <a id="18773" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18775" class="Symbol">(</a><a id="18776" href="/Untyped/#5845" class="Function">ext</a> <a id="18780" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18782" class="Symbol">))</a> <a id="18785" href="/Substitution/#18541" class="Bound">N</a>
      <a id="18793" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18796" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="18808" href="/Substitution/#17782" class="Function">compose-ext</a> <a id="18820" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="18825" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="18835" href="/Untyped/#6171" class="Function">rename</a> <a id="18842" class="Symbol">(</a><a id="18843" href="/Untyped/#5845" class="Function">ext</a> <a id="18847" class="Symbol">(</a><a id="18848" href="/Substitution/#18544" class="Bound">ρ</a> <a id="18850" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="18852" href="/Substitution/#18547" class="Bound">ρ&#39;</a><a id="18854" class="Symbol">))</a> <a id="18857" href="/Substitution/#18541" class="Bound">N</a>
      <a id="18865" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>        
<a id="18875" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="18890" class="Symbol">{</a><a id="18891" class="Argument">M</a> <a id="18893" class="Symbol">=</a> <a id="18895" href="/Substitution/#18895" class="Bound">L</a> <a id="18897" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="18899" href="/Substitution/#18899" class="Bound">M</a><a id="18900" class="Symbol">}</a> <a id="18902" class="Symbol">=</a> <a id="18904" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="18910" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="18914" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="18929" href="/Substitution/#18358" class="Function">compose-rename</a></pre>

<p>The next lemma states that if a renaming and subtitution commute on
variables, then they also commute on terms. We explain the proof in
detail below.</p>

<pre class="Agda"><a id="commute-subst-rename"></a><a id="19120" href="/Substitution/#19120" class="Function">commute-subst-rename</a> <a id="19141" class="Symbol">:</a> <a id="19143" class="Symbol">∀{</a><a id="19145" href="/Substitution/#19145" class="Bound">Γ</a> <a id="19147" href="/Substitution/#19147" class="Bound">Δ</a><a id="19148" class="Symbol">}{</a><a id="19150" href="/Substitution/#19150" class="Bound">M</a> <a id="19152" class="Symbol">:</a> <a id="19154" href="/Substitution/#19145" class="Bound">Γ</a> <a id="19156" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="19158" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19159" class="Symbol">}{</a><a id="19161" href="/Substitution/#19161" class="Bound">σ</a> <a id="19163" class="Symbol">:</a> <a id="19165" href="/Soundness/#2673" class="Function">Subst</a> <a id="19171" href="/Substitution/#19145" class="Bound">Γ</a> <a id="19173" href="/Substitution/#19147" class="Bound">Δ</a><a id="19174" class="Symbol">}</a>
                        <a id="19200" class="Symbol">{</a><a id="19201" href="/Substitution/#19201" class="Bound">ρ</a> <a id="19203" class="Symbol">:</a> <a id="19205" class="Symbol">∀{</a><a id="19207" href="/Substitution/#19207" class="Bound">Γ</a><a id="19208" class="Symbol">}</a> <a id="19210" class="Symbol">→</a> <a id="19212" href="/Denotational/#23286" class="Function">Rename</a> <a id="19219" href="/Substitution/#19207" class="Bound">Γ</a> <a id="19221" class="Symbol">(</a><a id="19222" href="/Substitution/#19207" class="Bound">Γ</a> <a id="19224" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19226" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19227" class="Symbol">)}</a>
     <a id="19235" class="Symbol">→</a> <a id="19237" class="Symbol">(∀{</a><a id="19240" href="/Substitution/#19240" class="Bound">x</a> <a id="19242" class="Symbol">:</a> <a id="19244" href="/Substitution/#19145" class="Bound">Γ</a> <a id="19246" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19248" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19249" class="Symbol">}</a> <a id="19251" class="Symbol">→</a> <a id="19253" href="/Untyped/#6623" class="Function">exts</a> <a id="19258" href="/Substitution/#19161" class="Bound">σ</a> <a id="19260" class="Symbol">{</a><a id="19261" class="Argument">B</a> <a id="19263" class="Symbol">=</a> <a id="19265" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19266" class="Symbol">}</a> <a id="19268" class="Symbol">(</a><a id="19269" href="/Substitution/#19201" class="Bound">ρ</a> <a id="19271" href="/Substitution/#19240" class="Bound">x</a><a id="19272" class="Symbol">)</a> <a id="19274" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19276" href="/Untyped/#6171" class="Function">rename</a> <a id="19283" href="/Substitution/#19201" class="Bound">ρ</a> <a id="19285" class="Symbol">(</a><a id="19286" href="/Substitution/#19161" class="Bound">σ</a> <a id="19288" href="/Substitution/#19240" class="Bound">x</a><a id="19289" class="Symbol">))</a>
     <a id="19297" class="Symbol">→</a> <a id="19299" href="/Untyped/#6931" class="Function">subst</a> <a id="19305" class="Symbol">(</a><a id="19306" href="/Untyped/#6623" class="Function">exts</a> <a id="19311" href="/Substitution/#19161" class="Bound">σ</a> <a id="19313" class="Symbol">{</a><a id="19314" class="Argument">B</a> <a id="19316" class="Symbol">=</a> <a id="19318" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19319" class="Symbol">})</a> <a id="19322" class="Symbol">(</a><a id="19323" href="/Untyped/#6171" class="Function">rename</a> <a id="19330" href="/Substitution/#19201" class="Bound">ρ</a> <a id="19332" href="/Substitution/#19150" class="Bound">M</a><a id="19333" class="Symbol">)</a> <a id="19335" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19337" href="/Untyped/#6171" class="Function">rename</a> <a id="19344" href="/Substitution/#19201" class="Bound">ρ</a> <a id="19346" class="Symbol">(</a><a id="19347" href="/Untyped/#6931" class="Function">subst</a> <a id="19353" href="/Substitution/#19161" class="Bound">σ</a> <a id="19355" href="/Substitution/#19150" class="Bound">M</a><a id="19356" class="Symbol">)</a>
<a id="19358" href="/Substitution/#19120" class="Function">commute-subst-rename</a> <a id="19379" class="Symbol">{</a><a id="19380" class="Argument">M</a> <a id="19382" class="Symbol">=</a> <a id="19384" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="19386" href="/Substitution/#19386" class="Bound">x</a><a id="19387" class="Symbol">}</a> <a id="19389" href="/Substitution/#19389" class="Bound">r</a> <a id="19391" class="Symbol">=</a> <a id="19393" href="/Substitution/#19389" class="Bound">r</a>
<a id="19395" href="/Substitution/#19120" class="Function">commute-subst-rename</a><a id="19415" class="Symbol">{</a><a id="19416" href="/Substitution/#19416" class="Bound">Γ</a><a id="19417" class="Symbol">}{</a><a id="19419" href="/Substitution/#19419" class="Bound">Δ</a><a id="19420" class="Symbol">}{</a><a id="19422" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="19424" href="/Substitution/#19424" class="Bound">N</a><a id="19425" class="Symbol">}{</a><a id="19427" href="/Substitution/#19427" class="Bound">σ</a><a id="19428" class="Symbol">}{</a><a id="19430" href="/Substitution/#19430" class="Bound">ρ</a><a id="19431" class="Symbol">}</a> <a id="19433" href="/Substitution/#19433" class="Bound">r</a> <a id="19435" class="Symbol">=</a>
   <a id="19440" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19445" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="19448" class="Symbol">(</a><a id="19449" href="/Substitution/#19120" class="Function">commute-subst-rename</a><a id="19469" class="Symbol">{</a><a id="19470" href="/Substitution/#19416" class="Bound">Γ</a> <a id="19472" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19474" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19475" class="Symbol">}{</a><a id="19477" href="/Substitution/#19419" class="Bound">Δ</a> <a id="19479" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19481" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19482" class="Symbol">}{</a><a id="19484" href="/Substitution/#19424" class="Bound">N</a><a id="19485" class="Symbol">}</a>
               <a id="19502" class="Symbol">{</a><a id="19503" href="/Untyped/#6623" class="Function">exts</a> <a id="19508" href="/Substitution/#19427" class="Bound">σ</a><a id="19509" class="Symbol">}{</a><a id="19511" class="Argument">ρ</a> <a id="19513" class="Symbol">=</a> <a id="19515" href="/Substitution/#19548" class="Function">ρ&#39;</a><a id="19517" class="Symbol">}</a> <a id="19519" class="Symbol">(λ</a> <a id="19522" class="Symbol">{</a><a id="19523" href="/Substitution/#19523" class="Bound">x</a><a id="19524" class="Symbol">}</a> <a id="19526" class="Symbol">→</a> <a id="19528" href="/Substitution/#19621" class="Function">H</a> <a id="19530" class="Symbol">{</a><a id="19531" href="/Substitution/#19523" class="Bound">x</a><a id="19532" class="Symbol">}))</a>
   <a id="19539" class="Keyword">where</a>
   <a id="19548" href="/Substitution/#19548" class="Function">ρ&#39;</a> <a id="19551" class="Symbol">:</a> <a id="19553" class="Symbol">∀</a> <a id="19555" class="Symbol">{</a><a id="19556" href="/Substitution/#19556" class="Bound">Γ</a><a id="19557" class="Symbol">}</a> <a id="19559" class="Symbol">→</a> <a id="19561" href="/Denotational/#23286" class="Function">Rename</a> <a id="19568" href="/Substitution/#19556" class="Bound">Γ</a> <a id="19570" class="Symbol">(</a><a id="19571" href="/Substitution/#19556" class="Bound">Γ</a> <a id="19573" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19575" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19576" class="Symbol">)</a>
   <a id="19581" href="/Substitution/#19548" class="Function">ρ&#39;</a> <a id="19584" class="Symbol">{</a><a id="19585" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="19586" class="Symbol">}</a> <a id="19588" class="Symbol">=</a> <a id="19590" class="Symbol">λ</a> <a id="19592" class="Symbol">()</a>
   <a id="19598" href="/Substitution/#19548" class="Function">ρ&#39;</a> <a id="19601" class="Symbol">{</a><a id="19602" href="/Substitution/#19602" class="Bound">Γ</a> <a id="19604" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19606" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19607" class="Symbol">}</a> <a id="19609" class="Symbol">=</a> <a id="19611" href="/Untyped/#5845" class="Function">ext</a> <a id="19615" href="/Substitution/#19430" class="Bound">ρ</a>

   <a id="19621" href="/Substitution/#19621" class="Function">H</a> <a id="19623" class="Symbol">:</a> <a id="19625" class="Symbol">{</a><a id="19626" href="/Substitution/#19626" class="Bound">x</a> <a id="19628" class="Symbol">:</a> <a id="19630" href="/Substitution/#19416" class="Bound">Γ</a> <a id="19632" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19634" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="19636" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19638" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="19639" class="Symbol">}</a> <a id="19641" class="Symbol">→</a> <a id="19643" href="/Untyped/#6623" class="Function">exts</a> <a id="19648" class="Symbol">(</a><a id="19649" href="/Untyped/#6623" class="Function">exts</a> <a id="19654" href="/Substitution/#19427" class="Bound">σ</a><a id="19655" class="Symbol">)</a> <a id="19657" class="Symbol">(</a><a id="19658" href="/Untyped/#5845" class="Function">ext</a> <a id="19662" href="/Substitution/#19430" class="Bound">ρ</a> <a id="19664" href="/Substitution/#19626" class="Bound">x</a><a id="19665" class="Symbol">)</a> <a id="19667" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19669" href="/Untyped/#6171" class="Function">rename</a> <a id="19676" class="Symbol">(</a><a id="19677" href="/Untyped/#5845" class="Function">ext</a> <a id="19681" href="/Substitution/#19430" class="Bound">ρ</a><a id="19682" class="Symbol">)</a> <a id="19684" class="Symbol">(</a><a id="19685" href="/Untyped/#6623" class="Function">exts</a> <a id="19690" href="/Substitution/#19427" class="Bound">σ</a> <a id="19692" href="/Substitution/#19626" class="Bound">x</a><a id="19693" class="Symbol">)</a>
   <a id="19698" href="/Substitution/#19621" class="Function">H</a> <a id="19700" class="Symbol">{</a><a id="19701" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="19702" class="Symbol">}</a> <a id="19704" class="Symbol">=</a> <a id="19706" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="19714" href="/Substitution/#19621" class="Function">H</a> <a id="19716" class="Symbol">{</a><a id="19717" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19719" href="/Substitution/#19719" class="Bound">y</a><a id="19720" class="Symbol">}</a> <a id="19722" class="Symbol">=</a>
     <a id="19729" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="19742" href="/Untyped/#6623" class="Function">exts</a> <a id="19747" class="Symbol">(</a><a id="19748" href="/Untyped/#6623" class="Function">exts</a> <a id="19753" href="/Substitution/#19427" class="Bound">σ</a><a id="19754" class="Symbol">)</a> <a id="19756" class="Symbol">(</a><a id="19757" href="/Untyped/#5845" class="Function">ext</a> <a id="19761" href="/Substitution/#19430" class="Bound">ρ</a> <a id="19763" class="Symbol">(</a><a id="19764" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19766" href="/Substitution/#19719" class="Bound">y</a><a id="19767" class="Symbol">))</a>
     <a id="19775" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="19786" href="/Untyped/#6171" class="Function">rename</a> <a id="19793" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="19796" class="Symbol">(</a><a id="19797" href="/Untyped/#6623" class="Function">exts</a> <a id="19802" href="/Substitution/#19427" class="Bound">σ</a> <a id="19804" class="Symbol">(</a><a id="19805" href="/Substitution/#19430" class="Bound">ρ</a> <a id="19807" href="/Substitution/#19719" class="Bound">y</a><a id="19808" class="Symbol">))</a> 
     <a id="19817" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19820" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19825" class="Symbol">(</a><a id="19826" href="/Untyped/#6171" class="Function">rename</a> <a id="19833" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="19835" class="Symbol">)</a> <a id="19837" href="/Substitution/#19433" class="Bound">r</a> <a id="19839" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="19848" href="/Untyped/#6171" class="Function">rename</a> <a id="19855" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="19858" class="Symbol">(</a><a id="19859" href="/Untyped/#6171" class="Function">rename</a> <a id="19866" href="/Substitution/#19430" class="Bound">ρ</a> <a id="19868" class="Symbol">(</a><a id="19869" href="/Substitution/#19427" class="Bound">σ</a> <a id="19871" href="/Substitution/#19719" class="Bound">y</a><a id="19872" class="Symbol">))</a>
     <a id="19880" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19883" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="19898" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="19907" href="/Untyped/#6171" class="Function">rename</a> <a id="19914" class="Symbol">(</a><a id="19915" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="19918" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="19920" href="/Substitution/#19430" class="Bound">ρ</a><a id="19921" class="Symbol">)</a> <a id="19923" class="Symbol">(</a><a id="19924" href="/Substitution/#19427" class="Bound">σ</a> <a id="19926" href="/Substitution/#19719" class="Bound">y</a><a id="19927" class="Symbol">)</a>
     <a id="19934" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19937" href="/Substitution/#9872" class="Function">cong-rename</a> <a id="19949" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="19954" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="19959" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="19968" href="/Untyped/#6171" class="Function">rename</a> <a id="19975" class="Symbol">((</a><a id="19977" href="/Untyped/#5845" class="Function">ext</a> <a id="19981" href="/Substitution/#19430" class="Bound">ρ</a><a id="19982" class="Symbol">)</a> <a id="19984" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="19986" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="19988" class="Symbol">)</a> <a id="19990" class="Symbol">(</a><a id="19991" href="/Substitution/#19427" class="Bound">σ</a> <a id="19993" href="/Substitution/#19719" class="Bound">y</a><a id="19994" class="Symbol">)</a>
     <a id="20001" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20004" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="20008" href="/Substitution/#18358" class="Function">compose-rename</a> <a id="20023" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="20032" href="/Untyped/#6171" class="Function">rename</a> <a id="20039" class="Symbol">(</a><a id="20040" href="/Untyped/#5845" class="Function">ext</a> <a id="20044" href="/Substitution/#19430" class="Bound">ρ</a><a id="20045" class="Symbol">)</a> <a id="20047" class="Symbol">(</a><a id="20048" href="/Untyped/#6171" class="Function">rename</a> <a id="20055" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20058" class="Symbol">(</a><a id="20059" href="/Substitution/#19427" class="Bound">σ</a> <a id="20061" href="/Substitution/#19719" class="Bound">y</a><a id="20062" class="Symbol">))</a>
     <a id="20070" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="20081" href="/Untyped/#6171" class="Function">rename</a> <a id="20088" class="Symbol">(</a><a id="20089" href="/Untyped/#5845" class="Function">ext</a> <a id="20093" href="/Substitution/#19430" class="Bound">ρ</a><a id="20094" class="Symbol">)</a> <a id="20096" class="Symbol">(</a><a id="20097" href="/Untyped/#6623" class="Function">exts</a> <a id="20102" href="/Substitution/#19427" class="Bound">σ</a> <a id="20104" class="Symbol">(</a><a id="20105" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20107" href="/Substitution/#19719" class="Bound">y</a><a id="20108" class="Symbol">))</a>
     <a id="20116" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="20118" href="/Substitution/#19120" class="Function">commute-subst-rename</a> <a id="20139" class="Symbol">{</a><a id="20140" class="Argument">M</a> <a id="20142" class="Symbol">=</a> <a id="20144" href="/Substitution/#20144" class="Bound">L</a> <a id="20146" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="20148" href="/Substitution/#20148" class="Bound">M</a><a id="20149" class="Symbol">}{</a><a id="20151" class="Argument">ρ</a> <a id="20153" class="Symbol">=</a> <a id="20155" href="/Substitution/#20155" class="Bound">ρ</a><a id="20156" class="Symbol">}</a> <a id="20158" href="/Substitution/#20158" class="Bound">r</a> <a id="20160" class="Symbol">=</a>
   <a id="20165" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="20171" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="20175" class="Symbol">(</a><a id="20176" href="/Substitution/#19120" class="Function">commute-subst-rename</a><a id="20196" class="Symbol">{</a><a id="20197" class="Argument">M</a> <a id="20199" class="Symbol">=</a> <a id="20201" href="/Substitution/#20144" class="Bound">L</a><a id="20202" class="Symbol">}{</a><a id="20204" class="Argument">ρ</a> <a id="20206" class="Symbol">=</a> <a id="20208" href="/Substitution/#20155" class="Bound">ρ</a><a id="20209" class="Symbol">}</a> <a id="20211" href="/Substitution/#20158" class="Bound">r</a><a id="20212" class="Symbol">)</a>
             <a id="20227" class="Symbol">(</a><a id="20228" href="/Substitution/#19120" class="Function">commute-subst-rename</a><a id="20248" class="Symbol">{</a><a id="20249" class="Argument">M</a> <a id="20251" class="Symbol">=</a> <a id="20253" href="/Substitution/#20148" class="Bound">M</a><a id="20254" class="Symbol">}{</a><a id="20256" class="Argument">ρ</a> <a id="20258" class="Symbol">=</a> <a id="20260" href="/Substitution/#20155" class="Bound">ρ</a><a id="20261" class="Symbol">}</a> <a id="20263" href="/Substitution/#20158" class="Bound">r</a><a id="20264" class="Symbol">)</a></pre>

<p>The proof is by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is a variable, then we use the premise to conclude.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M ≡ ƛ N</code>, we conclude using the induction hypothesis for
<code class="highlighter-rouge">N</code>. However, to use the induction hypothesis, we must show
that</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  exts (exts σ) (ext ρ x) ≡ rename (ext ρ) (exts σ x)
</code></pre></div>    </div>

    <p>We prove this equation by cases on x.</p>

    <ul>
      <li>
        <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by definition.</p>
      </li>
      <li>
        <p>If <code class="highlighter-rouge">x = S y</code>, we obtain the goal by the following equational reasoning.</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts (exts σ) (ext ρ (S y))   ≡ rename S_ (exts σ (ρ y))    ≡ rename S_ (rename S_ (σ (ρ y)      (by the premise)   ≡ rename (ext ρ) (exts σ (S y))      (by compose-rename)   ≡ rename ((ext ρ) ∘ S_) (σ y)   ≡ rename (ext ρ) (rename S_ (σ y))   (by compose-rename)   ≡ rename (ext ρ) (exts σ (S y))
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we obtain the goal using the induction
hypothesis for each subterm.</p>
  </li>
</ul>

<p>The last lemma needed to prove <code class="highlighter-rouge">sub-sub</code> states that the <code class="highlighter-rouge">exts</code>
function distributes with sequencing. It is a corollary of
<code class="highlighter-rouge">commute-subst-rename</code>. We describe the proof below.</p>

<pre class="Agda"><a id="exts-seq"></a><a id="21391" href="/Substitution/#21391" class="Function">exts-seq</a> <a id="21400" class="Symbol">:</a> <a id="21402" class="Symbol">∀{</a><a id="21404" href="/Substitution/#21404" class="Bound">Γ</a> <a id="21406" href="/Substitution/#21406" class="Bound">Δ</a> <a id="21408" href="/Substitution/#21408" class="Bound">Δ&#39;</a><a id="21410" class="Symbol">}</a> <a id="21412" class="Symbol">{</a><a id="21413" href="/Substitution/#21413" class="Bound">σ₁</a> <a id="21416" class="Symbol">:</a> <a id="21418" href="/Soundness/#2673" class="Function">Subst</a> <a id="21424" href="/Substitution/#21404" class="Bound">Γ</a> <a id="21426" href="/Substitution/#21406" class="Bound">Δ</a><a id="21427" class="Symbol">}</a> <a id="21429" class="Symbol">{</a><a id="21430" href="/Substitution/#21430" class="Bound">σ₂</a> <a id="21433" class="Symbol">:</a> <a id="21435" href="/Soundness/#2673" class="Function">Subst</a> <a id="21441" href="/Substitution/#21406" class="Bound">Δ</a> <a id="21443" href="/Substitution/#21408" class="Bound">Δ&#39;</a><a id="21445" class="Symbol">}</a>
   <a id="21450" class="Symbol">→</a> <a id="21452" class="Symbol">∀</a> <a id="21454" class="Symbol">{</a><a id="21455" href="/Substitution/#21455" class="Bound">A</a><a id="21456" class="Symbol">}</a> <a id="21458" class="Symbol">→</a> <a id="21460" class="Symbol">(</a><a id="21461" href="/Untyped/#6623" class="Function">exts</a> <a id="21466" href="/Substitution/#21413" class="Bound">σ₁</a> <a id="21469" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21471" href="/Untyped/#6623" class="Function">exts</a> <a id="21476" href="/Substitution/#21430" class="Bound">σ₂</a><a id="21478" class="Symbol">)</a> <a id="21480" class="Symbol">{</a><a id="21481" href="/Substitution/#21455" class="Bound">A</a><a id="21482" class="Symbol">}</a> <a id="21484" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="21486" href="/Untyped/#6623" class="Function">exts</a> <a id="21491" class="Symbol">(</a><a id="21492" href="/Substitution/#21413" class="Bound">σ₁</a> <a id="21495" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21497" href="/Substitution/#21430" class="Bound">σ₂</a><a id="21499" class="Symbol">)</a>
<a id="21501" href="/Substitution/#21391" class="Function">exts-seq</a> <a id="21510" class="Symbol">=</a> <a id="21512" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="21527" class="Symbol">λ</a> <a id="21529" href="/Substitution/#21529" class="Bound">x</a> <a id="21531" class="Symbol">→</a> <a id="21533" href="/Substitution/#21557" class="Function">lemma</a> <a id="21539" class="Symbol">{</a><a id="21540" class="Argument">x</a> <a id="21542" class="Symbol">=</a> <a id="21544" href="/Substitution/#21529" class="Bound">x</a><a id="21545" class="Symbol">}</a>
  <a id="21549" class="Keyword">where</a>
  <a id="21557" href="/Substitution/#21557" class="Function">lemma</a> <a id="21563" class="Symbol">:</a> <a id="21565" class="Symbol">∀{</a><a id="21567" href="/Substitution/#21567" class="Bound">Γ</a> <a id="21569" href="/Substitution/#21569" class="Bound">Δ</a> <a id="21571" href="/Substitution/#21571" class="Bound">Δ&#39;</a><a id="21573" class="Symbol">}{</a><a id="21575" href="/Substitution/#21575" class="Bound">A</a><a id="21576" class="Symbol">}{</a><a id="21578" href="/Substitution/#21578" class="Bound">x</a> <a id="21580" class="Symbol">:</a> <a id="21582" href="/Substitution/#21567" class="Bound">Γ</a> <a id="21584" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="21586" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="21588" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="21590" href="/Substitution/#21575" class="Bound">A</a><a id="21591" class="Symbol">}</a> <a id="21593" class="Symbol">{</a><a id="21594" href="/Substitution/#21594" class="Bound">σ₁</a> <a id="21597" class="Symbol">:</a> <a id="21599" href="/Soundness/#2673" class="Function">Subst</a> <a id="21605" href="/Substitution/#21567" class="Bound">Γ</a> <a id="21607" href="/Substitution/#21569" class="Bound">Δ</a><a id="21608" class="Symbol">}{</a><a id="21610" href="/Substitution/#21610" class="Bound">σ₂</a> <a id="21613" class="Symbol">:</a> <a id="21615" href="/Soundness/#2673" class="Function">Subst</a> <a id="21621" href="/Substitution/#21569" class="Bound">Δ</a> <a id="21623" href="/Substitution/#21571" class="Bound">Δ&#39;</a><a id="21625" class="Symbol">}</a>
     <a id="21632" class="Symbol">→</a> <a id="21634" class="Symbol">(</a><a id="21635" href="/Untyped/#6623" class="Function">exts</a> <a id="21640" href="/Substitution/#21594" class="Bound">σ₁</a> <a id="21643" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21645" href="/Untyped/#6623" class="Function">exts</a> <a id="21650" href="/Substitution/#21610" class="Bound">σ₂</a><a id="21652" class="Symbol">)</a> <a id="21654" href="/Substitution/#21578" class="Bound">x</a> <a id="21656" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="21658" href="/Untyped/#6623" class="Function">exts</a> <a id="21663" class="Symbol">(</a><a id="21664" href="/Substitution/#21594" class="Bound">σ₁</a> <a id="21667" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21669" href="/Substitution/#21610" class="Bound">σ₂</a><a id="21671" class="Symbol">)</a> <a id="21673" href="/Substitution/#21578" class="Bound">x</a>
  <a id="21677" href="/Substitution/#21557" class="Function">lemma</a> <a id="21683" class="Symbol">{</a><a id="21684" class="Argument">x</a> <a id="21686" class="Symbol">=</a> <a id="21688" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="21689" class="Symbol">}</a> <a id="21691" class="Symbol">=</a> <a id="21693" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="21700" href="/Substitution/#21557" class="Function">lemma</a> <a id="21706" class="Symbol">{</a><a id="21707" class="Argument">A</a> <a id="21709" class="Symbol">=</a> <a id="21711" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="21712" class="Symbol">}{</a><a id="21714" class="Argument">x</a> <a id="21716" class="Symbol">=</a> <a id="21718" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21720" href="/Substitution/#21720" class="Bound">x</a><a id="21721" class="Symbol">}{</a><a id="21723" href="/Substitution/#21723" class="Bound">σ₁</a><a id="21725" class="Symbol">}{</a><a id="21727" href="/Substitution/#21727" class="Bound">σ₂</a><a id="21729" class="Symbol">}</a> <a id="21731" class="Symbol">=</a>
     <a id="21738" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="21751" class="Symbol">(</a><a id="21752" href="/Untyped/#6623" class="Function">exts</a> <a id="21757" href="/Substitution/#21723" class="Bound">σ₁</a> <a id="21760" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21762" href="/Untyped/#6623" class="Function">exts</a> <a id="21767" href="/Substitution/#21727" class="Bound">σ₂</a><a id="21769" class="Symbol">)</a> <a id="21771" class="Symbol">(</a><a id="21772" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21774" href="/Substitution/#21720" class="Bound">x</a><a id="21775" class="Symbol">)</a>
     <a id="21782" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="21793" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="21795" href="/Untyped/#6623" class="Function">exts</a> <a id="21800" href="/Substitution/#21727" class="Bound">σ₂</a> <a id="21803" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="21805" class="Symbol">(</a><a id="21806" href="/Untyped/#6171" class="Function">rename</a> <a id="21813" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21816" class="Symbol">(</a><a id="21817" href="/Substitution/#21723" class="Bound">σ₁</a> <a id="21820" href="/Substitution/#21720" class="Bound">x</a><a id="21821" class="Symbol">))</a>
     <a id="21829" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21832" href="/Substitution/#19120" class="Function">commute-subst-rename</a><a id="21852" class="Symbol">{</a><a id="21853" class="Argument">M</a> <a id="21855" class="Symbol">=</a> <a id="21857" href="/Substitution/#21723" class="Bound">σ₁</a> <a id="21860" href="/Substitution/#21720" class="Bound">x</a><a id="21861" class="Symbol">}{</a><a id="21863" class="Argument">σ</a> <a id="21865" class="Symbol">=</a> <a id="21867" href="/Substitution/#21727" class="Bound">σ₂</a><a id="21869" class="Symbol">}{</a><a id="21871" class="Argument">ρ</a> <a id="21873" class="Symbol">=</a> <a id="21875" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="21877" class="Symbol">}</a> <a id="21879" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="21884" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21893" href="/Untyped/#6171" class="Function">rename</a> <a id="21900" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21903" class="Symbol">(</a><a id="21904" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="21906" href="/Substitution/#21727" class="Bound">σ₂</a> <a id="21909" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="21911" class="Symbol">(</a><a id="21912" href="/Substitution/#21723" class="Bound">σ₁</a> <a id="21915" href="/Substitution/#21720" class="Bound">x</a><a id="21916" class="Symbol">))</a>
     <a id="21924" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="21935" href="/Untyped/#6171" class="Function">rename</a> <a id="21942" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21945" class="Symbol">((</a><a id="21947" href="/Substitution/#21723" class="Bound">σ₁</a> <a id="21950" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="21952" href="/Substitution/#21727" class="Bound">σ₂</a><a id="21954" class="Symbol">)</a> <a id="21956" href="/Substitution/#21720" class="Bound">x</a><a id="21957" class="Symbol">)</a>
     <a id="21964" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof proceed by cases on <code class="highlighter-rouge">x</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by the definition of <code class="highlighter-rouge">exts</code>
and sequencing.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">x = S x</code>, we unfold the first use of <code class="highlighter-rouge">exts</code> and sequencing, then
apply the lemma <code class="highlighter-rouge">commute-subst-rename</code>. We conclude by the
definition of sequencing.</p>
  </li>
</ul>

<p>Now we come to the proof of <code class="highlighter-rouge">sub-sub</code>, which we explain below.</p>

<pre class="Agda"><a id="sub-sub"></a><a id="22338" href="/Substitution/#22338" class="Function">sub-sub</a> <a id="22346" class="Symbol">:</a> <a id="22348" class="Symbol">∀{</a><a id="22350" href="/Substitution/#22350" class="Bound">Γ</a> <a id="22352" href="/Substitution/#22352" class="Bound">Δ</a> <a id="22354" href="/Substitution/#22354" class="Bound">Σ</a><a id="22355" class="Symbol">}{</a><a id="22357" href="/Substitution/#22357" class="Bound">A</a><a id="22358" class="Symbol">}{</a><a id="22360" href="/Substitution/#22360" class="Bound">M</a> <a id="22362" class="Symbol">:</a> <a id="22364" href="/Substitution/#22350" class="Bound">Γ</a> <a id="22366" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="22368" href="/Substitution/#22357" class="Bound">A</a><a id="22369" class="Symbol">}</a> <a id="22371" class="Symbol">{</a><a id="22372" href="/Substitution/#22372" class="Bound">σ₁</a> <a id="22375" class="Symbol">:</a> <a id="22377" href="/Soundness/#2673" class="Function">Subst</a> <a id="22383" href="/Substitution/#22350" class="Bound">Γ</a> <a id="22385" href="/Substitution/#22352" class="Bound">Δ</a><a id="22386" class="Symbol">}{</a><a id="22388" href="/Substitution/#22388" class="Bound">σ₂</a> <a id="22391" class="Symbol">:</a> <a id="22393" href="/Soundness/#2673" class="Function">Subst</a> <a id="22399" href="/Substitution/#22352" class="Bound">Δ</a> <a id="22401" href="/Substitution/#22354" class="Bound">Σ</a><a id="22402" class="Symbol">}</a> 
            <a id="22417" class="Symbol">→</a> <a id="22419" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22421" href="/Substitution/#22388" class="Bound">σ₂</a> <a id="22424" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22426" class="Symbol">(</a><a id="22427" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22429" href="/Substitution/#22372" class="Bound">σ₁</a> <a id="22432" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22434" href="/Substitution/#22360" class="Bound">M</a><a id="22435" class="Symbol">)</a> <a id="22437" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="22439" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22441" href="/Substitution/#22372" class="Bound">σ₁</a> <a id="22444" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="22446" href="/Substitution/#22388" class="Bound">σ₂</a> <a id="22449" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22451" href="/Substitution/#22360" class="Bound">M</a>
<a id="22453" href="/Substitution/#22338" class="Function">sub-sub</a> <a id="22461" class="Symbol">{</a><a id="22462" class="Argument">M</a> <a id="22464" class="Symbol">=</a> <a id="22466" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="22468" href="/Substitution/#22468" class="Bound">x</a><a id="22469" class="Symbol">}</a> <a id="22471" class="Symbol">=</a> <a id="22473" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="22478" href="/Substitution/#22338" class="Function">sub-sub</a> <a id="22486" class="Symbol">{</a><a id="22487" href="/Substitution/#22487" class="Bound">Γ</a><a id="22488" class="Symbol">}{</a><a id="22490" href="/Substitution/#22490" class="Bound">Δ</a><a id="22491" class="Symbol">}{</a><a id="22493" href="/Substitution/#22493" class="Bound">Σ</a><a id="22494" class="Symbol">}{</a><a id="22496" href="/Substitution/#22496" class="Bound">A</a><a id="22497" class="Symbol">}{</a><a id="22499" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22501" href="/Substitution/#22501" class="Bound">N</a><a id="22502" class="Symbol">}{</a><a id="22504" href="/Substitution/#22504" class="Bound">σ₁</a><a id="22506" class="Symbol">}{</a><a id="22508" href="/Substitution/#22508" class="Bound">σ₂</a><a id="22510" class="Symbol">}</a> <a id="22512" class="Symbol">=</a>
   <a id="22517" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="22528" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22530" href="/Substitution/#22508" class="Bound">σ₂</a> <a id="22533" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22535" class="Symbol">(</a><a id="22536" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22538" href="/Substitution/#22504" class="Bound">σ₁</a> <a id="22541" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22543" class="Symbol">(</a><a id="22544" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22546" href="/Substitution/#22501" class="Bound">N</a><a id="22547" class="Symbol">))</a>
   <a id="22553" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="22562" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22564" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22566" href="/Untyped/#6623" class="Function">exts</a> <a id="22571" href="/Substitution/#22508" class="Bound">σ₂</a> <a id="22574" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22576" class="Symbol">(</a><a id="22577" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22579" href="/Untyped/#6623" class="Function">exts</a> <a id="22584" href="/Substitution/#22504" class="Bound">σ₁</a> <a id="22587" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22589" href="/Substitution/#22501" class="Bound">N</a><a id="22590" class="Symbol">)</a>
   <a id="22595" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="22598" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="22603" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="22606" class="Symbol">(</a><a id="22607" href="/Substitution/#22338" class="Function">sub-sub</a><a id="22614" class="Symbol">{</a><a id="22615" class="Argument">M</a> <a id="22617" class="Symbol">=</a> <a id="22619" href="/Substitution/#22501" class="Bound">N</a><a id="22620" class="Symbol">}{</a><a id="22622" class="Argument">σ₁</a> <a id="22625" class="Symbol">=</a> <a id="22627" href="/Untyped/#6623" class="Function">exts</a> <a id="22632" href="/Substitution/#22504" class="Bound">σ₁</a><a id="22634" class="Symbol">}{</a><a id="22636" class="Argument">σ₂</a> <a id="22639" class="Symbol">=</a> <a id="22641" href="/Untyped/#6623" class="Function">exts</a> <a id="22646" href="/Substitution/#22508" class="Bound">σ₂</a><a id="22648" class="Symbol">})</a> <a id="22651" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="22658" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22660" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22662" href="/Untyped/#6623" class="Function">exts</a> <a id="22667" href="/Substitution/#22504" class="Bound">σ₁</a> <a id="22670" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="22672" href="/Untyped/#6623" class="Function">exts</a> <a id="22677" href="/Substitution/#22508" class="Bound">σ₂</a> <a id="22680" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22682" href="/Substitution/#22501" class="Bound">N</a>
   <a id="22687" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="22690" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="22695" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="22698" class="Symbol">(</a><a id="22699" href="/Substitution/#10706" class="Function">cong-sub</a><a id="22707" class="Symbol">{</a><a id="22708" class="Argument">M</a> <a id="22710" class="Symbol">=</a> <a id="22712" href="/Substitution/#22501" class="Bound">N</a><a id="22713" class="Symbol">}</a> <a id="22715" class="Symbol">(λ</a> <a id="22718" class="Symbol">{</a><a id="22719" href="/Substitution/#22719" class="Bound">A</a><a id="22720" class="Symbol">}</a> <a id="22722" class="Symbol">→</a> <a id="22724" href="/Substitution/#21391" class="Function">exts-seq</a><a id="22732" class="Symbol">)</a> <a id="22734" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="22738" class="Symbol">)</a> <a id="22740" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="22747" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="22749" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="22751" href="/Untyped/#6623" class="Function">exts</a> <a id="22756" class="Symbol">(</a> <a id="22758" href="/Substitution/#22504" class="Bound">σ₁</a> <a id="22761" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="22763" href="/Substitution/#22508" class="Bound">σ₂</a><a id="22765" class="Symbol">)</a> <a id="22767" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="22769" href="/Substitution/#22501" class="Bound">N</a>
   <a id="22774" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="22776" href="/Substitution/#22338" class="Function">sub-sub</a> <a id="22784" class="Symbol">{</a><a id="22785" class="Argument">M</a> <a id="22787" class="Symbol">=</a> <a id="22789" href="/Substitution/#22789" class="Bound">L</a> <a id="22791" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="22793" href="/Substitution/#22793" class="Bound">M</a><a id="22794" class="Symbol">}</a> <a id="22796" class="Symbol">=</a> <a id="22798" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="22804" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="22808" class="Symbol">(</a><a id="22809" href="/Substitution/#22338" class="Function">sub-sub</a><a id="22816" class="Symbol">{</a><a id="22817" class="Argument">M</a> <a id="22819" class="Symbol">=</a> <a id="22821" href="/Substitution/#22789" class="Bound">L</a><a id="22822" class="Symbol">})</a> <a id="22825" class="Symbol">(</a><a id="22826" href="/Substitution/#22338" class="Function">sub-sub</a><a id="22833" class="Symbol">{</a><a id="22834" class="Argument">M</a> <a id="22836" class="Symbol">=</a> <a id="22838" href="/Substitution/#22793" class="Bound">M</a><a id="22839" class="Symbol">})</a></pre>

<p>We proceed by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M = x</code>, then both sides are equal to <code class="highlighter-rouge">σ₂ (σ₁ x)</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M = ƛ N</code>, we first use the induction hypothesis to show that</p>

    <p>ƛ ⧼ exts σ₂ ⧽ (⧼ exts σ₁ ⧽ N) ≡ ƛ ⧼ exts σ₁ ⨟ exts σ₂ ⧽ N</p>

    <p>and then use the lemma <code class="highlighter-rouge">exts-seq</code> to show</p>

    <p>ƛ ⧼ exts σ₁ ⨟ exts σ₂ ⧽ N ≡ ƛ ⧼ exts ( σ₁ ⨟ σ₂) ⧽ N</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we use the induction hypothesis
for both subterms.</p>
  </li>
</ul>

<p>The following corollary of <code class="highlighter-rouge">sub-sub</code> specializes the first
substitution to a renaming.</p>

<pre class="Agda"><a id="rename-subst"></a><a id="23372" href="/Substitution/#23372" class="Function">rename-subst</a> <a id="23385" class="Symbol">:</a> <a id="23387" class="Symbol">∀{</a><a id="23389" href="/Substitution/#23389" class="Bound">Γ</a> <a id="23391" href="/Substitution/#23391" class="Bound">Δ</a> <a id="23393" href="/Substitution/#23393" class="Bound">Δ&#39;</a><a id="23395" class="Symbol">}{</a><a id="23397" href="/Substitution/#23397" class="Bound">M</a> <a id="23399" class="Symbol">:</a> <a id="23401" href="/Substitution/#23389" class="Bound">Γ</a> <a id="23403" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="23405" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="23406" class="Symbol">}{</a><a id="23408" href="/Substitution/#23408" class="Bound">ρ</a> <a id="23410" class="Symbol">:</a> <a id="23412" href="/Denotational/#23286" class="Function">Rename</a> <a id="23419" href="/Substitution/#23389" class="Bound">Γ</a> <a id="23421" href="/Substitution/#23391" class="Bound">Δ</a><a id="23422" class="Symbol">}{</a><a id="23424" href="/Substitution/#23424" class="Bound">σ</a> <a id="23426" class="Symbol">:</a> <a id="23428" href="/Soundness/#2673" class="Function">Subst</a> <a id="23434" href="/Substitution/#23391" class="Bound">Δ</a> <a id="23436" href="/Substitution/#23393" class="Bound">Δ&#39;</a><a id="23438" class="Symbol">}</a>
             <a id="23453" class="Symbol">→</a> <a id="23455" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23457" href="/Substitution/#23424" class="Bound">σ</a> <a id="23459" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23461" class="Symbol">(</a><a id="23462" href="/Untyped/#6171" class="Function">rename</a> <a id="23469" href="/Substitution/#23408" class="Bound">ρ</a> <a id="23471" href="/Substitution/#23397" class="Bound">M</a><a id="23472" class="Symbol">)</a> <a id="23474" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23476" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23478" href="/Substitution/#23424" class="Bound">σ</a> <a id="23480" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="23482" href="/Substitution/#23408" class="Bound">ρ</a> <a id="23484" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23486" href="/Substitution/#23397" class="Bound">M</a>
<a id="23488" href="/Substitution/#23372" class="Function">rename-subst</a> <a id="23501" class="Symbol">{</a><a id="23502" href="/Substitution/#23502" class="Bound">Γ</a><a id="23503" class="Symbol">}{</a><a id="23505" href="/Substitution/#23505" class="Bound">Δ</a><a id="23506" class="Symbol">}{</a><a id="23508" href="/Substitution/#23508" class="Bound">Δ&#39;</a><a id="23510" class="Symbol">}{</a><a id="23512" href="/Substitution/#23512" class="Bound">M</a><a id="23513" class="Symbol">}{</a><a id="23515" href="/Substitution/#23515" class="Bound">ρ</a><a id="23516" class="Symbol">}{</a><a id="23518" href="/Substitution/#23518" class="Bound">σ</a><a id="23519" class="Symbol">}</a> <a id="23521" class="Symbol">=</a>
   <a id="23526" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="23537" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23539" href="/Substitution/#23518" class="Bound">σ</a> <a id="23541" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23543" class="Symbol">(</a><a id="23544" href="/Untyped/#6171" class="Function">rename</a> <a id="23551" href="/Substitution/#23515" class="Bound">ρ</a> <a id="23553" href="/Substitution/#23512" class="Bound">M</a><a id="23554" class="Symbol">)</a>
   <a id="23559" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23562" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="23567" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23569" href="/Substitution/#23518" class="Bound">σ</a> <a id="23571" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23573" class="Symbol">(</a><a id="23574" href="/Substitution/#13287" class="Function">rename-subst-ren</a><a id="23590" class="Symbol">{</a><a id="23591" class="Argument">M</a> <a id="23593" class="Symbol">=</a> <a id="23595" href="/Substitution/#23512" class="Bound">M</a><a id="23596" class="Symbol">})</a> <a id="23599" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="23606" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23608" href="/Substitution/#23518" class="Bound">σ</a> <a id="23610" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23612" class="Symbol">(</a><a id="23613" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23615" href="/Substitution/#6112" class="Function">ren</a> <a id="23619" href="/Substitution/#23515" class="Bound">ρ</a> <a id="23621" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23623" href="/Substitution/#23512" class="Bound">M</a><a id="23624" class="Symbol">)</a>
   <a id="23629" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23632" href="/Substitution/#22338" class="Function">sub-sub</a><a id="23639" class="Symbol">{</a><a id="23640" class="Argument">M</a> <a id="23642" class="Symbol">=</a> <a id="23644" href="/Substitution/#23512" class="Bound">M</a><a id="23645" class="Symbol">}</a> <a id="23647" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="23654" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23656" href="/Substitution/#6112" class="Function">ren</a> <a id="23660" href="/Substitution/#23515" class="Bound">ρ</a> <a id="23662" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="23664" href="/Substitution/#23518" class="Bound">σ</a> <a id="23666" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23668" href="/Substitution/#23512" class="Bound">M</a>
   <a id="23673" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="23682" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="23684" href="/Substitution/#23518" class="Bound">σ</a> <a id="23686" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">∘</a> <a id="23688" href="/Substitution/#23515" class="Bound">ρ</a> <a id="23690" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="23692" href="/Substitution/#23512" class="Bound">M</a>
   <a id="23697" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-assoc">Proof of sub-assoc</h2>

<p>The proof of <code class="highlighter-rouge">sub-assoc</code> follows directly from <code class="highlighter-rouge">sub-sub</code> and the
definition of sequencing.</p>

<pre class="Agda"><a id="sub-assoc"></a><a id="23840" href="/Substitution/#23840" class="Function">sub-assoc</a> <a id="23850" class="Symbol">:</a> <a id="23852" class="Symbol">∀{</a><a id="23854" href="/Substitution/#23854" class="Bound">Γ</a> <a id="23856" href="/Substitution/#23856" class="Bound">Δ</a> <a id="23858" href="/Substitution/#23858" class="Bound">Σ</a> <a id="23860" href="/Substitution/#23860" class="Bound">Ψ</a> <a id="23862" class="Symbol">:</a> <a id="23864" href="/Untyped/#2980" class="Datatype">Context</a><a id="23871" class="Symbol">}</a> <a id="23873" class="Symbol">{</a><a id="23874" href="/Substitution/#23874" class="Bound">σ</a> <a id="23876" class="Symbol">:</a> <a id="23878" href="/Soundness/#2673" class="Function">Subst</a> <a id="23884" href="/Substitution/#23854" class="Bound">Γ</a> <a id="23886" href="/Substitution/#23856" class="Bound">Δ</a><a id="23887" class="Symbol">}</a> <a id="23889" class="Symbol">{</a><a id="23890" href="/Substitution/#23890" class="Bound">τ</a> <a id="23892" class="Symbol">:</a> <a id="23894" href="/Soundness/#2673" class="Function">Subst</a> <a id="23900" href="/Substitution/#23856" class="Bound">Δ</a> <a id="23902" href="/Substitution/#23858" class="Bound">Σ</a><a id="23903" class="Symbol">}</a>
             <a id="23918" class="Symbol">{</a><a id="23919" href="/Substitution/#23919" class="Bound">θ</a> <a id="23921" class="Symbol">:</a> <a id="23923" href="/Soundness/#2673" class="Function">Subst</a> <a id="23929" href="/Substitution/#23858" class="Bound">Σ</a> <a id="23931" href="/Substitution/#23860" class="Bound">Ψ</a><a id="23932" class="Symbol">}</a>
          <a id="23944" class="Symbol">→</a> <a id="23946" class="Symbol">∀{</a><a id="23948" href="/Substitution/#23948" class="Bound">A</a><a id="23949" class="Symbol">}</a> <a id="23951" class="Symbol">→</a> <a id="23953" class="Symbol">(</a><a id="23954" href="/Substitution/#23874" class="Bound">σ</a> <a id="23956" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="23958" href="/Substitution/#23890" class="Bound">τ</a><a id="23959" class="Symbol">)</a> <a id="23961" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="23963" href="/Substitution/#23919" class="Bound">θ</a> <a id="23965" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23967" class="Symbol">(</a><a id="23968" href="/Substitution/#23874" class="Bound">σ</a> <a id="23970" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="23972" href="/Substitution/#23890" class="Bound">τ</a> <a id="23974" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="23976" href="/Substitution/#23919" class="Bound">θ</a><a id="23977" class="Symbol">)</a> <a id="23979" class="Symbol">{</a><a id="23980" href="/Substitution/#23948" class="Bound">A</a><a id="23981" class="Symbol">}</a>
<a id="23983" href="/Substitution/#23840" class="Function">sub-assoc</a> <a id="23993" class="Symbol">{</a><a id="23994" href="/Substitution/#23994" class="Bound">Γ</a><a id="23995" class="Symbol">}{</a><a id="23997" href="/Substitution/#23997" class="Bound">Δ</a><a id="23998" class="Symbol">}{</a><a id="24000" href="/Substitution/#24000" class="Bound">Σ</a><a id="24001" class="Symbol">}{</a><a id="24003" href="/Substitution/#24003" class="Bound">Ψ</a><a id="24004" class="Symbol">}{</a><a id="24006" href="/Substitution/#24006" class="Bound">σ</a><a id="24007" class="Symbol">}{</a><a id="24009" href="/Substitution/#24009" class="Bound">τ</a><a id="24010" class="Symbol">}{</a><a id="24012" href="/Substitution/#24012" class="Bound">θ</a><a id="24013" class="Symbol">}{</a><a id="24015" href="/Substitution/#24015" class="Bound">A</a><a id="24016" class="Symbol">}</a> <a id="24018" class="Symbol">=</a> <a id="24020" href="/Denotational/#3262" class="Postulate">extensionality</a> <a id="24035" class="Symbol">λ</a> <a id="24037" href="/Substitution/#24037" class="Bound">x</a> <a id="24039" class="Symbol">→</a> <a id="24041" href="/Substitution/#24064" class="Function">lemma</a><a id="24046" class="Symbol">{</a><a id="24047" class="Argument">x</a> <a id="24049" class="Symbol">=</a> <a id="24051" href="/Substitution/#24037" class="Bound">x</a><a id="24052" class="Symbol">}</a>
  <a id="24056" class="Keyword">where</a>
  <a id="24064" href="/Substitution/#24064" class="Function">lemma</a> <a id="24070" class="Symbol">:</a> <a id="24072" class="Symbol">∀</a> <a id="24074" class="Symbol">{</a><a id="24075" href="/Substitution/#24075" class="Bound">x</a> <a id="24077" class="Symbol">:</a> <a id="24079" href="/Substitution/#23994" class="Bound">Γ</a> <a id="24081" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="24083" href="/Substitution/#24015" class="Bound">A</a><a id="24084" class="Symbol">}</a> <a id="24086" class="Symbol">→</a> <a id="24088" class="Symbol">((</a><a id="24090" href="/Substitution/#24006" class="Bound">σ</a> <a id="24092" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24094" href="/Substitution/#24009" class="Bound">τ</a><a id="24095" class="Symbol">)</a> <a id="24097" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24099" href="/Substitution/#24012" class="Bound">θ</a><a id="24100" class="Symbol">)</a> <a id="24102" href="/Substitution/#24075" class="Bound">x</a> <a id="24104" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24106" class="Symbol">(</a><a id="24107" href="/Substitution/#24006" class="Bound">σ</a> <a id="24109" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24111" href="/Substitution/#24009" class="Bound">τ</a> <a id="24113" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24115" href="/Substitution/#24012" class="Bound">θ</a><a id="24116" class="Symbol">)</a> <a id="24118" href="/Substitution/#24075" class="Bound">x</a>
  <a id="24122" href="/Substitution/#24064" class="Function">lemma</a> <a id="24128" class="Symbol">{</a><a id="24129" href="/Substitution/#24129" class="Bound">x</a><a id="24130" class="Symbol">}</a> <a id="24132" class="Symbol">=</a>
      <a id="24140" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="24154" class="Symbol">((</a><a id="24156" href="/Substitution/#24006" class="Bound">σ</a> <a id="24158" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24160" href="/Substitution/#24009" class="Bound">τ</a><a id="24161" class="Symbol">)</a> <a id="24163" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24165" href="/Substitution/#24012" class="Bound">θ</a><a id="24166" class="Symbol">)</a> <a id="24168" href="/Substitution/#24129" class="Bound">x</a>
      <a id="24176" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="24188" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24190" href="/Substitution/#24012" class="Bound">θ</a> <a id="24192" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24194" class="Symbol">(</a><a id="24195" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24197" href="/Substitution/#24009" class="Bound">τ</a> <a id="24199" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24201" class="Symbol">(</a><a id="24202" href="/Substitution/#24006" class="Bound">σ</a> <a id="24204" href="/Substitution/#24129" class="Bound">x</a><a id="24205" class="Symbol">))</a>
      <a id="24214" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24217" href="/Substitution/#22338" class="Function">sub-sub</a><a id="24224" class="Symbol">{</a><a id="24225" class="Argument">M</a> <a id="24227" class="Symbol">=</a> <a id="24229" href="/Substitution/#24006" class="Bound">σ</a> <a id="24231" href="/Substitution/#24129" class="Bound">x</a><a id="24232" class="Symbol">}</a> <a id="24234" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="24244" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24246" href="/Substitution/#24009" class="Bound">τ</a> <a id="24248" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24250" href="/Substitution/#24012" class="Bound">θ</a> <a id="24252" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24254" class="Symbol">(</a><a id="24255" href="/Substitution/#24006" class="Bound">σ</a> <a id="24257" href="/Substitution/#24129" class="Bound">x</a><a id="24258" class="Symbol">)</a>
      <a id="24266" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="24278" class="Symbol">(</a><a id="24279" href="/Substitution/#24006" class="Bound">σ</a> <a id="24281" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24283" href="/Substitution/#24009" class="Bound">τ</a> <a id="24285" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="24287" href="/Substitution/#24012" class="Bound">θ</a><a id="24288" class="Symbol">)</a> <a id="24290" href="/Substitution/#24129" class="Bound">x</a>
      <a id="24298" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-the-substitution-lemma">Proof of the substitution lemma</h2>

<p>We first prove the generalized form of the substitution lemma, showing
that a substitution <code class="highlighter-rouge">σ</code> commutes with the subusitution of <code class="highlighter-rouge">M</code> into
<code class="highlighter-rouge">N</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⧼ exts σ ⧽ N [ ⧼ σ ⧽ M ] ≡ ⧼ σ ⧽ (N [ M ])
</code></pre></div></div>

<p>This proof is where the σ algebra pays off.  The proof is by direct
equational reasoning. Starting with the left-hand side, we apply σ
algebra equations, oriented left-to-right, until we arive at the
normal form</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⧼ ⧼ σ ⧽ M • σ ⧽ N
</code></pre></div></div>

<p>We then do the same with the right-hand side, arriving at the same
normal form.</p>

<pre class="Agda"><a id="subst-commute"></a><a id="24872" href="/Substitution/#24872" class="Function">subst-commute</a> <a id="24886" class="Symbol">:</a> <a id="24888" class="Symbol">∀{</a><a id="24890" href="/Substitution/#24890" class="Bound">Γ</a> <a id="24892" href="/Substitution/#24892" class="Bound">Δ</a><a id="24893" class="Symbol">}{</a><a id="24895" href="/Substitution/#24895" class="Bound">N</a> <a id="24897" class="Symbol">:</a> <a id="24899" href="/Substitution/#24890" class="Bound">Γ</a> <a id="24901" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="24903" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="24905" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="24907" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="24908" class="Symbol">}{</a><a id="24910" href="/Substitution/#24910" class="Bound">M</a> <a id="24912" class="Symbol">:</a> <a id="24914" href="/Substitution/#24890" class="Bound">Γ</a> <a id="24916" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="24918" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="24919" class="Symbol">}{</a><a id="24921" href="/Substitution/#24921" class="Bound">σ</a> <a id="24923" class="Symbol">:</a> <a id="24925" href="/Soundness/#2673" class="Function">Subst</a> <a id="24931" href="/Substitution/#24890" class="Bound">Γ</a> <a id="24933" href="/Substitution/#24892" class="Bound">Δ</a> <a id="24935" class="Symbol">}</a>
    <a id="24941" class="Symbol">→</a> <a id="24943" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24945" href="/Untyped/#6623" class="Function">exts</a> <a id="24950" href="/Substitution/#24921" class="Bound">σ</a> <a id="24952" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24954" href="/Substitution/#24895" class="Bound">N</a> <a id="24956" href="/Untyped/#7475" class="Function Operator">[</a> <a id="24958" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24960" href="/Substitution/#24921" class="Bound">σ</a> <a id="24962" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24964" href="/Substitution/#24910" class="Bound">M</a> <a id="24966" href="/Untyped/#7475" class="Function Operator">]</a> <a id="24968" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24970" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="24972" href="/Substitution/#24921" class="Bound">σ</a> <a id="24974" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="24976" class="Symbol">(</a><a id="24977" href="/Substitution/#24895" class="Bound">N</a> <a id="24979" href="/Untyped/#7475" class="Function Operator">[</a> <a id="24981" href="/Substitution/#24910" class="Bound">M</a> <a id="24983" href="/Untyped/#7475" class="Function Operator">]</a><a id="24984" class="Symbol">)</a>
<a id="24986" href="/Substitution/#24872" class="Function">subst-commute</a> <a id="25000" class="Symbol">{</a><a id="25001" href="/Substitution/#25001" class="Bound">Γ</a><a id="25002" class="Symbol">}{</a><a id="25004" href="/Substitution/#25004" class="Bound">Δ</a><a id="25005" class="Symbol">}{</a><a id="25007" href="/Substitution/#25007" class="Bound">N</a><a id="25008" class="Symbol">}{</a><a id="25010" href="/Substitution/#25010" class="Bound">M</a><a id="25011" class="Symbol">}{</a><a id="25013" href="/Substitution/#25013" class="Bound">σ</a><a id="25014" class="Symbol">}</a> <a id="25016" class="Symbol">=</a>
     <a id="25023" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="25036" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25038" href="/Untyped/#6623" class="Function">exts</a> <a id="25043" href="/Substitution/#25013" class="Bound">σ</a> <a id="25045" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25047" href="/Substitution/#25007" class="Bound">N</a> <a id="25049" href="/Untyped/#7475" class="Function Operator">[</a> <a id="25051" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25053" href="/Substitution/#25013" class="Bound">σ</a> <a id="25055" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25057" href="/Substitution/#25010" class="Bound">M</a> <a id="25059" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="25066" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="25077" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25079" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="25090" class="Symbol">(</a><a id="25091" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25093" href="/Substitution/#25013" class="Bound">σ</a> <a id="25095" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25097" href="/Substitution/#25010" class="Bound">M</a><a id="25098" class="Symbol">)</a> <a id="25100" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25102" class="Symbol">(</a><a id="25103" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25105" href="/Untyped/#6623" class="Function">exts</a> <a id="25110" href="/Substitution/#25013" class="Bound">σ</a> <a id="25112" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25114" href="/Substitution/#25007" class="Bound">N</a><a id="25115" class="Symbol">)</a>
     <a id="25122" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25125" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="25134" class="Symbol">{</a><a id="25135" class="Argument">M</a> <a id="25137" class="Symbol">=</a> <a id="25139" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25141" href="/Untyped/#6623" class="Function">exts</a> <a id="25146" href="/Substitution/#25013" class="Bound">σ</a> <a id="25148" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25150" href="/Substitution/#25007" class="Bound">N</a><a id="25151" class="Symbol">}</a> <a id="25153" href="/Substitution/#15513" class="Function">subst-Z-cons-ids</a> <a id="25170" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25175" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25184" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25186" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25188" href="/Substitution/#25013" class="Bound">σ</a> <a id="25190" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25192" href="/Substitution/#25010" class="Bound">M</a> <a id="25194" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25196" href="/Substitution/#2589" class="Function">ids</a> <a id="25200" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25202" class="Symbol">(</a><a id="25203" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25205" href="/Untyped/#6623" class="Function">exts</a> <a id="25210" href="/Substitution/#25013" class="Bound">σ</a> <a id="25212" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25214" href="/Substitution/#25007" class="Bound">N</a><a id="25215" class="Symbol">)</a>
     <a id="25222" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25225" href="/Substitution/#22338" class="Function">sub-sub</a> <a id="25233" class="Symbol">{</a><a id="25234" class="Argument">M</a> <a id="25236" class="Symbol">=</a> <a id="25238" href="/Substitution/#25007" class="Bound">N</a><a id="25239" class="Symbol">}</a> <a id="25241" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25250" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25252" class="Symbol">(</a><a id="25253" href="/Untyped/#6623" class="Function">exts</a> <a id="25258" href="/Substitution/#25013" class="Bound">σ</a><a id="25259" class="Symbol">)</a> <a id="25261" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25263" class="Symbol">((</a><a id="25265" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25267" href="/Substitution/#25013" class="Bound">σ</a> <a id="25269" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25271" href="/Substitution/#25010" class="Bound">M</a><a id="25272" class="Symbol">)</a> <a id="25274" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25276" href="/Substitution/#2589" class="Function">ids</a><a id="25279" class="Symbol">)</a> <a id="25281" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25283" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25290" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25293" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="25302" class="Symbol">{</a><a id="25303" class="Argument">M</a> <a id="25305" class="Symbol">=</a> <a id="25307" href="/Substitution/#25007" class="Bound">N</a><a id="25308" class="Symbol">}</a> <a id="25310" class="Symbol">(</a><a id="25311" href="/Substitution/#11839" class="Function">cong-seq</a> <a id="25320" href="/Substitution/#14699" class="Function">exts-cons-shift</a> <a id="25336" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="25340" class="Symbol">)</a> <a id="25342" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25347" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25356" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25358" class="Symbol">(</a><a id="25359" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="25361" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="25363" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25365" class="Symbol">(</a><a id="25366" href="/Substitution/#25013" class="Bound">σ</a> <a id="25368" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25370" href="/Substitution/#2744" class="Function">↑</a><a id="25371" class="Symbol">))</a> <a id="25374" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25376" class="Symbol">(</a><a id="25377" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25379" href="/Substitution/#25013" class="Bound">σ</a> <a id="25381" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25383" href="/Substitution/#25010" class="Bound">M</a> <a id="25385" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25387" href="/Substitution/#2589" class="Function">ids</a><a id="25390" class="Symbol">)</a> <a id="25392" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25394" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25401" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25404" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="25413" class="Symbol">{</a><a id="25414" class="Argument">M</a> <a id="25416" class="Symbol">=</a> <a id="25418" href="/Substitution/#25007" class="Bound">N</a><a id="25419" class="Symbol">}</a> <a id="25421" class="Symbol">(</a><a id="25422" href="/Substitution/#8520" class="Function">sub-dist</a> <a id="25431" class="Symbol">{</a><a id="25432" class="Argument">M</a> <a id="25434" class="Symbol">=</a> <a id="25436" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="25438" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="25439" class="Symbol">})</a> <a id="25442" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25447" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25456" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25458" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25460" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25462" href="/Substitution/#25013" class="Bound">σ</a> <a id="25464" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25466" href="/Substitution/#25010" class="Bound">M</a> <a id="25468" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25470" href="/Substitution/#2589" class="Function">ids</a> <a id="25474" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25476" class="Symbol">(</a><a id="25477" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="25479" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="25480" class="Symbol">)</a> <a id="25482" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25484" class="Symbol">((</a><a id="25486" href="/Substitution/#25013" class="Bound">σ</a> <a id="25488" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25490" href="/Substitution/#2744" class="Function">↑</a><a id="25491" class="Symbol">)</a> <a id="25493" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25495" class="Symbol">(</a><a id="25496" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25498" href="/Substitution/#25013" class="Bound">σ</a> <a id="25500" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25502" href="/Substitution/#25010" class="Bound">M</a> <a id="25504" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25506" href="/Substitution/#2589" class="Function">ids</a><a id="25509" class="Symbol">))</a> <a id="25512" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25514" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25521" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="25532" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25534" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25536" href="/Substitution/#25013" class="Bound">σ</a> <a id="25538" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25540" href="/Substitution/#25010" class="Bound">M</a> <a id="25542" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25544" class="Symbol">((</a><a id="25546" href="/Substitution/#25013" class="Bound">σ</a> <a id="25548" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25550" href="/Substitution/#2744" class="Function">↑</a><a id="25551" class="Symbol">)</a> <a id="25553" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25555" class="Symbol">(</a><a id="25556" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25558" href="/Substitution/#25013" class="Bound">σ</a> <a id="25560" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25562" href="/Substitution/#25010" class="Bound">M</a> <a id="25564" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25566" href="/Substitution/#2589" class="Function">ids</a><a id="25569" class="Symbol">))</a> <a id="25572" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25574" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25581" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25584" href="/Substitution/#10706" class="Function">cong-sub</a><a id="25592" class="Symbol">{</a><a id="25593" class="Argument">M</a> <a id="25595" class="Symbol">=</a> <a id="25597" href="/Substitution/#25007" class="Bound">N</a><a id="25598" class="Symbol">}</a> <a id="25600" class="Symbol">(</a><a id="25601" href="/Substitution/#11478" class="Function">cong-cons</a> <a id="25611" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25616" class="Symbol">(</a><a id="25617" href="/Substitution/#23840" class="Function">sub-assoc</a><a id="25626" class="Symbol">{</a><a id="25627" class="Argument">σ</a> <a id="25629" class="Symbol">=</a> <a id="25631" href="/Substitution/#25013" class="Bound">σ</a><a id="25632" class="Symbol">}))</a> <a id="25636" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25641" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25650" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25652" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25654" href="/Substitution/#25013" class="Bound">σ</a> <a id="25656" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25658" href="/Substitution/#25010" class="Bound">M</a> <a id="25660" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25662" class="Symbol">(</a><a id="25663" href="/Substitution/#25013" class="Bound">σ</a> <a id="25665" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25667" href="/Substitution/#2744" class="Function">↑</a> <a id="25669" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25671" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25673" href="/Substitution/#25013" class="Bound">σ</a> <a id="25675" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25677" href="/Substitution/#25010" class="Bound">M</a> <a id="25679" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25681" href="/Substitution/#2589" class="Function">ids</a><a id="25684" class="Symbol">)</a> <a id="25686" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25688" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25695" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25698" href="/Substitution/#10706" class="Function">cong-sub</a><a id="25706" class="Symbol">{</a><a id="25707" class="Argument">M</a> <a id="25709" class="Symbol">=</a> <a id="25711" href="/Substitution/#25007" class="Bound">N</a><a id="25712" class="Symbol">}</a> <a id="25714" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25719" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25724" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25733" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25735" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25737" href="/Substitution/#25013" class="Bound">σ</a> <a id="25739" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25741" href="/Substitution/#25010" class="Bound">M</a> <a id="25743" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25745" class="Symbol">(</a><a id="25746" href="/Substitution/#25013" class="Bound">σ</a> <a id="25748" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25750" href="/Substitution/#2589" class="Function">ids</a><a id="25753" class="Symbol">)</a> <a id="25755" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25757" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25764" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25767" href="/Substitution/#10706" class="Function">cong-sub</a><a id="25775" class="Symbol">{</a><a id="25776" class="Argument">M</a> <a id="25778" class="Symbol">=</a> <a id="25780" href="/Substitution/#25007" class="Bound">N</a><a id="25781" class="Symbol">}</a> <a id="25783" class="Symbol">(</a><a id="25784" href="/Substitution/#11478" class="Function">cong-cons</a> <a id="25794" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25799" class="Symbol">(</a><a id="25800" href="/Substitution/#17143" class="Function">sub-idR</a><a id="25807" class="Symbol">{</a><a id="25808" class="Argument">σ</a> <a id="25810" class="Symbol">=</a> <a id="25812" href="/Substitution/#25013" class="Bound">σ</a><a id="25813" class="Symbol">}))</a> <a id="25817" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25822" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25831" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25833" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25835" href="/Substitution/#25013" class="Bound">σ</a> <a id="25837" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25839" href="/Substitution/#25010" class="Bound">M</a> <a id="25841" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25843" href="/Substitution/#25013" class="Bound">σ</a> <a id="25845" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25847" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25854" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25857" href="/Substitution/#10706" class="Function">cong-sub</a><a id="25865" class="Symbol">{</a><a id="25866" class="Argument">M</a> <a id="25868" class="Symbol">=</a> <a id="25870" href="/Substitution/#25007" class="Bound">N</a><a id="25871" class="Symbol">}</a> <a id="25873" class="Symbol">(</a><a id="25874" href="/Substitution/#11478" class="Function">cong-cons</a> <a id="25884" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25889" class="Symbol">(</a><a id="25890" href="/Substitution/#8397" class="Function">sub-idL</a><a id="25897" class="Symbol">{</a><a id="25898" class="Argument">σ</a> <a id="25900" class="Symbol">=</a> <a id="25902" href="/Substitution/#25013" class="Bound">σ</a><a id="25903" class="Symbol">}))</a> <a id="25907" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25912" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="25921" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25923" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="25925" href="/Substitution/#25013" class="Bound">σ</a> <a id="25927" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25929" href="/Substitution/#25010" class="Bound">M</a> <a id="25931" href="/Substitution/#3002" class="Function Operator">•</a> <a id="25933" class="Symbol">(</a><a id="25934" href="/Substitution/#2589" class="Function">ids</a> <a id="25938" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="25940" href="/Substitution/#25013" class="Bound">σ</a><a id="25941" class="Symbol">)</a> <a id="25943" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="25945" href="/Substitution/#25007" class="Bound">N</a>
     <a id="25952" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25955" href="/Substitution/#10706" class="Function">cong-sub</a><a id="25963" class="Symbol">{</a><a id="25964" class="Argument">M</a> <a id="25966" class="Symbol">=</a> <a id="25968" href="/Substitution/#25007" class="Bound">N</a><a id="25969" class="Symbol">}</a> <a id="25971" class="Symbol">(</a><a id="25972" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="25976" href="/Substitution/#8520" class="Function">sub-dist</a><a id="25984" class="Symbol">)</a> <a id="25986" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="25991" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26000" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26002" href="/Substitution/#25010" class="Bound">M</a> <a id="26004" href="/Substitution/#3002" class="Function Operator">•</a> <a id="26006" href="/Substitution/#2589" class="Function">ids</a> <a id="26010" href="/Substitution/#3355" class="Function Operator">⨟</a> <a id="26012" href="/Substitution/#25013" class="Bound">σ</a> <a id="26014" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26016" href="/Substitution/#25007" class="Bound">N</a>
     <a id="26023" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26026" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="26030" class="Symbol">(</a><a id="26031" href="/Substitution/#22338" class="Function">sub-sub</a><a id="26038" class="Symbol">{</a><a id="26039" class="Argument">M</a> <a id="26041" class="Symbol">=</a> <a id="26043" href="/Substitution/#25007" class="Bound">N</a><a id="26044" class="Symbol">})</a> <a id="26047" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26056" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26058" href="/Substitution/#25013" class="Bound">σ</a> <a id="26060" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26062" class="Symbol">(</a><a id="26063" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26065" href="/Substitution/#25010" class="Bound">M</a> <a id="26067" href="/Substitution/#3002" class="Function Operator">•</a> <a id="26069" href="/Substitution/#2589" class="Function">ids</a> <a id="26073" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26075" href="/Substitution/#25007" class="Bound">N</a><a id="26076" class="Symbol">)</a>
     <a id="26083" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26086" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="26091" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26093" href="/Substitution/#25013" class="Bound">σ</a> <a id="26095" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26097" class="Symbol">(</a><a id="26098" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="26102" class="Symbol">(</a><a id="26103" href="/Substitution/#10706" class="Function">cong-sub</a><a id="26111" class="Symbol">{</a><a id="26112" class="Argument">M</a> <a id="26114" class="Symbol">=</a> <a id="26116" href="/Substitution/#25007" class="Bound">N</a><a id="26117" class="Symbol">}</a> <a id="26119" href="/Substitution/#15513" class="Function">subst-Z-cons-ids</a> <a id="26136" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="26140" class="Symbol">))</a> <a id="26143" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26152" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26154" href="/Substitution/#25013" class="Bound">σ</a> <a id="26156" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26158" class="Symbol">(</a><a id="26159" href="/Substitution/#25007" class="Bound">N</a> <a id="26161" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26163" href="/Substitution/#25010" class="Bound">M</a> <a id="26165" href="/Untyped/#7475" class="Function Operator">]</a><a id="26166" class="Symbol">)</a>
     <a id="26173" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>A corollary of <code class="highlighter-rouge">subst-commute</code> is that <code class="highlighter-rouge">rename</code> also commutes with
substitution. In the proof below, we first exchange <code class="highlighter-rouge">rename ρ</code> for
the substitution <code class="highlighter-rouge">⧼ ren ρ ⧽</code>, and apply <code class="highlighter-rouge">subst-commute</code>, and
then convert back to <code class="highlighter-rouge">rename ρ</code>.</p>

<pre class="Agda"><a id="rename-subst-commute"></a><a id="26429" href="/Substitution/#26429" class="Function">rename-subst-commute</a> <a id="26450" class="Symbol">:</a> <a id="26452" class="Symbol">∀{</a><a id="26454" href="/Substitution/#26454" class="Bound">Γ</a> <a id="26456" href="/Substitution/#26456" class="Bound">Δ</a><a id="26457" class="Symbol">}{</a><a id="26459" href="/Substitution/#26459" class="Bound">N</a> <a id="26461" class="Symbol">:</a> <a id="26463" href="/Substitution/#26454" class="Bound">Γ</a> <a id="26465" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="26467" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="26469" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="26471" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="26472" class="Symbol">}{</a><a id="26474" href="/Substitution/#26474" class="Bound">M</a> <a id="26476" class="Symbol">:</a> <a id="26478" href="/Substitution/#26454" class="Bound">Γ</a> <a id="26480" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="26482" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="26483" class="Symbol">}{</a><a id="26485" href="/Substitution/#26485" class="Bound">ρ</a> <a id="26487" class="Symbol">:</a> <a id="26489" href="/Denotational/#23286" class="Function">Rename</a> <a id="26496" href="/Substitution/#26454" class="Bound">Γ</a> <a id="26498" href="/Substitution/#26456" class="Bound">Δ</a> <a id="26500" class="Symbol">}</a>
    <a id="26506" class="Symbol">→</a> <a id="26508" class="Symbol">(</a><a id="26509" href="/Untyped/#6171" class="Function">rename</a> <a id="26516" class="Symbol">(</a><a id="26517" href="/Untyped/#5845" class="Function">ext</a> <a id="26521" href="/Substitution/#26485" class="Bound">ρ</a><a id="26522" class="Symbol">)</a> <a id="26524" href="/Substitution/#26459" class="Bound">N</a><a id="26525" class="Symbol">)</a> <a id="26527" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26529" href="/Untyped/#6171" class="Function">rename</a> <a id="26536" href="/Substitution/#26485" class="Bound">ρ</a> <a id="26538" href="/Substitution/#26474" class="Bound">M</a> <a id="26540" href="/Untyped/#7475" class="Function Operator">]</a> <a id="26542" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="26544" href="/Untyped/#6171" class="Function">rename</a> <a id="26551" href="/Substitution/#26485" class="Bound">ρ</a> <a id="26553" class="Symbol">(</a><a id="26554" href="/Substitution/#26459" class="Bound">N</a> <a id="26556" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26558" href="/Substitution/#26474" class="Bound">M</a> <a id="26560" href="/Untyped/#7475" class="Function Operator">]</a><a id="26561" class="Symbol">)</a>
<a id="26563" href="/Substitution/#26429" class="Function">rename-subst-commute</a> <a id="26584" class="Symbol">{</a><a id="26585" href="/Substitution/#26585" class="Bound">Γ</a><a id="26586" class="Symbol">}{</a><a id="26588" href="/Substitution/#26588" class="Bound">Δ</a><a id="26589" class="Symbol">}{</a><a id="26591" href="/Substitution/#26591" class="Bound">N</a><a id="26592" class="Symbol">}{</a><a id="26594" href="/Substitution/#26594" class="Bound">M</a><a id="26595" class="Symbol">}{</a><a id="26597" href="/Substitution/#26597" class="Bound">ρ</a><a id="26598" class="Symbol">}</a> <a id="26600" class="Symbol">=</a>
     <a id="26607" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="26620" class="Symbol">(</a><a id="26621" href="/Untyped/#6171" class="Function">rename</a> <a id="26628" class="Symbol">(</a><a id="26629" href="/Untyped/#5845" class="Function">ext</a> <a id="26633" href="/Substitution/#26597" class="Bound">ρ</a><a id="26634" class="Symbol">)</a> <a id="26636" href="/Substitution/#26591" class="Bound">N</a><a id="26637" class="Symbol">)</a> <a id="26639" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26641" href="/Untyped/#6171" class="Function">rename</a> <a id="26648" href="/Substitution/#26597" class="Bound">ρ</a> <a id="26650" href="/Substitution/#26594" class="Bound">M</a> <a id="26652" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="26659" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26662" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="26671" class="Symbol">(</a><a id="26672" href="/Substitution/#11211" class="Function">cong-sub-zero</a> <a id="26686" class="Symbol">(</a><a id="26687" href="/Substitution/#13287" class="Function">rename-subst-ren</a><a id="26703" class="Symbol">{</a><a id="26704" class="Argument">M</a> <a id="26706" class="Symbol">=</a> <a id="26708" href="/Substitution/#26594" class="Bound">M</a><a id="26709" class="Symbol">}))</a>
                 <a id="26730" class="Symbol">(</a><a id="26731" href="/Substitution/#13287" class="Function">rename-subst-ren</a><a id="26747" class="Symbol">{</a><a id="26748" class="Argument">M</a> <a id="26750" class="Symbol">=</a> <a id="26752" href="/Substitution/#26591" class="Bound">N</a><a id="26753" class="Symbol">})</a> <a id="26756" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26765" class="Symbol">(</a><a id="26766" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26768" href="/Substitution/#6112" class="Function">ren</a> <a id="26772" class="Symbol">(</a><a id="26773" href="/Untyped/#5845" class="Function">ext</a> <a id="26777" href="/Substitution/#26597" class="Bound">ρ</a><a id="26778" class="Symbol">)</a> <a id="26780" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26782" href="/Substitution/#26591" class="Bound">N</a><a id="26783" class="Symbol">)</a> <a id="26785" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26787" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26789" href="/Substitution/#6112" class="Function">ren</a> <a id="26793" href="/Substitution/#26597" class="Bound">ρ</a> <a id="26795" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26797" href="/Substitution/#26594" class="Bound">M</a> <a id="26799" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="26806" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26809" href="/Substitution/#10706" class="Function">cong-sub</a> <a id="26818" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26823" class="Symbol">(</a><a id="26824" href="/Substitution/#10706" class="Function">cong-sub</a><a id="26832" class="Symbol">{</a><a id="26833" class="Argument">M</a> <a id="26835" class="Symbol">=</a> <a id="26837" href="/Substitution/#26591" class="Bound">N</a><a id="26838" class="Symbol">}</a> <a id="26840" href="/Substitution/#12902" class="Function">ren-ext</a> <a id="26848" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="26852" class="Symbol">)</a> <a id="26854" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26863" class="Symbol">(</a><a id="26864" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26866" href="/Untyped/#6623" class="Function">exts</a> <a id="26871" class="Symbol">(</a><a id="26872" href="/Substitution/#6112" class="Function">ren</a> <a id="26876" href="/Substitution/#26597" class="Bound">ρ</a><a id="26877" class="Symbol">)</a> <a id="26879" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26881" href="/Substitution/#26591" class="Bound">N</a><a id="26882" class="Symbol">)</a> <a id="26884" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26886" href="/Substitution/#2074" class="Function Operator">⧼</a> <a id="26888" href="/Substitution/#6112" class="Function">ren</a> <a id="26892" href="/Substitution/#26597" class="Bound">ρ</a> <a id="26894" href="/Substitution/#2074" class="Function Operator">⧽</a> <a id="26896" href="/Substitution/#26594" class="Bound">M</a> <a id="26898" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="26905" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26908" href="/Substitution/#24872" class="Function">subst-commute</a><a id="26921" class="Symbol">{</a><a id="26922" class="Argument">N</a> <a id="26924" class="Symbol">=</a> <a id="26926" href="/Substitution/#26591" class="Bound">N</a><a id="26927" class="Symbol">}</a> <a id="26929" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="26938" href="/Untyped/#6931" class="Function">subst</a> <a id="26944" class="Symbol">(</a><a id="26945" href="/Substitution/#6112" class="Function">ren</a> <a id="26949" href="/Substitution/#26597" class="Bound">ρ</a><a id="26950" class="Symbol">)</a> <a id="26952" class="Symbol">(</a><a id="26953" href="/Substitution/#26591" class="Bound">N</a> <a id="26955" href="/Untyped/#7475" class="Function Operator">[</a> <a id="26957" href="/Substitution/#26594" class="Bound">M</a> <a id="26959" href="/Untyped/#7475" class="Function Operator">]</a><a id="26960" class="Symbol">)</a>
     <a id="26967" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26970" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="26974" class="Symbol">(</a><a id="26975" href="/Substitution/#13287" class="Function">rename-subst-ren</a><a id="26991" class="Symbol">)</a> <a id="26993" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27002" href="/Untyped/#6171" class="Function">rename</a> <a id="27009" href="/Substitution/#26597" class="Bound">ρ</a> <a id="27011" class="Symbol">(</a><a id="27012" href="/Substitution/#26591" class="Bound">N</a> <a id="27014" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27016" href="/Substitution/#26594" class="Bound">M</a> <a id="27018" href="/Untyped/#7475" class="Function Operator">]</a><a id="27019" class="Symbol">)</a>
     <a id="27026" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>To present the substitution lemma, we introduce the following notation
for substituting a term <code class="highlighter-rouge">M</code> for index 1 within term <code class="highlighter-rouge">N</code>.</p>

<pre class="Agda"><a id="_〔_〕"></a><a id="27182" href="/Substitution/#27182" class="Function Operator">_〔_〕</a> <a id="27187" class="Symbol">:</a> <a id="27189" class="Symbol">∀</a> <a id="27191" class="Symbol">{</a><a id="27192" href="/Substitution/#27192" class="Bound">Γ</a> <a id="27194" href="/Substitution/#27194" class="Bound">A</a> <a id="27196" href="/Substitution/#27196" class="Bound">B</a> <a id="27198" href="/Substitution/#27198" class="Bound">C</a><a id="27199" class="Symbol">}</a>
        <a id="27209" class="Symbol">→</a> <a id="27211" href="/Substitution/#27192" class="Bound">Γ</a> <a id="27213" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27215" href="/Substitution/#27196" class="Bound">B</a> <a id="27217" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27219" href="/Substitution/#27198" class="Bound">C</a> <a id="27221" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27223" href="/Substitution/#27194" class="Bound">A</a>
        <a id="27233" class="Symbol">→</a> <a id="27235" href="/Substitution/#27192" class="Bound">Γ</a> <a id="27237" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27239" href="/Substitution/#27196" class="Bound">B</a>
          <a id="27251" class="Comment">---------</a>
        <a id="27269" class="Symbol">→</a> <a id="27271" href="/Substitution/#27192" class="Bound">Γ</a> <a id="27273" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27275" href="/Substitution/#27198" class="Bound">C</a> <a id="27277" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27279" href="/Substitution/#27194" class="Bound">A</a>
<a id="27281" href="/Substitution/#27182" class="Function Operator">_〔_〕</a> <a id="27286" class="Symbol">{</a><a id="27287" href="/Substitution/#27287" class="Bound">Γ</a><a id="27288" class="Symbol">}</a> <a id="27290" class="Symbol">{</a><a id="27291" href="/Substitution/#27291" class="Bound">A</a><a id="27292" class="Symbol">}</a> <a id="27294" class="Symbol">{</a><a id="27295" href="/Substitution/#27295" class="Bound">B</a><a id="27296" class="Symbol">}</a> <a id="27298" class="Symbol">{</a><a id="27299" href="/Substitution/#27299" class="Bound">C</a><a id="27300" class="Symbol">}</a> <a id="27302" href="/Substitution/#27302" class="Bound">N</a> <a id="27304" href="/Substitution/#27304" class="Bound">M</a> <a id="27306" class="Symbol">=</a>
   <a id="27311" href="/Untyped/#6931" class="Function">subst</a> <a id="27317" class="Symbol">{</a><a id="27318" href="/Substitution/#27287" class="Bound">Γ</a> <a id="27320" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27322" href="/Substitution/#27295" class="Bound">B</a> <a id="27324" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27326" href="/Substitution/#27299" class="Bound">C</a><a id="27327" class="Symbol">}</a> <a id="27329" class="Symbol">{</a><a id="27330" href="/Substitution/#27287" class="Bound">Γ</a> <a id="27332" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27334" href="/Substitution/#27299" class="Bound">C</a><a id="27335" class="Symbol">}</a> <a id="27337" class="Symbol">(</a><a id="27338" href="/Untyped/#6623" class="Function">exts</a> <a id="27343" class="Symbol">(</a><a id="27344" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="27355" href="/Substitution/#27304" class="Bound">M</a><a id="27356" class="Symbol">))</a> <a id="27359" class="Symbol">{</a><a id="27360" href="/Substitution/#27291" class="Bound">A</a><a id="27361" class="Symbol">}</a> <a id="27363" href="/Substitution/#27302" class="Bound">N</a></pre>

<p>The substitution lemma is stated as follows and proved as a corollary
of the <code class="highlighter-rouge">subst-commute</code> lemma.</p>

<pre class="Agda"><a id="substitution"></a><a id="27491" href="/Substitution/#27491" class="Function">substitution</a> <a id="27504" class="Symbol">:</a> <a id="27506" class="Symbol">∀{</a><a id="27508" href="/Substitution/#27508" class="Bound">Γ</a><a id="27509" class="Symbol">}{</a><a id="27511" href="/Substitution/#27511" class="Bound">M</a> <a id="27513" class="Symbol">:</a> <a id="27515" href="/Substitution/#27508" class="Bound">Γ</a> <a id="27517" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27519" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27521" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27523" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27525" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27527" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27528" class="Symbol">}{</a><a id="27530" href="/Substitution/#27530" class="Bound">N</a> <a id="27532" class="Symbol">:</a> <a id="27534" href="/Substitution/#27508" class="Bound">Γ</a> <a id="27536" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27538" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27540" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27542" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27543" class="Symbol">}{</a><a id="27545" href="/Substitution/#27545" class="Bound">L</a> <a id="27547" class="Symbol">:</a> <a id="27549" href="/Substitution/#27508" class="Bound">Γ</a> <a id="27551" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27553" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27554" class="Symbol">}</a>
    <a id="27560" class="Symbol">→</a> <a id="27562" class="Symbol">(</a><a id="27563" href="/Substitution/#27511" class="Bound">M</a> <a id="27565" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27567" href="/Substitution/#27530" class="Bound">N</a> <a id="27569" href="/Untyped/#7475" class="Function Operator">]</a><a id="27570" class="Symbol">)</a> <a id="27572" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27574" href="/Substitution/#27545" class="Bound">L</a> <a id="27576" href="/Untyped/#7475" class="Function Operator">]</a> <a id="27578" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="27580" class="Symbol">(</a><a id="27581" href="/Substitution/#27511" class="Bound">M</a> <a id="27583" href="/Substitution/#27182" class="Function Operator">〔</a> <a id="27585" href="/Substitution/#27545" class="Bound">L</a> <a id="27587" href="/Substitution/#27182" class="Function Operator">〕</a><a id="27588" class="Symbol">)</a> <a id="27590" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27592" class="Symbol">(</a><a id="27593" href="/Substitution/#27530" class="Bound">N</a> <a id="27595" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27597" href="/Substitution/#27545" class="Bound">L</a> <a id="27599" href="/Untyped/#7475" class="Function Operator">]</a><a id="27600" class="Symbol">)</a> <a id="27602" href="/Untyped/#7475" class="Function Operator">]</a>
<a id="27604" href="/Substitution/#27491" class="Function">substitution</a><a id="27616" class="Symbol">{</a><a id="27617" class="Argument">M</a> <a id="27619" class="Symbol">=</a> <a id="27621" href="/Substitution/#27621" class="Bound">M</a><a id="27622" class="Symbol">}{</a><a id="27624" class="Argument">N</a> <a id="27626" class="Symbol">=</a> <a id="27628" href="/Substitution/#27628" class="Bound">N</a><a id="27629" class="Symbol">}{</a><a id="27631" class="Argument">L</a> <a id="27633" class="Symbol">=</a> <a id="27635" href="/Substitution/#27635" class="Bound">L</a><a id="27636" class="Symbol">}</a> <a id="27638" class="Symbol">=</a>
   <a id="27643" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="27647" class="Symbol">(</a><a id="27648" href="/Substitution/#24872" class="Function">subst-commute</a><a id="27661" class="Symbol">{</a><a id="27662" class="Argument">N</a> <a id="27664" class="Symbol">=</a> <a id="27666" href="/Substitution/#27621" class="Bound">M</a><a id="27667" class="Symbol">}{</a><a id="27669" class="Argument">M</a> <a id="27671" class="Symbol">=</a> <a id="27673" href="/Substitution/#27628" class="Bound">N</a><a id="27674" class="Symbol">}{</a><a id="27676" class="Argument">σ</a> <a id="27678" class="Symbol">=</a> <a id="27680" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="27691" href="/Substitution/#27635" class="Bound">L</a><a id="27692" class="Symbol">})</a></pre>

<h2 id="notes">Notes</h2>

<p>Most of the properties and proofs in this file are based on the paper
<em>Autosubst: Reasoning with de Bruijn Terms and Parallel Substitution</em>
by Schafer, Tebbi, and Smolka (ITP 2015). That paper, in turn, is
based on the paper of Abadi, Cardelli, Curien, and Levy (1991) that
defines the σ algebra.</p>


  </div>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/assets/jquery.js"></script>

<!-- Script which allows for foldable code blocks -->
<script type="text/javascript">
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
